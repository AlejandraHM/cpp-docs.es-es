---
title: Clase de COleClientItem | Documentos de Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
dev_langs:
- C++
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 89a277293cd4b192af0a8a069b82b1b1614490a7
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/04/2018
---
# <a name="coleclientitem-class"></a>Clase de COleClientItem
Define la interfaz del contenedor a elementos de OLE.  
  
## <a name="syntax"></a>Sintaxis  
  
```  
class COleClientItem : public CDocItem  
```  
  
## <a name="members"></a>Miembros  
  
### <a name="public-constructors"></a>Constructores públicos  
  
|Name|Descripción|  
|----------|-----------------|  
|[COleClientItem::COleClientItem](#coleclientitem)|Construye un objeto `COleClientItem`.|  
  
### <a name="public-methods"></a>Métodos públicos  
  
|Name|Descripción|  
|----------|-----------------|  
|[COleClientItem::Activate](#activate)|Abre el elemento OLE para una operación y, a continuación, ejecuta el verbo especificado.|  
|[COleClientItem::ActivateAs](#activateas)|Activa el elemento como otro tipo.|  
|[COleClientItem::AttachDataObject](#attachdataobject)|Tiene acceso a los datos en el objeto OLE.|  
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Indica si una aplicación contenedora puede crear un objeto incrustado.|  
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Indica si una aplicación contenedora puede crear un objeto vinculado.|  
|[COleClientItem::CanPaste](#canpaste)|Indica si el Portapapeles contiene un elemento OLE incrustable o estático.|  
|[COleClientItem::CanPasteLink](#canpastelink)|Indica si el Portapapeles contiene un elemento OLE linkable.|  
|[COleClientItem::Close](#close)|Cierra un vínculo a un servidor pero no destruirá el elemento OLE.|  
|[COleClientItem::ConvertTo](#convertto)|Convierte el elemento a otro tipo.|  
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Copia el elemento OLE en el Portapapeles.|  
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Crea un duplicado de un elemento existente.|  
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Crea un elemento incrustado desde el Portapapeles.|  
|[COleClientItem::CreateFromData](#createfromdata)|Crea un elemento incrustado en un objeto de datos.|  
|[Función COleClientItem:: CreateFromFile](#createfromfile)|Crea un elemento incrustado desde un archivo.|  
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Crea un elemento vinculado desde el Portapapeles.|  
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Crea un elemento vinculado de un objeto de datos.|  
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Crea un elemento vinculado desde un archivo.|  
|[COleClientItem::CreateNewItem](#createnewitem)|Crea un nuevo elemento incrustado al ejecutar la aplicación de servidor.|  
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Crea un elemento estático del Portapapeles.|  
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Crea un elemento estático de un objeto de datos.|  
|[COleClientItem::Deactivate](#deactivate)|Desactiva el elemento.|  
|[COleClientItem::DeactivateUI](#deactivateui)|Interfaz de usuario de la aplicación contenedora se restaura a su estado original.|  
|[COleClientItem::Delete](#delete)|Elimina o se cierra el elemento OLE si era un elemento vinculado.|  
|[COleClientItem::DoDragDrop](#dodragdrop)|Realiza una operación de arrastrar y colocar.|  
|[COleClientItem::DoVerb](#doverb)|Ejecuta el verbo especificado.|  
|[COleClientItem::Draw](#draw)|Dibuja el elemento OLE.|  
|[COleClientItem::GetActiveView](#getactiveview)|Obtiene la vista en la que se activa el elemento en su lugar.|  
|[COleClientItem::GetCachedExtent](#getcachedextent)|Devuelve los límites del rectángulo del elemento OLE.|  
|[COleClientItem::GetClassID](#getclassid)|Obtiene el identificador de clase. del elemento presente|  
|[COleClientItem::GetClipboardData](#getclipboarddata)|Obtiene los datos que se van a colocar en el Portapapeles mediante una llamada a la `CopyToClipboard` función miembro.|  
|[COleClientItem::GetDocument](#getdocument)|Devuelve el `COleDocument` objeto que contiene el elemento está presente.|  
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Obtiene la vista actual del elemento para la representación.|  
|[COleClientItem::GetExtent](#getextent)|Devuelve los límites del rectángulo del elemento OLE.|  
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Recupera un identificador de un icono asociado con el servidor de CLSID determinado.|  
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Obtiene el metarchivo usado para dibujar el icono del elemento.|  
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Devuelve un puntero a la ventana de edición en contexto del elemento.|  
|[COleClientItem::GetItemState](#getitemstate)|Obtiene el estado del elemento actual.|  
|[COleClientItem::GetLastStatus](#getlaststatus)|Devuelve el estado de la última operación OLE.|  
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Devuelve el modo de actualización para un elemento vinculado (característica avanzada).|  
|[COleClientItem::GetType](#gettype)|Devuelve el tipo (incrustado, vinculado o estático) del elemento OLE.|  
|[COleClientItem::GetUserType](#getusertype)|Obtiene una cadena que describe el tipo de elemento.|  
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Devuelve `TRUE` si el elemento está activo en contexto.|  
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Devuelve **TRUE** si un elemento vinculado está actualizado con su documento de origen.|  
|[COleClientItem::IsModified](#ismodified)|Devuelve `TRUE` si el elemento se ha modificado desde que se guardó por última vez.|  
|[COleClientItem::IsOpen](#isopen)|Devuelve `TRUE` si el elemento está actualmente abierto en la aplicación de servidor.|  
|[COleClientItem::IsRunning](#isrunning)|Devuelve `TRUE` si está ejecutando la aplicación de servidor del elemento.|  
|[COleClientItem::OnActivate](#onactivate)|Lo llama el marco de trabajo para notificar el elemento que está activada.|  
|[COleClientItem::OnActivateUI](#onactivateui)|Lo llama el marco de trabajo para notificar el elemento que se activa y debe mostrar la interfaz de usuario.|  
|[COleClientItem](#onchange)|Se llama cuando el servidor cambia el elemento OLE. Implementación necesaria.|  
|[COleClientItem::OnDeactivate](#ondeactivate)|Llamado por el marco de trabajo cuando se desactiva un elemento.|  
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Lo llama el marco cuando el servidor quitó su interfaz de usuario en contexto.|  
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Lo llama el marco para obtener los datos que se va a copiar en el Portapapeles.|  
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Lo llama el marco para crear un menú compuesto.|  
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Lo llama el marco de trabajo para quitar los menús del contenedor de un menú compuesto.|  
|[COleClientItem::OnSetMenu](#onsetmenu)|Lo llama el marco de trabajo para instalar y quitar un menú compuesto.|  
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Lo llama el marco de trabajo para mostrar y ocultar barras de control.|  
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Lo llama el marco de trabajo para actualizar la barra de título de la ventana de marco.|  
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|Vuelve a activar el elemento y deshace la última operación de edición en contexto.|  
|[COleClientItem::Release](#release)|Libera la conexión a un elemento vinculado de OLE y se cierra si estaba abierta. Destruir el elemento de cliente.|  
|[COleClientItem::Reload](#reload)|Vuelve a cargar el elemento después de llamar a `ActivateAs`.|  
|[COleClientItem::Run](#run)|Se ejecuta la aplicación asociada con el elemento.|  
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Establece la vista actual del elemento para la representación.|  
|[COleClientItem::SetExtent](#setextent)|Establece el rectángulo delimitador del elemento OLE.|  
|[COleClientItem::SetHostNames](#sethostnames)|Establece los nombres del servidor se muestra cuando se edita el elemento OLE.|  
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Almacena en caché el metarchivo usado para dibujar el icono del elemento.|  
|[COleClientItem::SetItemRects](#setitemrects)|Establece el rectángulo delimitador del elemento.|  
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Establece el modo de actualización para un elemento vinculado (característica avanzada).|  
|[COleClientItem::SetPrintDevice](#setprintdevice)|Establece el dispositivo de destino de impresión para este elemento de cliente.|  
|[COleClientItem::UpdateLink](#updatelink)|Actualiza la caché de presentación de un elemento.|  
  
### <a name="protected-methods"></a>Métodos protegidos  
  
|Name|Descripción|  
|----------|-----------------|  
|[COleClientItem:: CanActivate](#canactivate)|Lo llama el marco de trabajo para determinar si se permite la activación en contexto.|  
|[COleClientItem:: OnChangeItemPosition](#onchangeitemposition)|Lo llama el marco cuando cambia la posición de un elemento.|  
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Lo llama el marco para deshacer después de la activación.|  
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Lo llama el marco para descartar la información de estado de deshacer del elemento.|  
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Lo llama el marco para obtener las coordenadas del elemento rectángulo de recorte.|  
|[COleClientItem:: OnGetItemPosition](#ongetitemposition)|Lo llama el marco para obtener la posición del elemento con respecto a la vista.|  
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Llamado por el marco de trabajo cuando se activa un elemento en su lugar.|  
|[COleClientItem::OnScrollBy](#onscrollby)|Lo llama el marco para desplazar el elemento en la vista.|  
|[COleClientItem::OnShowItem](#onshowitem)|Lo llama el marco de trabajo para mostrar el elemento OLE.|  
  
## <a name="remarks"></a>Comentarios  
 Un elemento OLE representa datos creadas y mantenidas por una aplicación de servidor, que puede incorporar "sin problemas" en un documento para que parezca que el usuario sea un solo documento. El resultado es un "documento compuesto" formado por el elemento OLE y un documento contenedor.  
  
 Un elemento OLE puede estar incrustado o vinculado. Si se incrusta, sus datos se almacenan como parte del documento compuesto. Si se vincula, sus datos se almacenan como parte de un archivo independiente creado por la aplicación de servidor, y solo un vínculo a ese archivo se almacena en el documento compuesto. Todos los elementos OLE contienen información que especifica la aplicación de servidor que debe llamarse para modificarlos.  
  
 `COleClientItem` define varias funciones reemplazables que se llaman en respuesta a solicitudes de la aplicación de servidor; estos se pueden sobrecargar suelen actuar como notificaciones. Esto permite que la aplicación de servidor para informar del contenedor de los cambios realizados por el usuario al editar el elemento OLE, o para recuperar la información necesaria durante la edición.  
  
 `COleClientItem` se puede usar con cualquiera el [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md), o [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) clase. Usar `COleClientItem`, derive una clase de él e implementar la [OnChange](#onchange) función de miembro, que define la forma en que el contenedor responde a los cambios realizados en el elemento. Para admitir la activación en contexto, invalidar la [OnGetItemPosition](#ongetitemposition) función miembro. Esta función proporciona información sobre la posición del elemento OLE mostrada.  
  
 Para obtener más información sobre el uso de la interfaz del contenedor, consulte los artículos [contenedores: implementar un contenedor](../../mfc/containers-implementing-a-container.md) y [activación](../../mfc/activation-cpp.md).  
  
> [!NOTE]
>  El SDK de Windows hace referencia a elementos vinculados e incrustados como "objetos" y hace referencia a tipos de elementos como "clases". Esta referencia utiliza el término "item" para distinguir la entidad OLE desde el objeto de C++ correspondiente y el término "tipo" para distinguir la categoría OLE de la clase de C++.  
  
## <a name="inheritance-hierarchy"></a>Jerarquía de herencia  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CDocItem](../../mfc/reference/cdocitem-class.md)  
  
 `COleClientItem`  
  
## <a name="requirements"></a>Requisitos  
 **Encabezado:** afxole.h  
  
##  <a name="activate"></a>  COleClientItem::Activate  
 Llame a esta función para ejecutar el verbo especificado en lugar de [DoVerb](#doverb) para que pueda hacer su propio procesamiento cuando se produce una excepción.  
  
```  
void Activate(
    LONG nVerb,  
    CView* pView,  
    LPMSG lpMsg = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 `nVerb`  
 Especifica el verbo que se ejecute. Puede ser uno de los siguientes:  
  
|Valor|Significado|Símbolo|  
|-----------|-------------|------------|  
|- 0|verbo principal|`OLEIVERB_PRIMARY`|  
|- 1|Verbo secundario|(Ninguno)|  
|- 1|Elemento para mostrar para su edición|`OLEIVERB_SHOW`|  
|- 2|Editar elemento en una ventana independiente|`OLEIVERB_OPEN`|  
|- 3|Ocultar elementos|`OLEIVERB_HIDE`|  
  
 El valor-1 normalmente es un alias para otro verbo. Si no se admite la edición abierta, -2 tiene el mismo efecto que -1. Para los valores adicionales, consulte [DoVerb](http://msdn.microsoft.com/library/windows/desktop/ms694508) del SDK de Windows.  
  
 `pView`  
 Puntero a la ventana de vista de contenedor que contiene el elemento OLE; se utiliza la aplicación de servidor para la activación en contexto. Este parámetro debe ser **NULL** si el contenedor no admite la activación en contexto.  
  
 `lpMsg`  
 Puntero al mensaje que provocó el elemento que se debe activar.  
  
### <a name="remarks"></a>Comentarios  
 Si la aplicación de servidor se ha escrito utilizando la biblioteca Microsoft Foundation Class, esta función causa el [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) función de miembro de los correspondientes `COleServerItem` objeto va a ejecutar.  
  
 Si el verbo principal es editar y cero se especifica en el `nVerb` parámetro, la aplicación de servidor se inicia para permitir que el elemento OLE que se pueda editar. Si la aplicación contenedora admite la activación en contexto, la edición puede realizarse en su lugar. Si el contenedor no admite la activación en contexto (o si se especifica el verbo Open), el servidor se inicia en una ventana independiente y edición puede realizarse no existe. Normalmente, cuando el usuario de la aplicación contenedora hace doble clic en el elemento OLE, el valor para el verbo principal en el `nVerb` parámetro determina la acción que se puede realizar el usuario. Sin embargo, si el servidor admite solo una acción, toma dicha acción, con independencia de qué valor se especifica en el `nVerb` parámetro.  
  
 Para obtener más información, consulte [DoVerb](http://msdn.microsoft.com/library/windows/desktop/ms694508) del SDK de Windows.  
  
##  <a name="activateas"></a>  COleClientItem::ActivateAs  
 Funciones de conversión de OLE objeto se utiliza para activar el elemento como si fuese un elemento del tipo especificado por `clsidNew`.  
  
```  
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,  
    REFCLSID clsidOld,  
    REFCLSID clsidNew);
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszUserType*  
 Puntero a una cadena que representa el tipo de usuario de destino, como "Documento de Word".  
  
 *clsidOld*  
 Identificador de una referencia a la clase del elemento actual. El identificador de clase debe representar el tipo del objeto real, tal como se almacena, a menos que sea un vínculo. En ese caso, debe ser el CLSID del elemento al que hace referencia el vínculo. El [clase COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) proporciona automáticamente el identificador de clase correcto para el elemento.  
  
 `clsidNew`  
 Una referencia al identificador de clase de destino.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 Esto se llama de forma automática [COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). No es normalmente llama directamente.  
  
##  <a name="attachdataobject"></a>  COleClientItem::AttachDataObject  
 Llame a esta función para inicializar un [COleDataObject](../../mfc/reference/coledataobject-class.md) para tener acceso a los datos en el elemento OLE.  
  
```  
void AttachDataObject(COleDataObject& rDataObject) const;  
```  
  
### <a name="parameters"></a>Parámetros  
 *rDataObject*  
 Referencia a un `COleDataObject` objeto que se inicializará para permitir el acceso a los datos en el elemento OLE.  
  
##  <a name="canactivate"></a>  COleClientItem:: CanActivate  
 Lo llama el marco de trabajo cuando el usuario solicita la activación en contexto del elemento OLE; valor devuelto de esta función determina si se permite la activación en contexto.  
  
```  
virtual BOOL CanActivate();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si se permite la activación en contexto; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 La implementación predeterminada permite la activación en contexto si el contenedor tiene una ventana válida. Reemplace esta función para implementar una lógica especial para aceptar o rechazar la solicitud de activación. Por ejemplo, se puede rechazar una solicitud de activación si el elemento OLE es demasiado pequeño o no está actualmente visible.  
  
 Para obtener más información, consulte [IOleInPlaceSite::CanInPlaceActivate](http://msdn.microsoft.com/library/windows/desktop/ms691236) en el SDK de Windows.  
  
##  <a name="cancreatefromdata"></a>  COleClientItem::CanCreateFromData  
 Comprueba si una aplicación contenedora puede crear un objeto incrustado desde el determinado `COleDataObject` objeto.  
  
```  
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```  
  
### <a name="parameters"></a>Parámetros  
 `pDataObject`  
 Puntero a la [COleDataObject](../../mfc/reference/coledataobject-class.md) objeto desde el que se creará el elemento OLE.  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si el contenedor puede crear un objeto incrustado desde el `COleDataObject` objeto; de lo contrario devuelve 0.  
  
### <a name="remarks"></a>Comentarios  
 La `COleDataObject` clase se utiliza en las transferencias de datos para recuperar datos en diferentes formatos del Portapapeles, mediante arrastrar y colocar, o de un elemento OLE incrustado.  
  
 Contenedores pueden usar esta función para decidir si desea habilitar o deshabilitar sus comandos Editar pegar y editar Pegado especial.  
  
 Para obtener más información, vea el artículo [objetos de datos y orígenes de datos (OLE)](../../mfc/data-objects-and-data-sources-ole.md).  
  
##  <a name="cancreatelinkfromdata"></a>  COleClientItem::CanCreateLinkFromData  
 Comprueba si una aplicación contenedora puede crear un objeto vinculado desde la determinada `COleDataObject` objeto.  
  
```  
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```  
  
### <a name="parameters"></a>Parámetros  
 `pDataObject`  
 Puntero a la [COleDataObject](../../mfc/reference/coledataobject-class.md) objeto desde el que se creará el elemento OLE.  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si el contenedor puede crear un objeto vinculado desde la `COleDataObject` objeto.  
  
### <a name="remarks"></a>Comentarios  
 La `COleDataObject` clase se utiliza en las transferencias de datos para recuperar datos en diferentes formatos del Portapapeles, mediante arrastrar y colocar, o de un elemento OLE incrustado.  
  
 Contenedores pueden usar esta función para decidir habilitar o deshabilitar sus comandos de edición-Pegado especial y Pegar vínculo.  
  
 Para obtener más información, vea el artículo [objetos de datos y orígenes de datos (OLE)](../../mfc/data-objects-and-data-sources-ole.md).  
  
##  <a name="canpaste"></a>  COleClientItem::CanPaste  
 Llame a esta función para ver si se puede pegar un elemento OLE incrustado desde el Portapapeles.  
  
```  
static BOOL PASCAL CanPaste();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si se puede pegar un elemento OLE incrustado desde el Portapapeles; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 Para obtener más información, consulte [OleGetClipboard](http://msdn.microsoft.com/library/windows/desktop/ms692778) y [OleQueryCreateFromData](http://msdn.microsoft.com/library/windows/desktop/ms683739) en el SDK de Windows.  
  
##  <a name="canpastelink"></a>  COleClientItem::CanPasteLink  
 Llame a esta función para ver si un elemento OLE vinculado se puede pegar desde el Portapapeles.  
  
```  
static BOOL PASCAL CanPasteLink();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si un elemento OLE vinculado se puede pegar del Portapapeles; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 Para obtener más información, consulte [OleGetClipboard](http://msdn.microsoft.com/library/windows/desktop/ms692778) y [OleQueryLinkFromData](http://msdn.microsoft.com/library/windows/desktop/ms690244) en el SDK de Windows.  
  
##  <a name="close"></a>  COleClientItem::Close  
 Llame a esta función para cambiar el estado de un elemento OLE desde el estado de ejecución al estado cargado, es decir, cargado con su controlador en la memoria, pero con el servidor no se está ejecutando.  
  
```  
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```  
  
### <a name="parameters"></a>Parámetros  
 `dwCloseOption`  
 Indicador que especifica en qué circunstancias se guarda el elemento OLE al regresar al estado cargado. Puede tener uno de los valores siguientes:  
  
- `OLECLOSE_SAVEIFDIRTY` Guarde el elemento OLE.  
  
- `OLECLOSE_NOSAVE` No guarde el elemento OLE.  
  
- `OLECLOSE_PROMPTSAVE` Preguntar al usuario si desea guardar el elemento OLE.  
  
### <a name="remarks"></a>Comentarios  
 Esta función no tiene ningún efecto cuando no se está ejecutando el elemento OLE.  
  
 Para obtener más información, consulte [IOleObject::Close](http://msdn.microsoft.com/library/windows/desktop/ms683922) en el SDK de Windows.  
  
##  <a name="coleclientitem"></a>  COleClientItem::COleClientItem  
 Construye un `COleClientItem` objeto y lo agrega a la colección del documento contenedor de elementos de documento, que construye el objeto de C++ y no realiza ninguna inicialización de OLE.  
  
```  
COleClientItem(COleDocument* pContainerDoc = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 `pContainerDoc`  
 Puntero al documento contenedor que contendrá este elemento. Esto puede ser cualquiera [COleDocument](../../mfc/reference/coledocument-class.md) derivado.  
  
### <a name="remarks"></a>Comentarios  
 Si se pasa un **NULL** ninguna suma de puntero, se realiza en el documento contenedor. Debe llamar explícitamente a [COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem).  
  
 Debe llamar a una de las siguientes funciones miembro de creación antes de usar el elemento OLE:  
  
- [CreateFromClipboard](#createfromclipboard)  
  
- [CreateFromData](#createfromdata)  
  
- [CreateFromFile](#createfromfile)  
  
- [CreateStaticFromClipboard](#createstaticfromclipboard)  
  
- [CreateStaticFromData](#createstaticfromdata)  
  
- [CreateLinkFromClipboard](#createlinkfromclipboard)  
  
- [CreateLinkFromData](#createlinkfromdata)  
  
- [CreateLinkFromFile](#createlinkfromfile)  
  
- [CreateNewItem](#createnewitem)  
  
- [CreateCloneFrom](#createclonefrom)  
  
##  <a name="convertto"></a>  COleClientItem::ConvertTo  
 Llame a esta función miembro para convertir el elemento en el tipo especificado por `clsidNew`.  
  
```  
virtual BOOL ConvertTo(REFCLSID clsidNew);
```  
  
### <a name="parameters"></a>Parámetros  
 `clsidNew`  
 El identificador de clase del tipo de destino.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 Esto se llama de forma automática [clase COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). No es necesario para que se llame directamente.  
  
##  <a name="copytoclipboard"></a>  COleClientItem::CopyToClipboard  
 Llame a esta función para copiar el elemento OLE en el Portapapeles.  
  
```  
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```  
  
### <a name="parameters"></a>Parámetros  
 `bIncludeLink`  
 **TRUE** si la información del vínculo debe copiarse en el Portapapeles, lo que permite un elemento vinculado pegadas; en caso contrario **FALSE**.  
  
### <a name="remarks"></a>Comentarios  
 Normalmente, se llama a esta función al escribir controladores de mensajes para los comandos Copiar o cortar en el menú Edición. Debe implementar la selección de elementos en la aplicación contenedora si desea implementar los comandos Copiar o Cortar.  
  
 Para obtener más información, consulte [OleSetClipboard](http://msdn.microsoft.com/library/windows/desktop/ms686623) en el SDK de Windows.  
  
##  <a name="createclonefrom"></a>  COleClientItem::CreateCloneFrom  
 Llame a esta función para crear una copia del elemento OLE especificado.  
  
```  
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```  
  
### <a name="parameters"></a>Parámetros  
 *pSrcItem*  
 Puntero al elemento OLE que se va a estar duplicados.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 La copia es idéntica al elemento de origen. Puede usar esta función para admitir las operaciones de deshacer.  
  
##  <a name="createfromclipboard"></a>  COleClientItem::CreateFromClipboard  
 Llame a esta función para crear un elemento incrustado desde el contenido del Portapapeles.  
  
```  
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 *Representación*  
 Indicador que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) en el SDK de Windows.  
  
 `cfFormat`  
 Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.  
  
 `lpFormatEtc`  
 Puntero a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) estructura que se utiliza si *representar* es **OLERENDER_FORMAT** o **OLERENDER_DRAW**. Especifique un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por `cfFormat`. Si se omite este parámetro, se usan valores predeterminados para el resto de los campos de la **FORMATETC** estructura.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 Se suele llamar a esta función desde el controlador de mensajes para el comando Pegar en el menú Edición. (El comando Pegar está habilitado por el marco de trabajo si el [CanPaste](#canpaste) función miembro devuelve es distinto de cero.)  
  
 Para obtener más información, consulte [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) y [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) del SDK de Windows.  
  
##  <a name="createfromdata"></a>  COleClientItem::CreateFromData  
 Llame a esta función para crear un elemento incrustado en un `COleDataObject` objeto.  
  
```  
BOOL CreateFromData(
    COleDataObject* pDataObject,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 `pDataObject`  
 Puntero a la [COleDataObject](../../mfc/reference/coledataobject-class.md) objeto desde el que se creará el elemento OLE.  
  
 *Representación*  
 Indicador que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) en el SDK de Windows.  
  
 `cfFormat`  
 Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.  
  
 `lpFormatEtc`  
 Puntero a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) estructura que se utiliza si *representar* es **OLERENDER_FORMAT** o **OLERENDER_DRAW**. Especifique un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por `cfFormat`. Si se omite este parámetro, se usan valores predeterminados para el resto de los campos de la **FORMATETC** estructura.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 Las operaciones de transferencia de datos, por ejemplo, puede pegar desde el Portapapeles o las operaciones de arrastrar y colocar, proporcionan `COleDataObject` objetos que contiene la información proporcionada por una aplicación de servidor. Normalmente se utiliza en el reemplazo de [CView::OnDrop](../../mfc/reference/cview-class.md#ondrop).  
  
 Para obtener más información, consulte [OleCreateFromData](http://msdn.microsoft.com/library/windows/desktop/ms691211), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), y [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) del SDK de Windows.  
  
##  <a name="createfromfile"></a>  Función COleClientItem:: CreateFromFile  
 Llame a esta función para crear un elemento OLE incrustado desde un archivo.  
  
```  
BOOL CreateFromFile(
    LPCTSTR lpszFileName,  
    REFCLSID clsid = CLSID_NULL,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 `lpszFileName`  
 Puntero al nombre de archivo desde el que se creará el elemento OLE.  
  
 `clsid`  
 Reservado para un uso futuro.  
  
 *Representación*  
 Indicador que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) en el SDK de Windows.  
  
 `cfFormat`  
 Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.  
  
 `lpFormatEtc`  
 Puntero a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) estructura que se utiliza si *representar* es **OLERENDER_FORMAT** o **OLERENDER_DRAW**. Especifique un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por `cfFormat`. Si se omite este parámetro, se usan valores predeterminados para el resto de los campos de la **FORMATETC** estructura.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 El marco de trabajo llama a esta función de [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) si el usuario elige Aceptar en el cuadro de diálogo Insertar objeto cuando se selecciona la creación de botón de archivo.  
  
 Para obtener más información, consulte [OleCreateFromFile](http://msdn.microsoft.com/library/windows/desktop/ms690116), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), y [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) del SDK de Windows.  
  
##  <a name="createlinkfromclipboard"></a>  COleClientItem::CreateLinkFromClipboard  
 Llame a esta función para crear un elemento vinculado a partir del contenido del Portapapeles.  
  
```  
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 *Representación*  
 Indicador que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) en el SDK de Windows.  
  
 `cfFormat`  
 Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.  
  
 `lpFormatEtc`  
 Puntero a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) estructura que se utiliza si *representar* es **OLERENDER_FORMAT** o **OLERENDER_DRAW**. Especifique un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por `cfFormat`. Si se omite este parámetro, se usan valores predeterminados para el resto de los campos de la **FORMATETC** estructura.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 Se suele llamar a esta función desde el controlador de mensajes para el comando Pegar vínculo en el menú Edición. (El comando Pegar vínculo está habilitado en la implementación predeterminada de [COleDocument](../../mfc/reference/coledocument-class.md) si el Portapapeles contiene un elemento OLE que se puede vincular.)  
  
 Para obtener más información, consulte [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) y [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) del SDK de Windows.  
  
##  <a name="createlinkfromdata"></a>  COleClientItem::CreateLinkFromData  
 Llame a esta función para crear un elemento vinculado desde una `COleDataObject` objeto.  
  
```  
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 `pDataObject`  
 Puntero a la [COleDataObject](../../mfc/reference/coledataobject-class.md) objeto desde el que se creará el elemento OLE.  
  
 *Representación*  
 Indicador que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) en el SDK de Windows.  
  
 `cfFormat`  
 Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.  
  
 `lpFormatEtc`  
 Puntero a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) estructura que se utiliza si *representar* es **OLERENDER_FORMAT** o **OLERENDER_DRAW**. Especifique un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por `cfFormat`. Si se omite este parámetro, se usan valores predeterminados para el resto de los campos de la **FORMATETC** estructura.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 Esto llama durante una operación de colocar cuando el usuario indica que se debe crear un vínculo. También se puede utilizar para controlar el comando Pegar del menú. Lo llama el marco de trabajo en `COleClientItem::CreateLinkFromClipboard` y en [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) cuando se ha seleccionado la opción de vínculo.  
  
 Para obtener más información, consulte [OleCreateLinkFromData](http://msdn.microsoft.com/library/windows/desktop/ms680731), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), y [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) del SDK de Windows.  
  
##  <a name="createlinkfromfile"></a>  COleClientItem::CreateLinkFromFile  
 Llame a esta función para crear un elemento OLE vinculado desde un archivo.  
  
```  
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 `lpszFileName`  
 Puntero al nombre de archivo desde el que se creará el elemento OLE.  
  
 *Representación*  
 Indicador que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) en el SDK de Windows.  
  
 `cfFormat`  
 Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.  
  
 `lpFormatEtc`  
 Puntero a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) estructura que se utiliza si *representar* es **OLERENDER_FORMAT** o **OLERENDER_DRAW**. Especifique un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por `cfFormat`. Si se omite este parámetro, se usan valores predeterminados para el resto de los campos de la **FORMATETC** estructura.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 El marco de trabajo llama a esta función si el usuario elige Aceptar en el cuadro de diálogo Insertar objeto cuando se selecciona la creación de botón de archivo y está activada la casilla de verificación de vínculo. Se llama desde [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).  
  
 Para obtener más información, consulte [OleCreateLinkToFile](http://msdn.microsoft.com/library/windows/desktop/ms678434), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), y [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) del SDK de Windows.  
  
##  <a name="createnewitem"></a>  COleClientItem::CreateNewItem  
 Llame a esta función para crear un elemento incrustado; Esta función inicia la aplicación de servidor que permite al usuario crear el elemento OLE.  
  
```  
BOOL CreateNewItem(
    REFCLSID clsid,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 `clsid`  
 Identificador que identifica de forma única el tipo de elemento OLE para crear.  
  
 *Representación*  
 Indicador que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) en el SDK de Windows.  
  
 `cfFormat`  
 Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.  
  
 `lpFormatEtc`  
 Puntero a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) estructura que se utiliza si *representar* es **OLERENDER_FORMAT** o **OLERENDER_DRAW**. Especifique un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por `cfFormat`. Si se omite este parámetro, se usan valores predeterminados para el resto de los campos de la **FORMATETC** estructura.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 El marco de trabajo llama a esta función si el usuario elige Aceptar en el cuadro de diálogo Insertar objeto cuando se selecciona el botón Crear nuevo.  
  
 Para obtener más información, consulte [OleCreate](http://msdn.microsoft.com/library/windows/desktop/ms678409), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), y [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) del SDK de Windows.  
  
##  <a name="createstaticfromclipboard"></a>  COleClientItem::CreateStaticFromClipboard  
 Llame a esta función para crear un elemento estático desde el contenido del Portapapeles.  
  
```  
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 *Representación*  
 Indicador que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) en el SDK de Windows.  
  
 `cfFormat`  
 Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.  
  
 `lpFormatEtc`  
 Puntero a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) estructura que se utiliza si *representar* es **OLERENDER_FORMAT** o **OLERENDER_DRAW**. Especifique un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por `cfFormat`. Si se omite este parámetro, se usan valores predeterminados para el resto de los campos de la **FORMATETC** estructura.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 Un elemento estático contiene los datos de la presentación, pero no los datos nativos; por lo tanto no se puede editar. Se suele llamar a esta función cuando el [CreateFromClipboard](#createfromclipboard) se produce un error en la función miembro.  
  
 Para obtener más información, consulte [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) y [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) del SDK de Windows.  
  
##  <a name="createstaticfromdata"></a>  COleClientItem::CreateStaticFromData  
 Llame a esta función para crear un elemento estático desde una `COleDataObject` objeto.  
  
```  
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 `pDataObject`  
 Puntero a la [COleDataObject](../../mfc/reference/coledataobject-class.md) objeto desde el que se creará el elemento OLE.  
  
 *Representación*  
 Indicador que especifica cómo el servidor representará el elemento OLE. Para los valores posibles, vea [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) en el SDK de Windows.  
  
 `cfFormat`  
 Especifica el formato de datos del Portapapeles en la memoria caché al crear el elemento OLE.  
  
 `lpFormatEtc`  
 Puntero a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) estructura que se utiliza si *representar* es **OLERENDER_FORMAT** o **OLERENDER_DRAW**. Especifique un valor para este parámetro solo si desea especificar información de formato adicionales más allá del formato de Portapapeles especificado por `cfFormat`. Si se omite este parámetro, se usan valores predeterminados para el resto de los campos de la **FORMATETC** estructura.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 Un elemento estático contiene los datos de la presentación, pero no los datos nativos; por lo tanto, no se puede editar. Esto es básicamente el mismo que [CreateStaticFromClipboard](#createstaticfromclipboard) salvo que se pueda crear un elemento estático del arbitrario `COleDataObject`, no solo desde el Portapapeles.  
  
 Usar en [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) cuando se selecciona estático.  
  
 Para obtener más información, consulte [OleCreateStaticFromData](http://msdn.microsoft.com/library/windows/desktop/ms687290), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), y [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) del SDK de Windows.  
  
##  <a name="deactivate"></a>  COleClientItem::Deactivate  
 Llame a esta función para desactivar el elemento OLE y liberar todos los recursos asociados.  
  
```  
void Deactivate();
```  
  
### <a name="remarks"></a>Comentarios  
 Normalmente, se desactiva un elemento OLE en contexto activo cuando el usuario hace clic en el mouse en el área de cliente fuera de los límites del elemento. Tenga en cuenta que desactivar el elemento OLE descartará su estado de deshacer, que no se pueda llamar a la [ReactivateAndUndo](#reactivateandundo) función miembro.  
  
 Si la aplicación admite deshacer, no llame a `Deactivate`; en su lugar, llame a [DeactivateUI](#deactivateui).  
  
 Para obtener más información, consulte [IOleInPlaceObject::InPlaceDeactivate](http://msdn.microsoft.com/library/windows/desktop/ms679700) en el SDK de Windows.  
  
##  <a name="deactivateui"></a>  COleClientItem::DeactivateUI  
 Llame a esta función cuando el usuario desactiva un elemento que se ha activado en su lugar.  
  
```  
void DeactivateUI();
```  
  
### <a name="remarks"></a>Comentarios  
 Esta función restaura a su estado original, ocultar los menús y otros controles que se crearon para la activación en contexto de interfaz de usuario de la aplicación contenedora.  
  
 Esta función no vuelca la información de estado de deshacer para el elemento. Que se retiene información para que [ReactivateAndUndo](#reactivateandundo) pueden utilizar posteriormente para ejecutar un comando de deshacer de la aplicación de servidor, en caso de que se elige el comando de deshacer del contenedor inmediatamente después de desactivar el elemento.  
  
 Para obtener más información, consulte [IOleInPlaceObject::InPlaceDeactivate](http://msdn.microsoft.com/library/windows/desktop/ms679700) en el SDK de Windows.  
  
##  <a name="delete"></a>  COleClientItem::Delete  
 Llame a esta función para eliminar el elemento OLE en el documento contenedor.  
  
```  
void Delete(BOOL bAutoDelete = TRUE);
```  
  
### <a name="parameters"></a>Parámetros  
 `bAutoDelete`  
 Especifica si el elemento se quitará del documento.  
  
### <a name="remarks"></a>Comentarios  
 Esta función llama a la [versión](#release) función de miembro, que a su vez elimina el objeto de C++ para el elemento, de forma permanente quitando el elemento OLE del documento. Si se incrusta el elemento OLE, se eliminan los datos nativos para el elemento. Siempre cierra un servidor en ejecución; por lo tanto, si el elemento es un vínculo abra, esta función lo cierra.  
  
##  <a name="dodragdrop"></a>  COleClientItem::DoDragDrop  
 Llame a la `DoDragDrop` función de miembro para realizar una operación de arrastrar y colocar.  
  
```  
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,  
    CPoint ptOffset,  
    BOOL bIncludeLink = FALSE,  
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,  
    LPCRECT lpRectStartDrag = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 `lpItemRect`  
 Rectángulo del elemento en la pantalla en coordenadas de cliente (píxeles).  
  
 `ptOffset`  
 El desplazamiento de `lpItemRect` que era la posición del mouse en el momento de la operación de arrastre.  
  
 `bIncludeLink`  
 Establezca esta propiedad en **TRUE** si los datos de vínculo deben copiarse en el Portapapeles. Establézcalo en **FALSE** si la aplicación de servidor no admite vínculos.  
  
 `dwEffects`  
 Determina los efectos que permitirá al origen de arrastre en la operación de arrastre.  
  
 `lpRectStartDrag`  
 Puntero al rectángulo que define donde realmente comienza la operación de arrastre. Para obtener más información, vea la sección Comentarios que se muestra más adelante.  
  
### <a name="return-value"></a>Valor devuelto  
 Valor `DROPEFFECT`. Si es `DROPEFFECT_MOVE`, se deben quitar los datos originales.  
  
### <a name="remarks"></a>Comentarios  
 No se inicie inmediatamente la operación de arrastrar y colocar. Espera hasta que el cursor del mouse deja el rectángulo especificado por `lpRectStartDrag` o hasta que un número especificado de milisegundos transcurridos. Si `lpRectStartDrag` es **NULL**, el tamaño del rectángulo es un píxel.  
  
 El tiempo de retraso especificado por un valor de una clave del registro. Puede cambiar el tiempo de retraso mediante una llamada a [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) o [CWinApp:: Writeprofileint](../../mfc/reference/cwinapp-class.md#writeprofileint). Si no especifica el tiempo de retardo, se utiliza un valor predeterminado de 200 milisegundos. Tiempo de retardo de arrastre se almacena como sigue:  
  
-   Tiempo de retardo de arrastre de Windows NT se almacena en HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay.  
  
-   Tiempo de retardo de arrastre de Windows 3.x se almacena en el archivo WIN. Archivo INI, en la [sección Windows}.  
  
-   Tiempo de retardo de arrastre de Windows 95 ó 98 se almacena en una versión en caché de WIN. INI.  
  
 Para obtener más información acerca de cómo arrastrar información de retraso se almacena en el registro o la. El archivo INI, consulte [WriteProfileString](http://msdn.microsoft.com/library/windows/desktop/ms725504) en el SDK de Windows.  
  
##  <a name="doverb"></a>  COleClientItem::DoVerb  
 Llame a `DoVerb` para ejecutar el verbo especificado.  
  
```  
virtual BOOL DoVerb(
    LONG nVerb,  
    CView* pView,
    LPMSG lpMsg = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 `nVerb`  
 Especifica el verbo que se ejecute. Puede incluir uno de los siguientes:  
  
|Valor|Significado|Símbolo|  
|-----------|-------------|------------|  
|- 0|verbo principal|`OLEIVERB_PRIMARY`|  
|- 1|Verbo secundario|(Ninguno)|  
|- 1|Elemento para mostrar para su edición|`OLEIVERB_SHOW`|  
|- 2|Editar elemento en una ventana independiente|`OLEIVERB_OPEN`|  
|- 3|Ocultar elementos|`OLEIVERB_HIDE`|  
  
 El valor-1 normalmente es un alias para otro verbo. Si no se admite la edición abierta, -2 tiene el mismo efecto que -1. Para los valores adicionales, consulte [DoVerb](http://msdn.microsoft.com/library/windows/desktop/ms694508) del SDK de Windows.  
  
 `pView`  
 Puntero a la ventana de vista; se utiliza el servidor de activación en contexto. Este parámetro debe ser **NULL** si la aplicación contenedora no permite la activación en contexto.  
  
 `lpMsg`  
 Puntero al mensaje que provocó el elemento que se debe activar.  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si el verbo se ha ejecutado correctamente; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 Esta función llama a la [activar](#activate) función de miembro que se ejecuta el verbo. También detecta las excepciones y muestra un cuadro de mensaje al usuario si se produce uno.  
  
 Si el verbo principal es editar y cero se especifica en el `nVerb` parámetro, la aplicación de servidor se inicia para permitir que el elemento OLE que se pueda editar. Si la aplicación contenedora admite la activación en contexto, la edición puede realizarse en su lugar. Si el contenedor no admite la activación en contexto (o si se especifica el verbo Open), el servidor se inicia en una ventana independiente y edición puede realizarse no existe. Normalmente, cuando el usuario de la aplicación contenedora hace doble clic en el elemento OLE, el valor para el verbo principal en el `nVerb` parámetro determina la acción que se puede realizar el usuario. Sin embargo, si el servidor admite solo una acción, toma dicha acción, con independencia de qué valor se especifica en el `nVerb` parámetro.  
  
##  <a name="draw"></a>  COleClientItem::Draw  
 Llame a esta función para dibujar el elemento OLE en el rectángulo delimitador especificado utilizando el contexto de dispositivo especificado.  
  
```  
BOOL Draw(
    CDC* pDC,  
    LPCRECT lpBounds,  
    DVASPECT nDrawAspect = (DVASPECT)-1);
```  
  
### <a name="parameters"></a>Parámetros  
 `pDC`  
 Puntero a un [CDC](../../mfc/reference/cdc-class.md) objeto usado para dibujar el elemento OLE.  
  
 `lpBounds`  
 Puntero a un [CRect](../../atl-mfc-shared/reference/crect-class.md) objeto o `RECT` estructura que define el rectángulo delimitador en el que se va a dibujar el elemento OLE (en unidades lógicas que determine el contexto de dispositivo).  
  
 `nDrawAspect`  
 Especifica el aspecto de OLE de elementos, es decir, ¿cómo debe mostrarse. Si `nDrawAspect` es -1, el último aspecto establecer mediante [SetDrawAspect](#setdrawaspect) se utiliza. Para obtener más información sobre los valores posibles para esta marca, consulte [SetDrawAspect](#setdrawaspect).  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 La función puede usar la representación del metarchivo del elemento OLE creado por el [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) función miembro de `COleServerItem`.  
  
 Normalmente se utiliza **dibujar** para presentación en pantalla, pasando el contexto de dispositivo de pantalla como `pDC`. En este caso, debe especificar sólo los dos primeros parámetros.  
  
 El `lpBounds` parámetro identifica el rectángulo en el contexto de dispositivo de destino (en relación con el modo de asignación actual). Representación puede implicar la escala de una imagen y puede usarse por aplicaciones de contenedor para imponer una vista que escala entre la vista mostrada y la imagen impresa final.  
  
 Para obtener más información, consulte [IViewObject::Draw](http://msdn.microsoft.com/library/windows/desktop/ms688655) en el SDK de Windows.  
  
##  <a name="getactiveview"></a>  COleClientItem::GetActiveView  
 Devuelve la vista en la que el elemento está activado en el contexto.  
  
```  
CView* GetActiveView() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 Un puntero a la vista; en caso contrario, **NULL** si el elemento no está activado en el contexto.  
  
##  <a name="getcachedextent"></a>  COleClientItem::GetCachedExtent  
 Llame a esta función para recuperar el tamaño del elemento OLE.  
  
```  
BOOL GetCachedExtent(
    LPSIZE lpSize,  
    DVASPECT nDrawAspect = (DVASPECT)-1);
```  
  
### <a name="parameters"></a>Parámetros  
 `lpSize`  
 Puntero a un **tamaño** estructura o un [CSize](../../atl-mfc-shared/reference/csize-class.md) objeto que va a recibir la información de tamaño.  
  
 `nDrawAspect`  
 Especifica el aspecto del producto OLE cuyos límites se van a recuperar. Para los valores posibles, vea [SetDrawAspect](#setdrawaspect).  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si se realiza correctamente; 0 si el elemento OLE está en blanco.  
  
### <a name="remarks"></a>Comentarios  
 Esta función proporciona la misma información que [GetExtent](#getextent). Sin embargo, puede llamar a `GetCachedExtent` para obtener información de extensión durante el procesamiento de otros controladores de OLE, como [OnChange](#onchange). Las dimensiones son en `MM_HIMETRIC` unidades.  
  
 Esto es posible porque `GetCachedExtent` utiliza la [IViewObject2](http://msdn.microsoft.com/library/windows/desktop/ms691318) interfaz en lugar de usar el [IOleObject](http://msdn.microsoft.com/library/windows/desktop/dd542709) interfaz para obtener el alcance de este elemento. El **IViewObject2** objeto COM almacena en caché la información de extensión utilizada en la llamada anterior a [IViewObject::Draw](http://msdn.microsoft.com/library/windows/desktop/ms688655).  
  
 Para obtener más información, consulte [IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032) en el SDK de Windows.  
  
##  <a name="getclassid"></a>  COleClientItem::GetClassID  
 Devuelve el identificador de clase del elemento en la memoria que señala `pClassID`.  
  
```  
void GetClassID(CLSID* pClassID) const;  
```  
  
### <a name="parameters"></a>Parámetros  
 `pClassID`  
 Puntero a un identificador de tipo [CLSID](http://msdn.microsoft.com/library/windows/desktop/ms691424) para recuperar el identificador de clase. Para obtener información sobre **CLSID**, consulte el SDK de Windows.  
  
### <a name="remarks"></a>Comentarios  
 El identificador de clase es un número de 128 bits que identifica de forma única la aplicación que modifica el elemento.  
  
 Para obtener más información, consulte [IPersist:: GetClassID](http://msdn.microsoft.com/library/windows/desktop/ms688664) del SDK de Windows.  
  
##  <a name="getclipboarddata"></a>  COleClientItem::GetClipboardData  
 Llame a esta función para obtener un `COleDataSource` objeto que contiene todos los datos que se van a colocar en el Portapapeles mediante una llamada a la [CopyToClipboard](#copytoclipboard) función miembro.  
  
```  
void GetClipboardData(
    COleDataSource* pDataSource,  
    BOOL bIncludeLink = FALSE,  
    LPPOINT lpOffset = NULL,  
    LPSIZE lpSize = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 `pDataSource`  
 Puntero a un [COleDataSource](../../mfc/reference/coledatasource-class.md) objeto que recibirá los datos contenidos en el elemento OLE.  
  
 `bIncludeLink`  
 **TRUE** si los datos de vínculo deben estar incluidos; en caso contrario **FALSE**.  
  
 `lpOffset`  
 El desplazamiento del cursor del mouse desde el origen del objeto en píxeles.  
  
 `lpSize`  
 El tamaño del objeto en píxeles.  
  
### <a name="remarks"></a>Comentarios  
 `GetClipboardData` se llama como la implementación predeterminada de [OnGetClipboardData](#ongetclipboarddata). Invalidar `OnGetClipboardData` sólo si desea ofrecer formatos de datos además de las proporcionadas por `CopyToClipboard`. Coloque estos formatos en el `COleDataSource` objeto antes o después de llamar a `CopyToClipboard`y, a continuación, pasar la `COleDataSource` el objeto a la [COleDataSource:: SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) función. Por ejemplo, si desea que la posición del elemento OLE en el documento contenedor para acompañar en el Portapapeles, definir su propio formato para pasar dicha información y lo coloca en el `COleDataSource` antes de llamar a `CopyToClipboard`.  
  
##  <a name="getdocument"></a>  COleClientItem::GetDocument  
 Llame a esta función para obtener un puntero al documento que contiene el elemento OLE.  
  
```  
COleDocument* GetDocument() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 Un puntero al documento que contiene el elemento OLE. **NULL** si el elemento no forma parte de un documento.  
  
### <a name="remarks"></a>Comentarios  
 This (puntero) permite el acceso a la `COleDocument` objeto que se pasa como un argumento a la `COleClientItem` constructor.  
  
##  <a name="getdrawaspect"></a>  COleClientItem::GetDrawAspect  
 Llame a la `GetDrawAspect` función de miembro para determinar el actual "aspecto" o la vista del elemento.  
  
```  
DVASPECT GetDrawAspect() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 Un valor de la `DVASPECT` enumeración, cuyos valores se muestran en la referencia para [SetDrawAspect](#setdrawaspect).  
  
### <a name="remarks"></a>Comentarios  
 El aspecto especifica cómo se representará el elemento.  
  
##  <a name="getextent"></a>  COleClientItem::GetExtent  
 Llame a esta función para recuperar el tamaño del elemento OLE.  
  
```  
BOOL GetExtent(
    LPSIZE lpSize,  
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```  
  
### <a name="parameters"></a>Parámetros  
 `lpSize`  
 Puntero a un **tamaño** estructura o un `CSize` objeto que va a recibir la información de tamaño.  
  
 `nDrawAspect`  
 Especifica el aspecto del producto OLE cuyos límites se van a recuperar. Para los valores posibles, vea [SetDrawAspect](#setdrawaspect).  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si se realiza correctamente; 0 si el elemento OLE está en blanco.  
  
### <a name="remarks"></a>Comentarios  
 Si la aplicación de servidor se ha escrito utilizando la biblioteca Microsoft Foundation Class, esta función causa el [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) función de miembro de los correspondientes `COleServerItem` objeto que se va a llamar. Tenga en cuenta que el tamaño recuperado puede diferir del tamaño que se estableció por última vez la [SetExtent](#setextent) función miembro; el tamaño especificado por `SetExtent` se trata como una sugerencia. Las dimensiones son en `MM_HIMETRIC` unidades.  
  
> [!NOTE]
>  No llame a `GetExtent` durante el procesamiento de un controlador de OLE, como [OnChange](#onchange). Llame a [GetCachedExtent](#getcachedextent) en su lugar.  
  
 Para obtener más información, consulte [IOleObject::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms692325) en el SDK de Windows.  
  
##  <a name="geticonfromregistry"></a>  COleClientItem::GetIconFromRegistry  
 Llame a esta función miembro para recuperar un identificador a un recurso de icono asociado con el servidor de CLSID determinado.  
  
```  
HICON GetIconFromRegistry() const;  
  
static HICON GetIconFromRegistry(CLSID& clsid);
```  
  
### <a name="parameters"></a>Parámetros  
 `clsid`  
 Una referencia al CLSID para el servidor asociado al icono.  
  
### <a name="return-value"></a>Valor devuelto  
 Un identificador válido para el recurso de icono o **NULL** si no se puede encontrar el icono del servidor o un icono predeterminado.  
  
### <a name="remarks"></a>Comentarios  
 Esta función miembro no se inicie el servidor u obtener un icono dinámicamente, incluso si el servidor ya se está ejecutando. En su lugar, esta función miembro abre imagen ejecutable del servidor y recupera el icono estático asociado con el servidor tal y como se ha registrado.  
  
##  <a name="geticonicmetafile"></a>  COleClientItem::GetIconicMetafile  
 Recupera el metarchivo usado para dibujar el icono del elemento.  
  
```  
HGLOBAL GetIconicMetafile();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Un identificador de metarchivo si se realiza correctamente; en caso contrario, **NULL**.  
  
### <a name="remarks"></a>Comentarios  
 Si no hay ningún icono actual, aparece un icono predeterminado. Esto se denomina automáticamente mediante los cuadros de diálogo MFC/OLE y no se suele llamar directamente.  
  
 También llama a esta función [SetIconicMetafile](#seticonicmetafile) para almacenar en caché el metarchivo para su uso posterior.  
  
##  <a name="getinplacewindow"></a>  COleClientItem::GetInPlaceWindow  
 Llame a la `GetInPlaceWindow` función de miembro para obtener un puntero a la ventana en la que el elemento se ha abierto para edición en contexto.  
  
```  
CWnd* GetInPlaceWindow();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Un puntero a la ventana de edición del elemento en contexto; **NULL** si el elemento no está activo o si su servidor no está disponible.  
  
### <a name="remarks"></a>Comentarios  
 Esta función se debería llamar solo para los elementos que estén activos en contexto.  
  
##  <a name="getitemstate"></a>  COleClientItem::GetItemState  
 Llame a esta función para obtener el estado actual del elemento OLE.  
  
```  
UINT GetItemState() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 A **COleClientItem:: ItemState** enumerado valor, que puede ser uno de los siguientes: `emptyState`, **loadedState**, `openState`, `activeState`, `activeUIState`. Para obtener información acerca de estos Estados, vea el artículo [contenedores: estados de elementos de cliente](../../mfc/containers-client-item-states.md).  
  
### <a name="remarks"></a>Comentarios  
 Para recibir una notificación cuando cambia el estado del elemento OLE, use la [OnChange](#onchange) función miembro.  
  
 Para obtener más información, vea el artículo [contenedores: estados de elementos de cliente](../../mfc/containers-client-item-states.md).  
  
##  <a name="getlaststatus"></a>  COleClientItem::GetLastStatus  
 Devuelve el código de estado de la última operación OLE.  
  
```  
SCODE GetLastStatus() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 Valor `SCODE`.  
  
### <a name="remarks"></a>Comentarios  
 Para los miembros, las funciones que devuelven un **BOOL** valo **FALSE**, o de otro miembro de las funciones que devuelven **NULL**, `GetLastStatus` devuelve información de error más detallada. Tenga en cuenta que la mayoría de las funciones de miembro OLE produce excepciones para los errores más graves. La información específica sobre la interpretación de la `SCODE` depende de la llamada OLE subyacente que devuelve última un `SCODE` valor.  
  
 Para obtener más información sobre `SCODE`, consulte [estructura de códigos de Error COM](http://msdn.microsoft.com/library/windows/desktop/ms690088) en la documentación del SDK de Windows.  
  
##  <a name="getlinkupdateoptions"></a>  COleClientItem::GetLinkUpdateOptions  
 Llame a esta función para obtener el valor actual de la opción de actualización de los vínculos para el elemento OLE.  
  
```  
OLEUPDATE GetLinkUpdateOptions();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Uno de los siguientes valores:  
  
- `OLEUPDATE_ALWAYS` Actualizar el elemento vinculado siempre que sea posible. Esta opción es compatible con el botón de opción de actualización automática de los vínculos en el cuadro de diálogo de vínculos.  
  
- `OLEUPDATE_ONCALL` Actualizar el elemento vinculado solo en la solicitud de la aplicación contenedora (cuando la [UpdateLink](#updatelink) se llama la función miembro). Esta opción es compatible con el botón de opción de actualización Manual de los vínculos en el cuadro de diálogo de vínculos.  
  
### <a name="remarks"></a>Comentarios  
 Se trata de una operación avanzada.  
  
 Esta función se llama de forma automática la [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) clase.  
  
 Para obtener más información, consulte [IOleLink::GetUpdateOptions](http://msdn.microsoft.com/library/windows/desktop/ms680100) en el SDK de Windows.  
  
##  <a name="gettype"></a>  COleClientItem::GetType  
 Llame a esta función para determinar si el elemento OLE es incrustado o vinculado o static.  
  
```  
OLE_OBJTYPE GetType() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 Un entero sin signo con uno de los siguientes valores:  
  
- `OT_LINK` El elemento OLE es un vínculo.  
  
- `OT_EMBEDDED` El elemento OLE se incrusta.  
  
- `OT_STATIC` El elemento OLE es estático, es decir, contiene solo los datos de presentación, los datos no nativos y, por tanto, no se puede editar.  
  
##  <a name="getusertype"></a>  COleClientItem::GetUserType  
 Llame a esta función para obtener la cadena visible para el usuario que describe el tipo del elemento OLE, por ejemplo, "Documento de Word".  
  
```  
void GetUserType(
    USERCLASSTYPE nUserClassType,  
    CString& rString);
```  
  
### <a name="parameters"></a>Parámetros  
 *nUserClassType*  
 Un valor que indica la variante deseada de la cadena que describe el tipo de elemento OLE. Esto puede tener uno de los valores siguientes:  
  
- `USERCLASSTYPE_FULL` El nombre de tipo completo que se muestra al usuario.  
  
- `USERCLASSTYPE_SHORT` Un nombre corto (15 caracteres como máximo) para su uso en los menús emergentes y el cuadro de diálogo Editar vínculos.  
  
- `USERCLASSTYPE_APPNAME` Nombre de la aplicación de la clase de servicio.  
  
 `rString`  
 Una referencia a un [CString](../../atl-mfc-shared/reference/cstringt-class.md) objeto al que se devolverá la cadena que describe el tipo de elemento OLE.  
  
### <a name="remarks"></a>Comentarios  
 Por lo general, suele ser la entrada en la base de datos de registro del sistema.  
  
 Si el nombre de tipo completo es solicitado, pero no está disponible, el nombre corto se utiliza en su lugar. Si se encuentra ninguna entrada para el tipo de elemento OLE en la base de datos de registro, o si no hay ningún tipo de usuario registrado para el tipo de elemento OLE, a continuación, el tipo de usuario almacenados actualmente en el elemento OLE se utiliza. Si ese nombre de tipo de usuario es una cadena vacía, se utiliza "Objeto desconocido".  
  
 Para obtener más información, consulte [IOleObject::GetUserType](http://msdn.microsoft.com/library/windows/desktop/ms688643) en el SDK de Windows.  
  
##  <a name="isinplaceactive"></a>  COleClientItem::IsInPlaceActive  
 Llame a esta función para ver si el elemento OLE está activo en contexto.  
  
```  
BOOL IsInPlaceActive() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si el elemento OLE está activo en contexto; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 Es habitual para ejecutar una lógica diferente dependiendo de si se está editando el elemento en su lugar. La función comprueba si el estado del elemento actual es igual a la `activeState` o `activeUIState`.  
  
##  <a name="islinkuptodate"></a>  COleClientItem::IsLinkUpToDate  
 Llame a esta función para ver si el elemento OLE está actualizado.  
  
```  
BOOL IsLinkUpToDate() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si el elemento OLE está actualizado; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 Un elemento vinculado puede ser obsoleto si se ha actualizado su documento de origen. Un elemento incrustado que contiene vínculos dentro de él de forma similar puede quedar desactualizado. La función realiza una comprobación de recursiva del elemento OLE. Tenga en cuenta que puede ser más costoso que realmente realizar una actualización determinar si un elemento OLE no está actualizado.  
  
 Esto se llama de forma automática la [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) implementación.  
  
 Para obtener más información, consulte [IOleObject::IsUpToDate](http://msdn.microsoft.com/library/windows/desktop/ms686624) en el SDK de Windows.  
  
##  <a name="ismodified"></a>  COleClientItem::IsModified  
 Llame a esta función para ver si el elemento OLE está desfasado (modificado desde que se guardó por última vez).  
  
```  
BOOL IsModified() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si el elemento OLE está dañado; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 Para obtener más información, consulte [IPersistStorage::IsDirty](http://msdn.microsoft.com/library/windows/desktop/ms683910) en el SDK de Windows.  
  
##  <a name="isopen"></a>  COleClientItem::IsOpen  
 Llame a esta función para ver si el elemento OLE está abierto; es decir, se abre en una instancia de la aplicación de servidor que se ejecuta en una ventana independiente.  
  
```  
BOOL IsOpen() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si el elemento OLE está abierto; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 Se utiliza para determinar cuándo se debe dibujar el objeto con un modelo de sombreado. Un objeto abierto debe tener un patrón de trama que se dibujan en la parte superior del objeto. Puede usar un [CRectTracker](../../mfc/reference/crecttracker-class.md) objeto para lograr esto.  
  
##  <a name="isrunning"></a>  COleClientItem::IsRunning  
 Llame a esta función para ver si se está ejecutando el elemento OLE; es decir, si el elemento está cargado y ejecutándose en la aplicación de servidor.  
  
```  
BOOL IsRunning() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si se está ejecutando el elemento OLE; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 Para obtener más información, consulte [OleIsRunning](http://msdn.microsoft.com/library/windows/desktop/ms688705) en el SDK de Windows.  
  
##  <a name="onactivate"></a>  COleClientItem::OnActivate  
 Lo llama el marco de trabajo para notificar el elemento que simplemente se haya activado en su lugar.  
  
```  
virtual void OnActivate();
```  
  
### <a name="remarks"></a>Comentarios  
 Tenga en cuenta que esta función se llama para indicar que el servidor está ejecutando, no para indicar que se ha instalado su interfaz de usuario de la aplicación contenedora. En este momento, el objeto no tiene una interfaz de usuario activas (no es `activeUIState`). No se ha instalado sus menús o barra de herramientas. El [OnActivateUI](#onactivateui) función miembro se llama cuando esto ocurre.  
  
 La implementación predeterminada llama el [OnChange](#onchange) función miembro con **OLE_CHANGEDSTATE** como un parámetro. Reemplace esta función para realizar un procesamiento personalizado cuando un elemento se convierte en activo en contexto.  
  
##  <a name="onactivateui"></a>  COleClientItem::OnActivateUI  
 Las llamadas de framework `OnActivateUI` cuando el objeto ha entrado en el estado activo de la interfaz de usuario.  
  
```  
virtual void OnActivateUI();
```  
  
### <a name="remarks"></a>Comentarios  
 El objeto ya ha instalado su barra de herramientas y menús.  
  
 La implementación predeterminada recuerda el servidor `HWND` para más tarde **GetServerWindow** llamadas.  
  
##  <a name="onchange"></a>  COleClientItem  
 Lo llama el marco de trabajo cuando el usuario modifica, guarda o cierra el elemento OLE.  
  
```  
virtual void OnChange(
    OLE_NOTIFICATION nCode,  
    DWORD dwParam);
```  
  
### <a name="parameters"></a>Parámetros  
 `nCode`  
 El motivo del servidor ha cambiado este elemento. Puede tener uno de los valores siguientes:  
  
- `OLE_CHANGED` Ha cambiado la apariencia del elemento OLE.  
  
- `OLE_SAVED` Se ha guardado el elemento OLE.  
  
- `OLE_CLOSED` Se ha cerrado el elemento OLE.  
  
- `OLE_CHANGED_STATE` El elemento OLE ha cambiado de un estado a otro.  
  
 `dwParam`  
 Si `nCode` es `OLE_SAVED` o `OLE_CLOSED`, este parámetro no se utiliza. Si `nCode` es `OLE_CHANGED`, este parámetro especifica el aspecto del elemento OLE que ha cambiado. Para los valores posibles, vea el `dwParam` parámetro de [COleClientItem::Draw](#draw). Si `nCode` es `OLE_CHANGED_STATE`, este parámetro es un **COleClientItem:: ItemState** valor enumerado y se describe el estado que se especifiquen. Puede tener uno de los siguientes valores: `emptyState`, **loadedState**, `openState`, `activeState`, o `activeUIState`.  
  
### <a name="remarks"></a>Comentarios  
 (Si la aplicación de servidor se escribe utilizando la biblioteca Microsoft Foundation Class, esta función se invoca en respuesta a la `Notify` las funciones miembro de `COleServerDoc` o `COleServerItem`.) La implementación predeterminada marca el documento contenedor como modificado si `nCode` es `OLE_CHANGED` o `OLE_SAVED`.  
  
 Para `OLE_CHANGED_STATE`, el estado actual devuelto desde [GetItemState](#getitemstate) seguirá siendo el estado anterior, lo que significa que el estado actual antes de realizar este cambio de estado.  
  
 Reemplace esta función para responder a los cambios en el estado del elemento OLE. Suele ser actualización la apariencia del elemento por lo que invalida el área en la que se muestra el elemento. Llamar a la implementación de la clase base al principio de la invalidación.  
  
##  <a name="onchangeitemposition"></a>  COleClientItem:: OnChangeItemPosition  
 Lo llama el marco de trabajo para notificar al contenedor que ha cambiado la extensión del elemento OLE durante la activación en contexto.  
  
```  
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```  
  
### <a name="parameters"></a>Parámetros  
 *rectPos*  
 Indica la posición del elemento con respecto al área de cliente de la aplicación contenedora.  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si la posición del elemento se ha cambiado correctamente. en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 La implementación predeterminada determina el nuevo rectángulo visible del elemento OLE y las llamadas [SetItemRects](#setitemrects) con los nuevos valores. La implementación predeterminada calcula el rectángulo visible para el elemento y pasa esa información al servidor.  
  
 Reemplace esta función para aplicar reglas especiales para la operación de cambio de tamaño o mover. Si la aplicación está escrita en MFC, esta llamada se produce porque el servidor denominado [COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).  
  
##  <a name="ondeactivate"></a>  COleClientItem::OnDeactivate  
 Lo llama el marco cuando el elemento OLE realiza una transición desde el estado activo en contexto ( `activeState`) al estado cargado, lo que significa que se desactiva después de la activación en contexto.  
  
```  
virtual void OnDeactivate();
```  
  
### <a name="remarks"></a>Comentarios  
 Tenga en cuenta que esta función se llama para indicar que el elemento OLE está cerrado, no que se ha quitado su interfaz de usuario de la aplicación contenedora. Cuando esto ocurre, el [OnDeactivateUI](#ondeactivateui) se llama la función miembro.  
  
 La implementación predeterminada llama el [OnChange](#onchange) función miembro con **OLE_CHANGEDSTATE** como un parámetro. Reemplace esta función para realizar un procesamiento personalizado cuando se desactiva un elemento activo en contexto. Por ejemplo, si se admite el comando Deshacer en la aplicación contenedora, puede invalidar esta función para descartar el estado de deshacer, que indica que la última operación realizada en el elemento OLE no se puede deshacer una vez que el elemento está desactivado.  
  
##  <a name="ondeactivateandundo"></a>  COleClientItem::OnDeactivateAndUndo  
 Lo llama el marco cuando el usuario invoca el comando Deshacer después de activar el elemento OLE en contexto.  
  
```  
virtual void OnDeactivateAndUndo();
```  
  
### <a name="remarks"></a>Comentarios  
 La implementación predeterminada llama [DeactivateUI](#deactivateui) para desactivar la interfaz de usuario del servidor. Reemplace esta función si está implementando el comando Deshacer de la aplicación contenedora. En la invalidación, llame a la versión de la clase base de la función y, a continuación, deshaga el último comando ejecutado en la aplicación.  
  
 Para obtener más información, consulte [IOleInPlaceSite::DeactivateAndUndo](http://msdn.microsoft.com/library/windows/desktop/ms683743) en el SDK de Windows.  
  
##  <a name="ondeactivateui"></a>  COleClientItem::OnDeactivateUI  
 Se llama cuando el usuario desactiva un elemento que se ha activado en su lugar.  
  
```  
virtual void OnDeactivateUI(BOOL bUndoable);
```  
  
### <a name="parameters"></a>Parámetros  
 `bUndoable`  
 Especifica si se puede deshacer los cambios de edición.  
  
### <a name="remarks"></a>Comentarios  
 Esta función restaura a su estado original, ocultar los menús y otros controles que se crearon para la activación en contexto de interfaz de usuario de la aplicación contenedora.  
  
 Si `bUndoable` es **FALSE**, el contenedor debe deshabilitar el comando Deshacer, no es que se pueden deshacer en vigor descartar el estado de deshacer del contenedor, ya que indica que la última operación realizada por el servidor.  
  
##  <a name="ondiscardundostate"></a>  COleClientItem::OnDiscardUndoState  
 Lo llama el marco cuando el usuario realiza una acción que se descarta el estado de deshacer mientras se edita el elemento OLE.  
  
```  
virtual void OnDiscardUndoState();
```  
  
### <a name="remarks"></a>Comentarios  
 La implementación predeterminada no hace nada. Reemplace esta función si está implementando el comando Deshacer de la aplicación contenedora. En la invalidación, descarte el estado de deshacer de la aplicación contenedora.  
  
 Si el servidor se ha escrito con la biblioteca Microsoft Foundation Class, el servidor puede producir esta función ser llamado por una llamada a [COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate).  
  
 Para obtener más información, consulte [IOleInPlaceSite::DiscardUndoState](http://msdn.microsoft.com/library/windows/desktop/ms688642) en el SDK de Windows.  
  
##  <a name="ongetclipboarddata"></a>  COleClientItem::OnGetClipboardData  
 Lo llama el marco para obtener un `COleDataSource` objeto que contiene todos los datos que se van a colocar en el Portapapeles mediante una llamada a la [CopyToClipboard](#copytoclipboard) o [DoDragDrop](#dodragdrop) función miembro.  
  
```  
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,  
    LPPOINT lpOffset,  
    LPSIZE lpSize);
```  
  
### <a name="parameters"></a>Parámetros  
 `bIncludeLink`  
 Establezca esta propiedad en **TRUE** si vincular datos deben copiarse en el Portapapeles. Establezca esta propiedad en **FALSE** si la aplicación de servidor no admite vínculos.  
  
 `lpOffset`  
 Puntero al desplazamiento del cursor del mouse desde el origen del objeto en píxeles.  
  
 `lpSize`  
 Puntero al tamaño del objeto en píxeles.  
  
### <a name="return-value"></a>Valor devuelto  
 Un puntero a un [COleDataSource](../../mfc/reference/coledatasource-class.md) objeto que contiene los datos del Portapapeles.  
  
### <a name="remarks"></a>Comentarios  
 La implementación predeterminada de esta función llama [GetClipboardData](#getclipboarddata).  
  
##  <a name="ongetcliprect"></a>  COleClientItem::OnGetClipRect  
 Las llamadas de framework la `OnGetClipRect` función de miembro para obtener las coordenadas del rectángulo de recorte del elemento que se está editando en su lugar.  
  
```  
virtual void OnGetClipRect(CRect& rClipRect);
```  
  
### <a name="parameters"></a>Parámetros  
 *rClipRect*  
 Puntero a un objeto de clase [CRect](../../atl-mfc-shared/reference/crect-class.md) que contendrá las coordenadas del rectángulo de recorte del elemento.  
  
### <a name="remarks"></a>Comentarios  
 Las coordenadas están en píxeles con respecto al área de cliente de la ventana de aplicación de contenedor.  
  
 La implementación predeterminada simplemente devuelve el rectángulo de cliente de la vista en la que el elemento está activo en contexto.  
  
##  <a name="ongetitemposition"></a>  COleClientItem:: OnGetItemPosition  
 Las llamadas de framework la `OnGetItemPosition` función de miembro para obtener las coordenadas del elemento que se está editando en su lugar.  
  
```  
virtual void OnGetItemPosition(CRect& rPosition);
```  
  
### <a name="parameters"></a>Parámetros  
 `rPosition`  
 Referencia a la [CRect](../../atl-mfc-shared/reference/crect-class.md) objeto que va a contener coordenadas de posición del elemento.  
  
### <a name="remarks"></a>Comentarios  
 Las coordenadas están en píxeles con respecto al área de cliente de la ventana de aplicación de contenedor.  
  
 La implementación predeterminada de esta función no hace nada. Las aplicaciones que admiten la edición en contexto requieren su implementación.  
  
##  <a name="ongetwindowcontext"></a>  COleClientItem::OnGetWindowContext  
 Llamado por el marco de trabajo cuando se activa un elemento en su lugar.  
  
```  
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,  
    CFrameWnd** ppDocFrame,  
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```  
  
### <a name="parameters"></a>Parámetros  
 `ppMainFrame`  
 Puntero a un puntero a la ventana de marco principal.  
  
 `ppDocFrame`  
 Puntero a un puntero a la ventana de marco de documento.  
  
 `lpFrameInfo`  
 Puntero a un [OLEINPLACEFRAMEINFO](http://msdn.microsoft.com/library/windows/desktop/ms693737) estructura que recibirá la información de la ventana de marco.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 Esta función se utiliza para recuperar información acerca de la ventana primaria del elemento OLE.  
  
 Si el contenedor es una aplicación MDI, la implementación predeterminada devuelve un puntero a la [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) objeto `ppMainFrame` y un puntero a activos [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) objeto en `ppDocFrame`. Si el contenedor es una aplicación SDI, la implementación predeterminada devuelve un puntero a la [CFrameWnd](../../mfc/reference/cframewnd-class.md) objeto `ppMainFrame` y devuelve **NULL** en `ppDocFrame`. La implementación predeterminada también se rellena en los miembros de `lpFrameInfo`.  
  
 Reemplace esta función sólo si la implementación predeterminada no se ajusta a la aplicación; Por ejemplo, si la aplicación tiene un paradigma de interfaz de usuario que difiere de SDI o MDI. Avanzada reemplazable.  
  
 Para obtener más información, consulte [IOleInPlaceSite::GetWindowContext](http://msdn.microsoft.com/library/windows/desktop/ms694366) y [OLEINPLACEFRAMEINFO](http://msdn.microsoft.com/library/windows/desktop/ms693737) estructura en el SDK de Windows.  
  
##  <a name="oninsertmenus"></a>  COleClientItem::OnInsertMenus  
 Lo llama el marco de trabajo durante la activación en contexto para insertar los menús de la aplicación contenedora en un menú vacío.  
  
```  
virtual void OnInsertMenus(
    CMenu* pMenuShared,  
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```  
  
### <a name="parameters"></a>Parámetros  
 `pMenuShared`  
 Apunta a un menú vacío.  
  
 `lpMenuWidths`  
 Señala a una matriz de seis **largo** valores que indica cuántos de los menús están en cada uno de los siguientes grupos de menús: archivo, edición, contenedor, objeto, ventana Ayuda. La aplicación contenedora es responsable de los grupos de menú archivo, contenedor y ventana corresponden a elementos de 0, 2 y 4 de esta matriz.  
  
### <a name="remarks"></a>Comentarios  
 Este menú, a continuación, se pasa al servidor, que inserta sus propios menús, crear un menú compuesto. Esta función se puede llamar varias veces para crear varios menús compuestos.  
  
 Inserta la implementación predeterminada `pMenuShared` los menús de contenedor en contexto, es decir, los grupos de menú archivo, contenedor y ventana. [CDocTemplate:: SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) se usa para establecer este recurso de menú. La implementación predeterminada también asigna los valores correspondientes a los elementos 0, 2 y 4 en `lpMenuWidths`, según el recurso de menú. Reemplace esta función si la implementación predeterminada no es adecuada para su aplicación; Por ejemplo, si la aplicación no usa plantillas de documento para asociar recursos a tipos de documentos. Si reemplaza esta función, también debe invalidar [OnSetMenu](#onsetmenu) y [OnRemoveMenus](#onremovemenus). Avanzada reemplazable.  
  
 Para obtener más información, consulte [IOleInPlaceFrame::InsertMenus](http://msdn.microsoft.com/library/windows/desktop/ms683987) en el SDK de Windows.  
  
##  <a name="onremovemenus"></a>  COleClientItem::OnRemoveMenus  
 Lo llama el marco de trabajo para quitar los menús del contenedor en el menú compuesto especificado cuando finaliza la activación en contexto.  
  
```  
virtual void OnRemoveMenus(CMenu* pMenuShared);
```  
  
### <a name="parameters"></a>Parámetros  
 `pMenuShared`  
 Apunta al menú compuesto construido mediante llamadas a la [OnInsertMenus](#oninsertmenus) función miembro.  
  
### <a name="remarks"></a>Comentarios  
 Quita de la implementación predeterminada de `pMenuShared` los menús de contenedor en contexto, que es, los grupos de menú archivo, contenedor y ventana. Reemplace esta función si la implementación predeterminada no es adecuada para su aplicación; Por ejemplo, si la aplicación no usa plantillas de documento para asociar recursos a tipos de documentos. Si reemplaza esta función, probablemente se debe invalidar [OnInsertMenus](#oninsertmenus) y [OnSetMenu](#onsetmenu) así. Avanzada reemplazable.  
  
 Los submenús `pMenuShared` pueden estar compartidos por más de un menú compuesto si el servidor se llama repetidamente `OnInsertMenus`. Por lo tanto, no debe eliminar cualquier submenús en el reemplazo del `OnRemoveMenus`; solo debe separarlas.  
  
 Para obtener más información, consulte [IOleInPlaceFrame::RemoveMenus](http://msdn.microsoft.com/library/windows/desktop/ms688685) en el SDK de Windows.  
  
##  <a name="onscrollby"></a>  COleClientItem::OnScrollBy  
 Lo llama el marco para desplazar el elemento OLE en respuesta a las solicitudes del servidor.  
  
```  
virtual BOOL OnScrollBy(CSize sizeExtent);
```  
  
### <a name="parameters"></a>Parámetros  
 *sizeExtent*  
 Especifica la distancia, en píxeles, para desplazarse en la x e y direcciones.  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si el elemento se desplaza; 0 si no se puede desplazar el elemento.  
  
### <a name="remarks"></a>Comentarios  
 Por ejemplo, si el elemento OLE está parcialmente visible y el usuario se mueve fuera del área visible mientras se realiza la edición en contexto, esta función se invoca para mantener visible el cursor. La implementación predeterminada no hace nada. Reemplace esta función para desplazar el elemento en la cantidad especificada. Tenga en cuenta que, como resultado de desplazamiento, puede cambiar la parte visible del elemento OLE. Llame a [SetItemRects](#setitemrects) actualizar rectángulo visible del elemento.  
  
 Para obtener más información, consulte [IOleInPlaceSite::Scroll](http://msdn.microsoft.com/library/windows/desktop/ms690291) en el SDK de Windows.  
  
##  <a name="onsetmenu"></a>  COleClientItem::OnSetMenu  
 El marco llama a dos veces cuando la activación en contexto comienza y finaliza; la primera vez que instale el menú compuesto y la segunda vez (con `holemenu` igual a **NULL**) para quitar el equipo.  
  
```  
virtual void OnSetMenu(
    CMenu* pMenuShared,  
    HOLEMENU holemenu,  
    HWND hwndActiveObject);
```  
  
### <a name="parameters"></a>Parámetros  
 `pMenuShared`  
 Puntero al menú compuesto construido mediante llamadas a la [OnInsertMenus](#oninsertmenus) función miembro y `InsertMenu` función.  
  
 `holemenu`  
 Identificador del descriptor de menú devuelto por la **OleCreateMenuDescriptor** función, o **NULL** si el código de distribución es va a quitar.  
  
 *hwndActiveObject*  
 Identificador de la ventana de edición para el elemento OLE. Se trata de la ventana que recibirá los comandos de edición de OLE.  
  
### <a name="remarks"></a>Comentarios  
 La implementación predeterminada se instala o quita el menú compuesto y, a continuación, llama a la [OleSetMenuDescriptor](http://msdn.microsoft.com/library/windows/desktop/ms692831) función para instalar o quitar el código de distribución. Reemplace esta función si la implementación predeterminada no es adecuada para su aplicación. Si reemplaza esta función, probablemente se debe invalidar [OnInsertMenus](#oninsertmenus) y [OnRemoveMenus](#onremovemenus) así. Avanzada reemplazable.  
  
 Para obtener más información, consulte [OleCreateMenuDescriptor](http://msdn.microsoft.com/library/windows/desktop/ms691415), [OleSetMenuDescriptor](http://msdn.microsoft.com/library/windows/desktop/ms692831), y [IOleInPlaceFrame:: SetMenu](http://msdn.microsoft.com/library/windows/desktop/ms693713) del SDK de Windows.  
  
##  <a name="onshowcontrolbars"></a>  COleClientItem::OnShowControlBars  
 Lo llama el marco de trabajo para mostrar y ocultar las barras de control de la aplicación contenedora.  
  
```  
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,  
    BOOL bShow);
```  
  
### <a name="parameters"></a>Parámetros  
 `pFrameWnd`  
 Puntero a la ventana de marco de la aplicación contenedora. Puede tratarse de una ventana de marco principal o una ventana secundaria MDI.  
  
 `bShow`  
 Especifica si las barras de control se pueden mostrar u ocultar.  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si la llamada de función provoca un cambio de estado de las barras de control; 0 si la llamada no produce ningún cambio, o si `pFrameWnd` no apunta a la ventana de marco del contenedor.  
  
### <a name="remarks"></a>Comentarios  
 Esta función devuelve 0 si las barras de control ya están en el estado especificado por *bMostrar.* Esto podría suceder, por ejemplo, si se ocultan las barras de control y `bShow` es **FALSE**.  
  
 La implementación predeterminada, quita la barra de herramientas de la ventana de marco de nivel superior.  
  
##  <a name="onshowitem"></a>  COleClientItem::OnShowItem  
 Lo llama el marco de trabajo para mostrar el elemento OLE, haciéndolo totalmente visible durante la edición.  
  
```  
virtual void OnShowItem();
```  
  
### <a name="remarks"></a>Comentarios  
 Se usa cuando la aplicación contenedora admite vínculos a elementos incrustados (es decir, si ha derivado una clase de documento de [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Esta función se invoca durante la activación en contexto o cuando el elemento OLE es un origen de vínculo y el usuario desea editar. La implementación predeterminada, activa la primera vista en el documento contenedor. Reemplace esta función para desplazar el documento para que esté visible el elemento OLE.  
  
##  <a name="onupdateframetitle"></a>  COleClientItem::OnUpdateFrameTitle  
 Lo llama el marco de trabajo durante la activación en contexto para actualizar la barra de título de la ventana de marco.  
  
```  
virtual BOOL OnUpdateFrameTitle();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si esta función actualizó correctamente el título del marco, contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 La implementación predeterminada no cambia el título de la ventana de marco. Reemplace esta función si desea un título de otro fotograma para la aplicación, por ejemplo " *aplicación server* - *elemento* en *NombreMéd*" (como en "Microsoft Excel - hoja de cálculo en el informe. DOC"). Avanzada reemplazable.  
  
##  <a name="reactivateandundo"></a>  COleClientItem::ReactivateAndUndo  
 Llame a esta función para volver a activar el elemento OLE y deshacer la última operación realizada por el usuario durante la edición en contexto.  
  
```  
BOOL ReactivateAndUndo();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 Si la aplicación contenedora es compatible con el comando Deshacer, llame a esta función si el usuario elige el comando Deshacer inmediatamente después de desactivar el elemento OLE.  
  
 Si la aplicación de servidor está escrita con las bibliotecas de clases de Microsoft Foundation, esta función hace que el servidor llamar a [COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).  
  
 Para obtener más información, consulte [IOleInPlaceObject::ReactivateAndUndo](http://msdn.microsoft.com/library/windows/desktop/ms691372) en el SDK de Windows.  
  
##  <a name="release"></a>  COleClientItem::Release  
 Llame a esta función para limpiar los recursos utilizados por el elemento OLE.  
  
```  
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```  
  
### <a name="parameters"></a>Parámetros  
 `dwCloseOption`  
 Indicador que especifica en qué circunstancias se guarda el elemento OLE al regresar al estado cargado. Para obtener una lista de valores posibles, consulte [COleClientItem::Close](#close).  
  
### <a name="remarks"></a>Comentarios  
 **Versión** llama a la `COleClientItem` destructor.  
  
 Para obtener más información, consulte [IUnknown:: Release](http://msdn.microsoft.com/library/windows/desktop/ms682317) del SDK de Windows.  
  
##  <a name="reload"></a>  COleClientItem::Reload  
 Cierra y vuelve a cargar el elemento.  
  
```  
BOOL Reload();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 Llame a la `Reload` función después de activar el elemento como un elemento de otro tipo mediante una llamada a [ActivateAs](#activateas).  
  
##  <a name="run"></a>  COleClientItem::Run  
 Se ejecuta la aplicación asociada con este elemento.  
  
```  
void Run();
```  
  
### <a name="remarks"></a>Comentarios  
 Llame a la **ejecutar** función de miembro para iniciar la aplicación de servidor antes de activar el elemento. Esto se hace automáticamente [activar](#activate) y [DoVerb](#doverb), por lo que normalmente no es necesario llamar a esta función. Llame a esta función si es necesario ejecutar el servidor con el fin de establecer un atributo del elemento, como [SetExtent](#setextent), antes de ejecutar [DoVerb](#doverb).  
  
##  <a name="setdrawaspect"></a>  COleClientItem::SetDrawAspect  
 Llame a la `SetDrawAspect` función de miembro para establecer el "aspecto" o la vista del elemento.  
  
```  
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```  
  
### <a name="parameters"></a>Parámetros  
 `nDrawAspect`  
 Un valor de la enumeración `DVASPECT`. Este parámetro puede tener uno de los valores siguientes:  
  
- `DVASPECT_CONTENT` Elemento se representa de manera que puede mostrarse como un objeto incrustado dentro de su contenedor.  
  
- `DVASPECT_THUMBNAIL` Elemento se representa en una representación en forma de "vista en miniatura", por lo que puede mostrarse en una herramienta de exploración.  
  
- `DVASPECT_ICON` Elemento se representa mediante un icono.  
  
- `DVASPECT_DOCPRINT` Elemento se representa como si se imprimiera utilizando el comando Imprimir en el menú archivo.  
  
### <a name="remarks"></a>Comentarios  
 El aspecto especifica cómo se va a representar el elemento [dibujar](#draw) cuando el valor predeterminado para esa función `nDrawAspect` se usa el argumento.  
  
 Esta función se invoca automáticamente mediante el icono de cambio (y otros cuadros de diálogo que llaman directamente el cuadro de diálogo Cambiar icono) para habilitar el aspecto del icono mostrar cuando se solicita el usuario.  
  
##  <a name="setextent"></a>  COleClientItem::SetExtent  
 Llame a esta función para especificar la cantidad de espacio está disponible para el elemento OLE.  
  
```  
void SetExtent(
    const CSize& size,  
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```  
  
### <a name="parameters"></a>Parámetros  
 `size`  
 A [CSize](../../atl-mfc-shared/reference/csize-class.md) objeto que contiene la información de tamaño.  
  
 `nDrawAspect`  
 Especifica el aspecto del elemento OLE cuyos límites que se van a establecer. Para los valores posibles, vea [SetDrawAspect](#setdrawaspect).  
  
### <a name="remarks"></a>Comentarios  
 Si la aplicación de servidor se ha escrito utilizando la biblioteca Microsoft Foundation Class, se produce la [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) función de miembro de los correspondientes `COleServerItem` objeto que se va a llamar. El elemento OLE, a continuación, puede ajustar su presentación según corresponda. Las dimensiones deben estar en `MM_HIMETRIC` unidades. Llame a esta función cuando el usuario cambia el tamaño del elemento OLE o si se admite alguna forma de negociación de diseño.  
  
 Para obtener más información, consulte [IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330) en el SDK de Windows.  
  
##  <a name="sethostnames"></a>  COleClientItem::SetHostNames  
 Llame a esta función para especificar el nombre de la aplicación contenedora y el nombre del contenedor para un elemento OLE incrustado.  
  
```  
void SetHostNames(
    LPCTSTR lpszHost,  
    LPCTSTR lpszHostObj);
```  
  
### <a name="parameters"></a>Parámetros  
 `lpszHost`  
 Puntero al nombre de usuario visible a través de la aplicación contenedora.  
  
 `lpszHostObj`  
 Puntero a una cadena de identificación del contenedor que contiene el elemento OLE.  
  
### <a name="remarks"></a>Comentarios  
 Si la aplicación de servidor se ha escrito utilizando la biblioteca Microsoft Foundation Class, esta función llama a la [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) función miembro de la `COleServerDoc` documento que contiene el elemento OLE. Esta información se utiliza en los títulos de ventana cuando se está editando el elemento OLE. Cada vez que se carga un documento contenedor, el marco de trabajo llama a esta función para todos los elementos OLE en el documento. `SetHostNames` solo es aplicable a los elementos incrustados. No es necesario llamar a esta función cada vez que se activa un elemento OLE incrustado para su edición.  
  
 Esto también se denomina automáticamente con el nombre de la aplicación y el nombre del documento cuando se carga un objeto o cuando se guarda un archivo con un nombre diferente. En consecuencia, no es suele ser necesario llamar directamente a esta función.  
  
 Para obtener más información, consulte [IOleObject::SetHostNames](http://msdn.microsoft.com/library/windows/desktop/ms680642) en el SDK de Windows.  
  
##  <a name="seticonicmetafile"></a>  COleClientItem::SetIconicMetafile  
 Almacena en caché el metarchivo usado para dibujar el icono del elemento.  
  
```  
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```  
  
### <a name="parameters"></a>Parámetros  
 `hMetaPict`  
 Un identificador para el metarchivo usado para dibujar el icono del elemento.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 Use [GetIconicMetafile](#geticonicmetafile) para recuperar el metarchivo.  
  
 El `hMetaPict` parámetro se copia en el elemento; por lo tanto, `hMetaPict` debe ser liberado por el llamador.  
  
##  <a name="setitemrects"></a>  COleClientItem::SetItemRects  
 Llame a esta función para establecer el rectángulo delimitador o el rectángulo visible del elemento OLE.  
  
```  
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,  
    LPCRECT lpClipRect = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 *lprcPosRect*  
 Puntero al rectángulo que contiene los límites del elemento OLE con respecto a su ventana primaria, en coordenadas de cliente.  
  
 *lprcClipRect*  
 Puntero al rectángulo que contiene los límites de la parte visible del elemento OLE con respecto a su ventana primaria, en coordenadas de cliente.  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si se realiza correctamente; en caso contrario, es 0.  
  
### <a name="remarks"></a>Comentarios  
 Esta función llama a la implementación predeterminada de la [OnChangeItemPosition](#onchangeitemposition) función miembro. Debe llamar a esta función siempre que los cambios del elemento de la posición o la parte visible de OLE. Normalmente, esto significa que se llama desde la vista [OnSize](../../mfc/reference/cwnd-class.md#onsize) y [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) funciones miembro.  
  
 Para obtener más información, consulte [IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767) en el SDK de Windows.  
  
##  <a name="setlinkupdateoptions"></a>  COleClientItem::SetLinkUpdateOptions  
 Llame a esta función para establecer la opción de actualización de los vínculos para la presentación del elemento vinculado especificado.  
  
```  
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```  
  
### <a name="parameters"></a>Parámetros  
 *dwUpdateOpt*  
 El valor de la opción de actualización de los vínculos de este elemento. Este valor debe ser uno de los siguientes:  
  
- `OLEUPDATE_ALWAYS` Actualizar el elemento vinculado siempre que sea posible. Esta opción es compatible con el botón de opción de actualización automática de los vínculos en el cuadro de diálogo de vínculos.  
  
- `OLEUPDATE_ONCALL` Actualizar el elemento vinculado solo en la solicitud de la aplicación contenedora (cuando la [UpdateLink](#updatelink) se llama la función miembro). Esta opción es compatible con el botón de opción de actualización Manual de los vínculos en el cuadro de diálogo de vínculos.  
  
### <a name="remarks"></a>Comentarios  
 Por lo general, no debe cambiar las opciones de actualización elegidas por el usuario en el cuadro de diálogo de vínculos.  
  
 Para obtener más información, consulte [IOleLink::SetUpdateOptions](http://msdn.microsoft.com/library/windows/desktop/ms680120) en el SDK de Windows.  
  
##  <a name="setprintdevice"></a>  COleClientItem::SetPrintDevice  
 Llame a esta función para cambiar el dispositivo de destino de impresión para este elemento.  
  
```  
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);  
BOOL SetPrintDevice(const PRINTDLG* ppd);
```  
  
### <a name="parameters"></a>Parámetros  
 `ptd`  
 Puntero a un [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) estructuras de datos que contiene información sobre el nuevo dispositivo de destino de impresión. Puede ser **NULL**.  
  
 `ppd`  
 Puntero a un [PRINTDLG](http://msdn.microsoft.com/library/windows/desktop/ms646940) estructuras de datos que contiene información sobre el nuevo dispositivo de destino de impresión. Puede ser **NULL**.  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si la función se realizó correctamente; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 Esta función actualiza el dispositivo de destino de impresión para el elemento pero no actualiza la caché de presentación. Para actualizar la caché de presentación para un elemento, llame a [UpdateLink](#updatelink).  
  
 Los argumentos a esta función contienen información que el sistema OLE se usa para identificar el dispositivo de destino. El **PRINTDLG** estructura contiene información que Windows usa para inicializar el cuadro de diálogo de impresión comunes. Después de que el usuario cierra el cuadro de diálogo, Windows devuelve información acerca de las selecciones del usuario en esta estructura. El `m_pd` miembro de un [CPrintDialog](../../mfc/reference/cprintdialog-class.md) objeto es un **PRINTDLG** estructura.  
  
 Para obtener más información acerca de esta estructura, vea [PRINTDLG](http://msdn.microsoft.com/library/windows/desktop/ms646843) del SDK de Windows.  
  
 Para obtener más información, consulte [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) del SDK de Windows.  
  
##  <a name="updatelink"></a>  COleClientItem::UpdateLink  
 Llame a esta función para actualizar inmediatamente los datos de presentación del elemento OLE.  
  
```  
BOOL UpdateLink();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Distinto de cero en caso de éxito; en caso contrario, es 0.  
  
### <a name="remarks"></a>Comentarios  
 Para los elementos vinculados, la función no encuentra el origen del vínculo para obtener una nueva presentación para el elemento OLE. Este proceso puede implicar ejecuta una o varias aplicaciones de servidor, que pueden llevar mucho tiempo. Para los elementos incrustados, la función actúa de forma recursiva, comprobar si el elemento incrustado contiene vínculos que podrían estar obsoletos y actualizarlos. El usuario puede actualizar manualmente los vínculos individuales mediante el cuadro de diálogo de vínculos.  
  
 Para obtener más información, consulte [IOleLink::Update](http://msdn.microsoft.com/library/windows/desktop/ms692660) en el SDK de Windows.  
  
## <a name="see-also"></a>Vea también  
 [Ejemplo MFC MFCBIND](../../visual-cpp-samples.md)   
 [Ejemplo MFC OCLIENT](../../visual-cpp-samples.md)   
 [Clase CDocItem](../../mfc/reference/cdocitem-class.md)   
 [Gráfico de jerarquías](../../mfc/hierarchy-chart.md)   
 [COleServerItem (clase)](../../mfc/reference/coleserveritem-class.md)
