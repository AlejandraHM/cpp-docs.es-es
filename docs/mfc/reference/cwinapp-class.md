---
title: CWinApp (clase) | Documentos de Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CWinApp
- AFXWIN/CWinApp
- AFXWIN/CWinApp::CWinApp
- AFXWIN/CWinApp::AddDocTemplate
- AFXWIN/CWinApp::AddToRecentFileList
- AFXWIN/CWinApp::ApplicationRecoveryCallback
- AFXWIN/CWinApp::CloseAllDocuments
- AFXWIN/CWinApp::CreatePrinterDC
- AFXWIN/CWinApp::DelRegTree
- AFXWIN/CWinApp::DoMessageBox
- AFXWIN/CWinApp::DoWaitCursor
- AFXWIN/CWinApp::EnableD2DSupport
- AFXWIN/CWinApp::EnableHtmlHelp
- AFXWIN/CWinApp::EnableTaskbarInteraction
- AFXWIN/CWinApp::ExitInstance
- AFXWIN/CWinApp::GetApplicationRecoveryParameter
- AFXWIN/CWinApp::GetApplicationRecoveryPingInterval
- AFXWIN/CWinApp::GetApplicationRestartFlags
- AFXWIN/CWinApp::GetAppRegistryKey
- AFXWIN/CWinApp::GetDataRecoveryHandler
- AFXWIN/CWinApp::GetFirstDocTemplatePosition
- AFXWIN/CWinApp::GetHelpMode
- AFXWIN/CWinApp::GetNextDocTemplate
- AFXWIN/CWinApp::GetPrinterDeviceDefaults
- AFXWIN/CWinApp::GetProfileBinary
- AFXWIN/CWinApp::GetProfileInt
- AFXWIN/CWinApp::GetProfileString
- AFXWIN/CWinApp::GetSectionKey
- AFXWIN/CWinApp::HideApplication
- AFXWIN/CWinApp::HtmlHelp
- AFXWIN/CWinApp::InitInstance
- AFXWIN/CWinApp::IsTaskbarInteractionEnabled
- AFXWIN/CWinApp::LoadCursor
- AFXWIN/CWinApp::LoadIcon
- AFXWIN/CWinApp::LoadOEMCursor
- AFXWIN/CWinApp::LoadOEMIcon
- AFXWIN/CWinApp::LoadStandardCursor
- AFXWIN/CWinApp::LoadStandardIcon
- AFXWIN/CWinApp::OnDDECommand
- AFXWIN/CWinApp::OnIdle
- AFXWIN/CWinApp::OpenDocumentFile
- AFXWIN/CWinApp::ParseCommandLine
- AFXWIN/CWinApp::PreTranslateMessage
- AFXWIN/CWinApp::ProcessMessageFilter
- AFXWIN/CWinApp::ProcessShellCommand
- AFXWIN/CWinApp::ProcessWndProcException
- AFXWIN/CWinApp::Register
- AFXWIN/CWinApp::RegisterWithRestartManager
- AFXWIN/CWinApp::ReopenPreviousFilesAtRestart
- AFXWIN/CWinApp::RestartInstance
- AFXWIN/CWinApp::RestoreAutosavedFilesAtRestart
- AFXWIN/CWinApp::Run
- AFXWIN/CWinApp::RunAutomated
- AFXWIN/CWinApp::RunEmbedded
- AFXWIN/CWinApp::SaveAllModified
- AFXWIN/CWinApp::SelectPrinter
- AFXWIN/CWinApp::SetHelpMode
- AFXWIN/CWinApp::SupportsApplicationRecovery
- AFXWIN/CWinApp::SupportsAutosaveAtInterval
- AFXWIN/CWinApp::SupportsAutosaveAtRestart
- AFXWIN/CWinApp::SupportsRestartManager
- AFXWIN/CWinApp::Unregister
- AFXWIN/CWinApp::WinHelp
- AFXWIN/CWinApp::WriteProfileBinary
- AFXWIN/CWinApp::WriteProfileInt
- AFXWIN/CWinApp::WriteProfileString
- AFXWIN/CWinApp::EnableShellOpen
- AFXWIN/CWinApp::LoadStdProfileSettings
- AFXWIN/CWinApp::OnContextHelp
- AFXWIN/CWinApp::OnFileNew
- AFXWIN/CWinApp::OnFileOpen
- AFXWIN/CWinApp::OnFilePrintSetup
- AFXWIN/CWinApp::OnHelp
- AFXWIN/CWinApp::OnHelpFinder
- AFXWIN/CWinApp::OnHelpIndex
- AFXWIN/CWinApp::OnHelpUsing
- AFXWIN/CWinApp::RegisterShellFileTypes
- AFXWIN/CWinApp::SetAppID
- AFXWIN/CWinApp::SetRegistryKey
- AFXWIN/CWinApp::UnregisterShellFileTypes
- AFXWIN/CWinApp::m_bHelpMode
- AFXWIN/CWinApp::m_eHelpType
- AFXWIN/CWinApp::m_hInstance
- AFXWIN/CWinApp::m_lpCmdLine
- AFXWIN/CWinApp::m_nCmdShow
- AFXWIN/CWinApp::m_pActiveWnd
- AFXWIN/CWinApp::m_pszAppID
- AFXWIN/CWinApp::m_pszAppName
- AFXWIN/CWinApp::m_pszExeName
- AFXWIN/CWinApp::m_pszHelpFilePath
- AFXWIN/CWinApp::m_pszProfileName
- AFXWIN/CWinApp::m_pszRegistryKey
- AFXWIN/CWinApp::m_dwRestartManagerSupportFlags
- AFXWIN/CWinApp::m_nAutosaveInterval
- AFXWIN/CWinApp::m_pDataRecoveryHandler
dev_langs:
- C++
helpviewer_keywords:
- CWinApp [MFC], CWinApp
- CWinApp [MFC], AddDocTemplate
- CWinApp [MFC], AddToRecentFileList
- CWinApp [MFC], ApplicationRecoveryCallback
- CWinApp [MFC], CloseAllDocuments
- CWinApp [MFC], CreatePrinterDC
- CWinApp [MFC], DelRegTree
- CWinApp [MFC], DoMessageBox
- CWinApp [MFC], DoWaitCursor
- CWinApp [MFC], EnableD2DSupport
- CWinApp [MFC], EnableHtmlHelp
- CWinApp [MFC], EnableTaskbarInteraction
- CWinApp [MFC], ExitInstance
- CWinApp [MFC], GetApplicationRecoveryParameter
- CWinApp [MFC], GetApplicationRecoveryPingInterval
- CWinApp [MFC], GetApplicationRestartFlags
- CWinApp [MFC], GetAppRegistryKey
- CWinApp [MFC], GetDataRecoveryHandler
- CWinApp [MFC], GetFirstDocTemplatePosition
- CWinApp [MFC], GetHelpMode
- CWinApp [MFC], GetNextDocTemplate
- CWinApp [MFC], GetPrinterDeviceDefaults
- CWinApp [MFC], GetProfileBinary
- CWinApp [MFC], GetProfileInt
- CWinApp [MFC], GetProfileString
- CWinApp [MFC], GetSectionKey
- CWinApp [MFC], HideApplication
- CWinApp [MFC], HtmlHelp
- CWinApp [MFC], InitInstance
- CWinApp [MFC], IsTaskbarInteractionEnabled
- CWinApp [MFC], LoadCursor
- CWinApp [MFC], LoadIcon
- CWinApp [MFC], LoadOEMCursor
- CWinApp [MFC], LoadOEMIcon
- CWinApp [MFC], LoadStandardCursor
- CWinApp [MFC], LoadStandardIcon
- CWinApp [MFC], OnDDECommand
- CWinApp [MFC], OnIdle
- CWinApp [MFC], OpenDocumentFile
- CWinApp [MFC], ParseCommandLine
- CWinApp [MFC], PreTranslateMessage
- CWinApp [MFC], ProcessMessageFilter
- CWinApp [MFC], ProcessShellCommand
- CWinApp [MFC], ProcessWndProcException
- CWinApp [MFC], Register
- CWinApp [MFC], RegisterWithRestartManager
- CWinApp [MFC], ReopenPreviousFilesAtRestart
- CWinApp [MFC], RestartInstance
- CWinApp [MFC], RestoreAutosavedFilesAtRestart
- CWinApp [MFC], Run
- CWinApp [MFC], RunAutomated
- CWinApp [MFC], RunEmbedded
- CWinApp [MFC], SaveAllModified
- CWinApp [MFC], SelectPrinter
- CWinApp [MFC], SetHelpMode
- CWinApp [MFC], SupportsApplicationRecovery
- CWinApp [MFC], SupportsAutosaveAtInterval
- CWinApp [MFC], SupportsAutosaveAtRestart
- CWinApp [MFC], SupportsRestartManager
- CWinApp [MFC], Unregister
- CWinApp [MFC], WinHelp
- CWinApp [MFC], WriteProfileBinary
- CWinApp [MFC], WriteProfileInt
- CWinApp [MFC], WriteProfileString
- CWinApp [MFC], EnableShellOpen
- CWinApp [MFC], LoadStdProfileSettings
- CWinApp [MFC], OnContextHelp
- CWinApp [MFC], OnFileNew
- CWinApp [MFC], OnFileOpen
- CWinApp [MFC], OnFilePrintSetup
- CWinApp [MFC], OnHelp
- CWinApp [MFC], OnHelpFinder
- CWinApp [MFC], OnHelpIndex
- CWinApp [MFC], OnHelpUsing
- CWinApp [MFC], RegisterShellFileTypes
- CWinApp [MFC], SetAppID
- CWinApp [MFC], SetRegistryKey
- CWinApp [MFC], UnregisterShellFileTypes
- CWinApp [MFC], m_bHelpMode
- CWinApp [MFC], m_eHelpType
- CWinApp [MFC], m_hInstance
- CWinApp [MFC], m_lpCmdLine
- CWinApp [MFC], m_nCmdShow
- CWinApp [MFC], m_pActiveWnd
- CWinApp [MFC], m_pszAppID
- CWinApp [MFC], m_pszAppName
- CWinApp [MFC], m_pszExeName
- CWinApp [MFC], m_pszHelpFilePath
- CWinApp [MFC], m_pszProfileName
- CWinApp [MFC], m_pszRegistryKey
- CWinApp [MFC], m_dwRestartManagerSupportFlags
- CWinApp [MFC], m_nAutosaveInterval
- CWinApp [MFC], m_pDataRecoveryHandler
ms.assetid: e426a3cd-0d15-40d6-bd55-beaa5feb2343
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: aab01b0f55d19ef3c9d39fed38b42471f559ba8d
ms.sourcegitcommit: 208d445fd7ea202de1d372d3f468e784e77bd666
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/29/2018
ms.locfileid: "37123206"
---
# <a name="cwinapp-class"></a>CWinApp (clase)
La clase base de la que se deriva un objeto de aplicación Windows.  
  
## <a name="syntax"></a>Sintaxis  
  
```  
class CWinApp : public CWinThread  
```  
  
## <a name="members"></a>Miembros  
  
### <a name="public-constructors"></a>Constructores públicos  
  
|Name|Descripción|  
|----------|-----------------|  
|[CWinApp::CWinApp](#cwinapp)|Construye un objeto `CWinApp`.|  
  
### <a name="public-methods"></a>Métodos públicos  
  
|Name|Descripción|  
|----------|-----------------|  
|[CWinApp:: AddDocTemplate](#adddoctemplate)|Agrega una plantilla de documento a la lista de la aplicación de plantillas de documentos disponibles.|  
|[CWinApp::AddToRecentFileList](#addtorecentfilelist)|Agrega un nombre de archivo a la lista de archivos usa más recientemente (MRU).|  
|[CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback)|Llamado por el marco de trabajo cuando la aplicación se cierra inesperadamente.|  
|[CWinApp::CloseAllDocuments](#closealldocuments)|Cierra todos los documentos abiertos.|  
|[CWinApp::CreatePrinterDC](#createprinterdc)|Crea un contexto de dispositivo de impresora.|  
|[CWinApp::DelRegTree](#delregtree)|Elimina una clave especificada y todas sus subclaves.|  
|[CWinApp::DoMessageBox](#domessagebox)|Implementa [AfxMessageBox](cstring-formatting-and-message-box-display.md#afxmessagebox) para la aplicación.|  
|[CWinApp::DoWaitCursor](#dowaitcursor)|El cursor de espera activa y desactiva.|  
|[CWinApp::EnableD2DSupport](#enabled2dsupport)|Habilita la compatibilidad D2D de aplicación. Llame a este método antes de que se inicialice la ventana principal.|  
|[CWinApp::EnableHtmlHelp](#enablehtmlhelp)|Implementa HTMLHelp para la aplicación, en lugar de WinHelp.|  
|[CWinApp::EnableTaskbarInteraction](#enabletaskbarinteraction)|Permite la interacción de la barra de tareas.|  
|[CWinApp:: ExitInstance](#exitinstance)|Reemplace este valor para limpiar cuando finaliza la aplicación.|  
|[CWinApp::GetApplicationRecoveryParameter](#getapplicationrecoveryparameter)|Recupera el parámetro de entrada para el método de recuperación de la aplicación.|  
|[CWinApp::GetApplicationRecoveryPingInterval](#getapplicationrecoverypinginterval)|Devuelve la longitud de tiempo que espera el Administrador de reinicio para que la función de devolución de llamada de recuperación devolver.|  
|[CWinApp::GetApplicationRestartFlags](#getapplicationrestartflags)|Devuelve las marcas para el Administrador de reinicio.|  
|[CWinApp::GetAppRegistryKey](#getappregistrykey)|Devuelve la clave de HKEY_CURRENT_USER\\\RegistryKey\ProfileName "Software".|  
|[CWinApp::GetDataRecoveryHandler](#getdatarecoveryhandler)|Obtiene el controlador de recuperación de datos para esta instancia de la aplicación.|  
|[CWinApp::GetFirstDocTemplatePosition](#getfirstdoctemplateposition)|Recupera la posición de la primera plantilla de documento.|  
|[CWinApp::GetHelpMode](#gethelpmode)|Recupera el tipo de ayuda utilizado por la aplicación.|  
|[CWinApp::GetNextDocTemplate](#getnextdoctemplate)|Recupera la posición de una plantilla de documento. Se pueden utilizar de forma recursiva.|  
|[CWinApp::GetPrinterDeviceDefaults](#getprinterdevicedefaults)|Recupera los valores predeterminados de dispositivo de impresora.|  
|[CWinApp::GetProfileBinary](#getprofilebinary)|Recupera datos binarios de una entrada en la aplicación. Archivo INI.|  
|[CWinApp::GetProfileInt](#getprofileint)|Recupera un entero de una entrada en la aplicación. Archivo INI.|  
|[CWinApp::GetProfileString](#getprofilestring)|Recupera una cadena de una entrada en la aplicación. Archivo INI.|  
|[CWinApp::GetSectionKey](#getsectionkey)|Devuelve la clave de HKEY_CURRENT_USER\\\RegistryKey\AppName\lpszSection "Software".|  
|[CWinApp::HideApplication](#hideapplication)|Oculta la aplicación antes de cerrar todos los documentos.|  
|[CWinApp::HtmlHelp](#htmlhelp)|Llamadas a la `HTMLHelp` la función de Windows.|  
|[CWinApp:: InitInstance](#initinstance)|Reemplace este valor para realizar la inicialización de la instancia de Windows, como la creación de los objetos de ventana.|  
|[CWinApp::IsTaskbarInteractionEnabled](#istaskbarinteractionenabled)|Indica si está habilitada la interacción de la barra de tareas de Windows 7.|  
|[CWinApp::LoadCursor](#loadcursor)|Carga un recurso de cursor.|  
|[CWinApp::LoadIcon](#loadicon)|Carga un recurso de icono.|  
|[CWinApp::LoadOEMCursor](#loadoemcursor)|Carga un OEM de Windows predefinidos cursor que la **OCR_** constantes se especifican en WINDOWS. H.|  
|[CWinApp::LoadOEMIcon](#loadoemicon)|Carga un icono predefinido de OEM de Windows que el **OIC_** constantes se especifican en WINDOWS. H.|  
|[CWinApp::LoadStandardCursor](#loadstandardcursor)|Carga un Windows predefinidos cursor que la **IDC_** constantes se especifican en WINDOWS. H.|  
|[CWinApp::LoadStandardIcon](#loadstandardicon)|Carga un icono predefinido de Windows que el **IDI_** constantes se especifican en WINDOWS. H.|  
|[CWinApp::OnDDECommand](#onddecommand)|Llamado por el marco de trabajo en respuesta a los datos dinámicos DDE (intercambio) ejecute el comando.|  
|[CWinApp:: OnIdle](#onidle)|Reemplace este valor para realizar el procesamiento de tiempo de inactividad específicos de la aplicación.|  
|[CWinApp:: OpenDocumentFile](#opendocumentfile)|Lo llama el marco para abrir un documento desde un archivo.|  
|[CWinApp::ParseCommandLine](#parsecommandline)|Analiza los parámetros individuales y marcas en la línea de comandos.|  
|[CWinApp:: PreTranslateMessage](#pretranslatemessage)|Filtra los mensajes antes de enviarlos a las funciones de Windows [TranslateMessage](http://msdn.microsoft.com/library/windows/desktop/ms644955) y [DispatchMessage](http://msdn.microsoft.com/library/windows/desktop/ms644934).|  
|[CWinApp::ProcessMessageFilter](#processmessagefilter)|Intercepta determinados mensajes antes de alcanzar la aplicación.|  
|[CWinApp::ProcessShellCommand](#processshellcommand)|Controla marcas y los argumentos de línea de comandos.|  
|[CWinApp::ProcessWndProcException](#processwndprocexception)|Intercepta todas las excepciones no controladas producidas por mensaje de la aplicación y controladores de comandos.|  
|[CWinApp::Register](#register)|Realiza el registro personalizado.|  
|[CWinApp::RegisterWithRestartManager](#registerwithrestartmanager)|Registra la aplicación con el Administrador de reinicio.|  
|[CWinApp::ReopenPreviousFilesAtRestart](#reopenpreviousfilesatrestart)|Determina si el Administrador de reinicio se vuelve a abrir los archivos que estaban abiertos cuando la aplicación terminó inesperadamente.|  
|[CWinApp::RestartInstance](#restartinstance)|Controla el reinicio de una aplicación iniciado por el Administrador de reinicio.|  
|[CWinApp::RestoreAutosavedFilesAtRestart](#restoreautosavedfilesatrestart)|Determina si el Administrador de reinicio restaura los archivos guardados automáticamente cuando se reinicia la aplicación.|  
|[CWinApp:: Run](#run)|Se ejecuta el bucle de mensajes de forma predeterminada. Invalidar para personalizar el bucle de mensajes.|  
|[CWinApp::RunAutomated](#runautomated)|Pruebas de línea de comandos de la aplicación para la **/automatización** opción. Obsoleto. En su lugar, utilice el valor de [CCommandLineInfo::m_bRunAutomated](../../mfc/reference/ccommandlineinfo-class.md#m_brunautomated) después de llamar a [ParseCommandLine](#parsecommandline).|  
|[CWinApp:: RunEmbedded](#runembedded)|Pruebas de línea de comandos de la aplicación para la **/incrustación** opción. Obsoleto. En su lugar, utilice el valor de [CCommandLineInfo::m_bRunEmbedded](../../mfc/reference/ccommandlineinfo-class.md#m_brunembedded) después de llamar a [ParseCommandLine](#parsecommandline).|  
|[CWinApp::SaveAllModified](#saveallmodified)|Pide al usuario guardar documentos de todas las modificaciones.|  
|[CWinApp::SelectPrinter](#selectprinter)|Selecciona una impresora previamente indicada por un usuario a través de un cuadro de diálogo de impresión.|  
|[CWinApp::SetHelpMode](#sethelpmode)|Establece e inicializa el tipo de ayuda utilizado por la aplicación.|  
|[CWinApp::SupportsApplicationRecovery](#supportsapplicationrecovery)|Determina si el Administrador de reinicio recupera una aplicación que se cerraron de forma inesperada.|  
|[CWinApp::SupportsAutosaveAtInterval](#supportsautosaveatinterval)|Determina si lo guarda el Administrador de reinicio abre documentos de manera periódica.|  
|[CWinApp::SupportsAutosaveAtRestart](#supportsautosaveatrestart)|Determina si el Administrador de reinicio guarde automáticamente cualquier abrir documentos cuando se reinicia la aplicación.|  
|[CWinApp::SupportsRestartManager](#supportsrestartmanager)|Determina si la aplicación es compatible con el Administrador de reinicio.|  
|[CWinApp::Unregister](#unregister)|Anula el registro de todo lo que sabe que pueda registrar mediante la `CWinApp` objeto.|  
|[CWinApp:: WinHelp](#winhelp)|Llamadas a la `WinHelp` la función de Windows.|  
|[CWinApp::WriteProfileBinary](#writeprofilebinary)|Escribe datos binarios en una entrada en la aplicación. Archivo INI.|  
|[CWinApp:: Writeprofileint](#writeprofileint)|Escribe un entero a una entrada de la aplicación. Archivo INI.|  
|[CWinApp::WriteProfileString](#writeprofilestring)|Escribe una cadena en una entrada en la aplicación. Archivo INI.|  
  
### <a name="protected-methods"></a>Métodos protegidos  
  
|Name|Descripción|  
|----------|-----------------|  
|[CWinApp::EnableShellOpen](#enableshellopen)|Permite al usuario abrir los archivos de datos desde el Administrador de archivos de Windows.|  
|[CWinApp::LoadStdProfileSettings](#loadstdprofilesettings)|Estándar de carga. Característica de lista de los archivos de configuración del archivo INI y habilita lo elementos utilizados Recientemente.|  
|[CWinApp::OnContextHelp](#oncontexthelp)|Controla la tecla MAYÚS + F1 Ayuda dentro de la aplicación.|  
|[CWinApp::OnFileNew](#onfilenew)|Implementa ID_FILE_NEW (comando).|  
|[CWinApp::OnFileOpen](#onfileopen)|Implementa el comando ID_FILE_OPEN.|  
|[CWinApp::OnFilePrintSetup](#onfileprintsetup)|Implementa ID_FILE_PRINT_SETUP (comando).|  
|[CWinApp::OnHelp](#onhelp)|Controla la Ayuda de F1 de la aplicación (usando el contexto actual).|  
|[CWinApp::OnHelpFinder](#onhelpfinder)|Controla los comandos ID_HELP_FINDER y ID_DEFAULT_HELP.|  
|[CWinApp::OnHelpIndex](#onhelpindex)|Controla el ID_HELP_INDEX (comando) y proporciona un tema de Ayuda predeterminado.|  
|[CWinApp::OnHelpUsing](#onhelpusing)|Controla el ID_HELP_USING (comando).|  
|[CWinApp:: RegisterShellFileTypes](#registershellfiletypes)|Registra los tipos de documento de toda la aplicación con el Administrador de archivos de Windows.|  
|[CWinApp::SetAppID](#setappid)|Se establece explícitamente el identificador del modelo de aplicación de usuario para la aplicación. Este método debe llamarse antes de que ninguna interfaz de usuario se presenta al usuario (lo mejor es el constructor de la aplicación).|  
|[CWinApp::SetRegistryKey](#setregistrykey)|Hace que se almacenará en el registro en lugar de configuración de la aplicación. Archivos INI.|  
|[CWinApp::UnregisterShellFileTypes](#unregistershellfiletypes)|Anula el registro de tipos de documentos de toda la aplicación con el Administrador de archivos de Windows.|  
  
### <a name="public-data-members"></a>Miembros de datos públicos  
  
|Name|Descripción|  
|----------|-----------------|  
|[CWinApp::m_bHelpMode](#m_bhelpmode)|Indica si el usuario está en modo de contexto de ayuda (invocado habitualmente con MAYÚS + F1).|  
|[CWinApp::m_eHelpType](#m_ehelptype)|Especifica el tipo de ayuda utilizado por la aplicación.|  
|[CWinApp::m_hInstance](#m_hinstance)|Identifica la instancia actual de la aplicación.|  
|[CWinApp:: M_lpcmdline](#m_lpcmdline)|Apunta a una cadena terminada en null que especifica la línea de comandos para la aplicación.|  
|[CWinApp::m_nCmdShow](#m_ncmdshow)|Especifica cómo se muestra inicialmente la ventana.|  
|[CWinApp::m_pActiveWnd](#m_pactivewnd)|Puntero a la ventana principal de la aplicación contenedora cuando un servidor OLE está activo en contexto.|  
|[CWinApp::m_pszAppID](#m_pszappid)|Identificador de modelo de usuario de aplicación.|  
|[CWinApp::m_pszAppName](#m_pszappname)|Especifica el nombre de la aplicación.|  
|[CWinApp::m_pszExeName](#m_pszexename)|El nombre del módulo de la aplicación.|  
|[CWinApp::m_pszHelpFilePath](#m_pszhelpfilepath)|La ruta de acceso al archivo de Ayuda de la aplicación.|  
|[CWinApp::m_pszProfileName](#m_pszprofilename)|La aplicación. Nombre de archivo INI.|  
|[CWinApp::m_pszRegistryKey](#m_pszregistrykey)|Se utiliza para determinar la clave del registro completo para almacenar la configuración de perfil de aplicación.|  
  
### <a name="protected-data-members"></a>Miembros de datos protegidos  
  
|nombre|Descripción|  
|----------|-----------------|  
|[CWinApp::m_dwRestartManagerSupportFlags](#m_dwrestartmanagersupportflags)|Indicadores que determinan cómo se comporta el Administrador de reinicio.|  
|[CWinApp::m_nAutosaveInterval](#m_nautosaveinterval)|El período de tiempo en milisegundos entre guarda.|  
|[CWinApp::m_pDataRecoveryHandler](#m_pdatarecoveryhandler)|Puntero para el controlador de recuperación de datos para la aplicación.|  
  
## <a name="remarks"></a>Comentarios  
 Un objeto de aplicación proporciona funciones miembro para inicializar la aplicación (y cada instancia de ella) y para ejecutar la aplicación.  
  
 Cada aplicación que utiliza Microsoft Foundation classes solo puede contener un objeto derivado de `CWinApp`. Este objeto se crea cuando se crean otros objetos globales de C++ y ya está disponible cuando se llama a Windows la `WinMain` función, que le ha suministrado la biblioteca Microsoft Foundation Class. Declarar la derivada `CWinApp` objeto en el nivel global.  
  
 Al derivar una clase de aplicación de `CWinApp`, invalidar la [InitInstance](#initinstance) función de miembro para crear el objeto de la ventana principal de la aplicación.  
  
 Además el `CWinApp` funciones miembro, la biblioteca Microsoft Foundation Class proporciona las siguientes funciones globales para tener acceso a su `CWinApp` objeto y otra información global:  
  
- [AfxGetApp](application-information-and-management.md#afxgetapp) Obtiene un puntero a la `CWinApp` objeto.  
  
- [AfxGetInstanceHandle](application-information-and-management.md#afxgetinstancehandle) Obtiene un identificador de la instancia de aplicación actual.  
  
- [AfxGetResourceHandle](application-information-and-management.md#afxgetresourcehandle) Obtiene un identificador de recursos de la aplicación.  
  
- [AfxGetAppName](application-information-and-management.md#afxgetappname) Obtiene un puntero a una cadena que contiene el nombre de la aplicación. Como alternativa, si tiene un puntero a la `CWinApp` objeto, utilice `m_pszExeName` para obtener el nombre de la aplicación.  
  
 Vea [CWinApp: la clase de aplicación](../../mfc/cwinapp-the-application-class.md) para obtener más información sobre la `CWinApp` (clase), incluida una descripción general de las acciones siguientes:  
  
- `CWinApp`-deriva el código escrito por el Asistente para aplicaciones.  
  
- `CWinApp`del rol en la secuencia de ejecución de la aplicación.  
  
- `CWinApp`'s implementaciones de funciones miembro de forma predeterminada.  
  
- `CWinApp`de clave se pueden sobrecargar.  
  
 El `m_hPrevInstance` miembro de datos ya no existe. Para obtener información sobre la detección de una instancia anterior de `CWinApp`, vea el artículo de Knowledge Base "Cómo identificar un anterior instancia de una aplicación" (KB106385) en [ http://support.microsoft.com/default.aspxscid=kb; en-us; 106385](http://support.microsoft.com/default.aspxscid=kb;en-us;106385).  
  
## <a name="inheritance-hierarchy"></a>Jerarquía de herencia  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWinThread](../../mfc/reference/cwinthread-class.md)  
  
 `CWinApp`  
  
## <a name="requirements"></a>Requisitos  
 **Encabezado:** afxwin.h  
  
##  <a name="adddoctemplate"></a>  CWinApp:: AddDocTemplate  
 Llame a esta función miembro para agregar una plantilla de documento a la lista de plantillas de documentos disponibles que mantiene la aplicación.  
  
```  
void AddDocTemplate(CDocTemplate* pTemplate);
```  
  
### <a name="parameters"></a>Parámetros  
 *pTemplate*  
 Un puntero a la `CDocTemplate` va a agregar.  
  
### <a name="remarks"></a>Comentarios  
 Debe agregar todos los documentos de plantillas a una aplicación antes de llamar a [RegisterShellFileTypes](#registershellfiletypes).  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#35](../../mfc/reference/codesnippet/cpp/cwinapp-class_1.cpp)]  
  
##  <a name="addtorecentfilelist"></a>  CWinApp::AddToRecentFileList  
 Llame a esta función miembro para agregar *lpszPathName* a la lista de archivos utilizados más Recientemente.  
  
```  
virtual void AddToRecentFileList(LPCTSTR lpszPathName);
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszPathName*  
 Ruta de acceso del archivo.  
  
### <a name="remarks"></a>Comentarios  
 Debe llamar a la [LoadStdProfileSettings](#loadstdprofilesettings) función de miembro para cargar la lista de archivos utilizados más Recientemente actual antes de utilizar esta función miembro.  
  
 El marco de trabajo llama a esta función miembro cuando se abre un archivo o se ejecuta el comando Guardar como para guardar un archivo con un nuevo nombre.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#36](../../mfc/reference/codesnippet/cpp/cwinapp-class_2.cpp)]  
  
##  <a name="applicationrecoverycallback"></a>  CWinApp::ApplicationRecoveryCallback  
 Llamado por el marco de trabajo cuando la aplicación se cierra inesperadamente.  
  
```  
virtual DWORD ApplicationRecoveryCallback(LPVOID lpvParam);
```  
  
### <a name="parameters"></a>Parámetros  
 [in] *lpvParam*  
 Reservado para un uso futuro.  
  
### <a name="return-value"></a>Valor devuelto  
 0 si este método se realiza correctamente; es distinto de cero si se produce un error.  
  
### <a name="remarks"></a>Comentarios  
 Si la aplicación es compatible con el Administrador de reinicio, el marco de trabajo llama a esta función cuando la aplicación se cierra inesperadamente.  
  
 La implementación predeterminada de `ApplicationRecoveryCallback` utiliza el `CDataRecoveryHandler` para guardar la lista de documentos abiertos actualmente en el registro. Este método no Autoguardado no los archivos.  
  
 Para personalizar el comportamiento, invalidan esta función en un derivada [CWinApp (clase)](../../mfc/reference/cwinapp-class.md) o pasar su propio método de recuperación de la aplicación como un parámetro a [CWinApp::RegisterWithRestartManager](#registerwithrestartmanager).  
  
##  <a name="closealldocuments"></a>  CWinApp::CloseAllDocuments  
 Llame a esta función miembro para cerrar todos los documentos abiertos antes de salir.  
  
```  
void CloseAllDocuments(BOOL bEndSession);
```  
  
### <a name="parameters"></a>Parámetros  
 *bEndSession*  
 Especifica si se permite o no que se finaliza la sesión de Windows. Es TRUE si se finaliza la sesión; en caso contrario, FALSE.  
  
### <a name="remarks"></a>Comentarios  
 Llame a [HideApplication](#hideapplication) antes de llamar a `CloseAllDocuments`.  
  
##  <a name="createprinterdc"></a>  CWinApp::CreatePrinterDC  
 Llame a esta función miembro para crear un contexto de dispositivo de impresora (DC) de la impresora seleccionada.  
  
```  
BOOL CreatePrinterDC(CDC& dc);
```  
  
### <a name="parameters"></a>Parámetros  
 *dc*  
 Una referencia a un contexto de dispositivo de impresora.  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si el contexto de dispositivo de impresora se crea correctamente; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 `CreatePrinterDC` Inicializa el contexto de dispositivo que se pasa por referencia, por lo que puede usar para imprimir.  
  
 Si la función se realiza correctamente, cuando haya terminado de impresión, deberá destruir el contexto de dispositivo. Puede dejar que el destructor de la [CDC](../../mfc/reference/cdc-class.md) objeto hacerlo, o puede hacer explícitamente mediante una llamada a [CDC::DeleteDC](../../mfc/reference/cdc-class.md#deletedc).  
  
##  <a name="cwinapp"></a>  CWinApp::CWinApp  
 Construye un `CWinApp` objeto y pasa *lpszAppName* que se almacenan como el nombre de la aplicación.  
  
```  
CWinApp(LPCTSTR lpszAppName = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszAppName*  
 Una cadena terminada en null que contiene el nombre de la aplicación que usa Windows. Si este argumento no se proporciona o es NULL, `CWinApp` usa la cadena de recurso AFX_IDS_APP_TITLE o el nombre de archivo del archivo ejecutable.  
  
### <a name="remarks"></a>Comentarios  
 Debe construir un objeto global de su `CWinApp`-clase derivada. Puede tener solo una `CWinApp` objeto en la aplicación. El constructor almacena un puntero a la `CWinApp` objeto para que `WinMain` puede llamar a del objeto funciones miembro para inicializar y ejecutar la aplicación.  
  
##  <a name="delregtree"></a>  CWinApp::DelRegTree  
 Elimina una clave del Registro específica y todas sus subclaves.  
  
```  
LONG DelRegTree(
    HKEY hParentKey,  
    const CString& strKeyName);

 
LONG DelRegTree(
    HKEY hParentKey,
    const CString& strKeyName,
    CAtlTransactionManager* pTM = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 *hParentKey*  
 Identificador de una clave del registro.  
  
 *strKeyName*  
 El nombre de la clave del registro va a eliminar.  
  
 *pTM*  
 Puntero al objeto CAtlTransactionManager.  
  
### <a name="return-value"></a>Valor devuelto  
 Si la función se realiza correctamente, el valor devuelto es ERROR_SUCCESS. Si se produce un error en la función, el valor devuelto es un código de error distinto de cero definido en Winerror.h.  
  
### <a name="remarks"></a>Comentarios  
 Llame a esta función para eliminar la clave especificada y sus subclaves.  
  
##  <a name="domessagebox"></a>  CWinApp::DoMessageBox  
 El marco de trabajo llama a esta función miembro para implementar un cuadro de mensaje para la función global [AfxMessageBox](cstring-formatting-and-message-box-display.md#afxmessagebox).  
  
```  
virtual int DoMessageBox(
    LPCTSTR lpszPrompt,  
    UINT nType,  
    UINT nIDPrompt);
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszPrompt*  
 Dirección del texto en el cuadro de mensaje.  
  
 *nLas*  
 El cuadro de mensaje [estilo](../../mfc/reference/styles-used-by-mfc.md#message-box-styles).  
  
 *nIDPrompt*  
 Un índice en una cadena de contexto de ayuda.  
  
### <a name="return-value"></a>Valor devuelto  
 Devuelve los mismos valores que `AfxMessageBox`.  
  
### <a name="remarks"></a>Comentarios  
 No llame a esta función miembro para abrir un cuadro de mensaje; Utilice `AfxMessageBox` en su lugar.  
  
 Reemplace esta función miembro para personalizar el procesamiento de toda la aplicación de `AfxMessageBox` llamadas.  
  
##  <a name="dowaitcursor"></a>  CWinApp::DoWaitCursor  
 Esta función miembro se llama el marco de trabajo para implementar [CWaitCursor](../../mfc/reference/cwaitcursor-class.md), [CCmdTarget::BeginWaitCursor](../../mfc/reference/ccmdtarget-class.md#beginwaitcursor), [CCmdTarget::EndWaitCursor](../../mfc/reference/ccmdtarget-class.md#endwaitcursor), y [ CCmdTarget::RestoreWaitCursor](../../mfc/reference/ccmdtarget-class.md#restorewaitcursor).  
  
```  
virtual void DoWaitCursor(int nCode);
```  
  
### <a name="parameters"></a>Parámetros  
 *nCode*  
 Si este parámetro es 1, aparece un cursor de espera. Si es 0, el cursor de espera se restaura sin incrementar el recuento de referencias. Si es-1, se finaliza el cursor de espera.  
  
### <a name="remarks"></a>Comentarios  
 El valor predeterminado implementa un cursor de reloj de arena. `DoWaitCursor` mantiene un recuento de referencias. Si es positivo, se muestra el cursor de reloj de arena.  
  
 Mientras no se llama normalmente `DoWaitCursor` directamente, podría invalidar esta función miembro para cambiar el cursor de espera o para realizar un procesamiento adicional mientras se muestra el cursor de espera.  
  
 Para que una forma más fácil y más sencilla que implemente un cursor de espera, utilice `CWaitCursor`.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#37](../../mfc/reference/codesnippet/cpp/cwinapp-class_3.cpp)]  
  
##  <a name="enabled2dsupport"></a>  CWinApp::EnableD2DSupport  
 [!INCLUDE[dev10_sp1required](../../mfc/reference/includes/dev10_sp1required_md.md)]  
  
 Habilita la compatibilidad D2D de aplicación. Llame a este método antes de que se inicialice la ventana principal.  
  
```  
BOOL EnableD2DSupport(
D2D1_FACTORY_TYPE d2dFactoryType = D2D1_FACTORY_TYPE_SINGLE_THREADED,  
DWRITE_FACTORY_TYPE writeFactoryType = DWRITE_FACTORY_TYPE_SHARED);
```  
  
### <a name="parameters"></a>Parámetros  
 *d2dFactoryType*  
 El modelo de subprocesos de la fábrica de D2D y los recursos crea.  
  
 *writeFactoryType*  
 Un valor que especifica si el objeto de generador de escritura se comparten o aislado  
  
### <a name="return-value"></a>Valor devuelto  
 Devuelve TRUE si compatibilidad D2D estaba habilitado, es FALSE - en caso contrario  
  
##  <a name="enablehtmlhelp"></a>  CWinApp::EnableHtmlHelp  
 Llame a esta función miembro desde dentro del constructor de la `CWinApp`-clase derivada para usar HTMLHelp para obtener ayuda de la aplicación.  
  
```  
void EnableHtmlHelp();
```  
  
### <a name="remarks"></a>Comentarios  
  
##  <a name="enableshellopen"></a>  CWinApp::EnableShellOpen  
 Llamar a esta función, normalmente desde su `InitInstance` override, para permitir que los usuarios de su aplicación abrir archivos de datos cuando haga doble clic en los archivos desde el Administrador de archivos en Windows.  
  
```  
void EnableShellOpen();
```  
  
### <a name="remarks"></a>Comentarios  
 Llame a la `RegisterShellFileTypes` funciona junto con esta función miembro, o proporcionar una. Archivo REG con la aplicación para realizar el registro manual de los tipos de documento.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#38](../../mfc/reference/codesnippet/cpp/cwinapp-class_4.cpp)]  
  
##  <a name="enabletaskbarinteraction"></a>  CWinApp::EnableTaskbarInteraction  
 Permite la interacción de la barra de tareas.  
  
```  
BOOL EnableTaskbarInteraction(BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>Parámetros  
 *bHabilitar el*  
 Especifica si la interacción con la barra de tareas de Windows 7 debe estar habilitada (TRUE) o deshabilitado (FALSE).  
  
### <a name="return-value"></a>Valor devuelto  
 Devuelve TRUE si la interacción de la barra de tareas puede habilitarse o deshabilitarse.  
  
### <a name="remarks"></a>Comentarios  
 Debe llamar a este método antes de la creación de la ventana principal, en caso contrario, valida y devuelve FALSE.  
  
##  <a name="exitinstance"></a>  CWinApp:: ExitInstance  
 Lo llama el marco desde el `Run` función de miembro para salir de esta instancia de la aplicación.  
  
```  
virtual int ExitInstance();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Código de salida de la aplicación; 0 indica que no hay errores y los valores mayores que 0 indican un error. Este valor se utiliza como el valor devuelto de `WinMain`.  
  
### <a name="remarks"></a>Comentarios  
 No llame a esta función miembro desde cualquier lugar pero dentro del `Run` función miembro.  
  
 La implementación predeterminada de esta función escribe opciones framework a la aplicación. Archivo INI. Reemplace esta función para realizar una limpieza cuando finaliza la aplicación.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#39](../../mfc/reference/codesnippet/cpp/cwinapp-class_5.cpp)]  
  
##  <a name="getapplicationrecoveryparameter"></a>  CWinApp::GetApplicationRecoveryParameter  
 Recupera el parámetro de entrada para el método de recuperación de la aplicación.  
  
```  
virtual LPVOID GetApplicationRecoveryParameter();
```  
  
### <a name="return-value"></a>Valor devuelto  
 El parámetro de entrada predeterminado para el método de recuperación de la aplicación.  
  
### <a name="remarks"></a>Comentarios  
 El comportamiento predeterminado de esta función devuelve NULL.  
  
 Para obtener más información, consulte [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).  
  
##  <a name="getapplicationrecoverypinginterval"></a>  CWinApp::GetApplicationRecoveryPingInterval  
 Devuelve la longitud de tiempo que espera el Administrador de reinicio para que la función de devolución de llamada de recuperación devolver.  
  
```  
virtual DWORD GetApplicationRecoveryPingInterval();
```  
  
### <a name="return-value"></a>Valor devuelto  
 El período de tiempo en milisegundos.  
  
### <a name="remarks"></a>Comentarios  
 Cuando una aplicación que se registra con el reinicio manager se cierra inesperadamente, la aplicación intenta guardar los documentos abiertos y llama a la función de devolución de llamada de recuperación. La función de devolución de llamada de recuperación predeterminado es [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).  
  
 El período de tiempo que espera la función de devolución de llamada de recuperación devolver el marco de trabajo es el intervalo de ping. Puede personalizar el intervalo de ping invalidando `CWinApp::GetApplicationRecoveryPingInterval` , o proporcionando un valor personalizado a `RegisterWithRestartManager`.  
  
##  <a name="getapplicationrestartflags"></a>  CWinApp::GetApplicationRestartFlags  
 Devuelve las marcas para el Administrador de reinicio.  
  
```  
virtual DWORD GetApplicationRestartFlags();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Las marcas para el Administrador de reinicio. La implementación predeterminada devuelve 0.  
  
### <a name="remarks"></a>Comentarios  
 Las marcas para el Administrador de reinicio no tienen ningún efecto con la implementación predeterminada. Se proporcionan para su uso futuro.  
  
 Se establecen las marcas al registrar la aplicación con el Administrador de reinicio mediante el uso de [CWinApp::RegisterWithRestartManager](#registerwithrestartmanager).  
  
 Los posibles valores para las marcas del Administrador de reinicio son como sigue:  
  
- RESTART_NO_CRASH  
  
- RESTART_NO_HANG  
  
- RESTART_NO_PATCH  
  
- RESTART_NO_REBOOT  
  
##  <a name="getappregistrykey"></a>  CWinApp::GetAppRegistryKey  
 Devuelve la clave de HKEY_CURRENT_USER\\\RegistryKey\ProfileName "Software".  
  
```  
HKEY GetAppRegistryKey(CAtlTransactionManager* pTM = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 *pTM*  
 Puntero a un `CAtlTransactionManager` objeto.  
  
### <a name="return-value"></a>Valor devuelto  
 Clave de aplicación si la función se realiza correctamente; en caso contrario, es NULL.  
  
### <a name="remarks"></a>Comentarios  
  
##  <a name="getdatarecoveryhandler"></a>  CWinApp::GetDataRecoveryHandler  
 Obtiene el controlador de recuperación de datos para esta instancia de la aplicación.  
  
```  
virtual CDataRecoveryHandler *GetDataRecoveryHandler();
```  
  
### <a name="return-value"></a>Valor devuelto  
 El controlador de recuperación de datos para esta instancia de la aplicación.  
  
### <a name="remarks"></a>Comentarios  
 Cada aplicación que utiliza el Administrador de reinicio debe tener una instancia de la [CDataRecoveryHandler clase](../../mfc/reference/cdatarecoveryhandler-class.md). Esta clase es responsable de supervisar Autoguardado archivos y documentos abiertos. El comportamiento de la `CDataRecoveryHandler` depende de la configuración del Administrador de reinicio. Para obtener más información, consulte [CDataRecoveryHandler clase](../../mfc/reference/cdatarecoveryhandler-class.md).  
  
 Este método devuelve NULL en los sistemas operativos anteriores a Windows Vista. El Administrador de reinicio no se admite en sistemas operativos anteriores a Windows Vista.  
  
 Si la aplicación no tiene actualmente un controlador de recuperación de datos, este método crea uno y devuelve un puntero a ella.  
  
##  <a name="getfirstdoctemplateposition"></a>  CWinApp::GetFirstDocTemplatePosition  
 Obtiene la posición de la primera plantilla de documento en la aplicación.  
  
```  
POSITION GetFirstDocTemplatePosition() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 Un valor de posición que se puede usar para la iteración o recuperación de puntero de objeto; Es NULL si la lista está vacía.  
  
### <a name="remarks"></a>Comentarios  
 Use el valor de posición devuelto en una llamada a [GetNextDocTemplate](#getnextdoctemplate) para obtener el primer [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) objeto.  
  
##  <a name="gethelpmode"></a>  CWinApp::GetHelpMode  
 Recupera el tipo de ayuda utilizado por la aplicación.  
  
```  
AFX_HELP_TYPE GetHelpMode();
```  
  
### <a name="return-value"></a>Valor devuelto  
 El tipo de ayuda utilizado por la aplicación. Vea [CWinApp::m_eHelpType](#m_ehelptype) para obtener más información.  
  
##  <a name="getnextdoctemplate"></a>  CWinApp::GetNextDocTemplate  
 Obtiene la plantilla de documento identificada por *pos*, a continuación, establece *pos* en el valor de posición.  
  
```  
CDocTemplate* GetNextDocTemplate(POSITION& pos) const;  
```  
  
### <a name="parameters"></a>Parámetros  
 *punto de venta*  
 Una referencia a un valor de posición devuelto por una llamada anterior a `GetNextDocTemplate` o [funciones miembro GetFirstDocTemplatePosition](#getfirstdoctemplateposition). El valor se actualiza a la siguiente posición de esta llamada.  
  
### <a name="return-value"></a>Valor devuelto  
 Un puntero a un [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) objeto.  
  
### <a name="remarks"></a>Comentarios  
 Puede usar `GetNextDocTemplate` en un bucle de iteración de avance, si establece la posición inicial con una llamada a `GetFirstDocTemplatePosition`.  
  
 Debe asegurarse de que el valor de posición es válido. Si no es válido, se valida la versión de depuración de la biblioteca Microsoft Foundation Class.  
  
 Si la plantilla de documento recuperado es el último disponible, a continuación, el nuevo valor de *pos* se establece en NULL.  
  
##  <a name="getprinterdevicedefaults"></a>  CWinApp::GetPrinterDeviceDefaults  
 Llame a esta función miembro para preparar a una impresora de contexto de dispositivo para la impresión.  
  
```  
BOOL GetPrinterDeviceDefaults(struct tagPDA* pPrintDlg);
```  
  
### <a name="parameters"></a>Parámetros  
 *pPrintDlg*  
 Un puntero a un [PRINTDLG](http://msdn.microsoft.com/library/windows/desktop/ms646843) estructura.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 Recupera los valores predeterminados de impresora actuales de las ventanas. Archivo INI según sea necesario, o usan la última configuración de impresora establecida por el usuario en el programa de instalación de impresión.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#40](../../mfc/reference/codesnippet/cpp/cwinapp-class_6.cpp)]  
  
##  <a name="getprofilebinary"></a>  CWinApp::GetProfileBinary  
 Llame a esta función miembro para recuperar datos binarios de una entrada dentro de una sección especificada del registro de la aplicación o. Archivo INI.  
  
```  
BOOL GetProfileBinary(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    LPBYTE* ppData,  
    UINT* pBytes);
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszSection*  
 Apunta a una cadena terminada en NULL que especifica la sección que contiene la entrada.  
  
 *lpszEntry*  
 Apunta a una cadena terminada en NULL que contiene la entrada cuyo valor se va a recuperar.  
  
 *ppData*  
 Apunta a un puntero que va a recibir la dirección de los datos.  
  
 *pBytes*  
 Apunta a un tipo UINT que recibirá el tamaño de los datos (en bytes).  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="remarks"></a>Comentarios  
 Esta función miembro no distingue mayúsculas de minúsculas, por lo que las cadenas en el *lpszSection* y *lpszEntry* parámetros pueden diferir en mayúsculas.  
  
> [!NOTE]
> `GetProfileBinary` asigna un búfer y devuelve su dirección en \* *ppData*. El llamador es responsable de liberar el búfer utilizando **delete []**.  
  
> [!IMPORTANT]
>  Los datos devueltos por esta función no están terminados en NULL necesariamente y el llamador debe realizar la validación. Para obtener más información, vea [Avoiding Buffer Overruns](http://msdn.microsoft.com/library/windows/desktop/ms717795)(Evitar saturaciones del búfer).  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#41](../../mfc/reference/codesnippet/cpp/cwinapp-class_7.cpp)]  
  
 Para obtener un ejemplo adicional, consulte [CWinApp::WriteProfileBinary](#writeprofilebinary).  
  
##  <a name="getprofileint"></a>  CWinApp::GetProfileInt  
 Llame a esta función miembro para recuperar el valor de un entero de una entrada dentro de una sección especificada del registro o el archivo .INI de la aplicación.  
  
```  
UINT GetProfileInt(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    int nDefault);
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszSection*  
 Apunta a una cadena terminada en NULL que especifica la sección que contiene la entrada.  
  
 *lpszEntry*  
 Apunta a una cadena terminada en NULL que contiene la entrada cuyo valor se va a recuperar.  
  
 *nDefault*  
 Especifica el valor predeterminado que se devolverá si el marco no puede encontrar la entrada.  
  
### <a name="return-value"></a>Valor devuelto  
 Valor entero de la cadena que hay a continuación de la entrada especificada si la función se realiza correctamente. El valor devuelto es el valor de la *nDefault* parámetro si la función no encuentra la entrada. El valor devuelto es 0 si el valor correspondiente a la entrada especificada no es un entero.  
  
 Esta función miembro admite la notación hexadecimal para el valor del archivo .INI. Cuando se recupera un entero con signo, debe convertir el valor en un **int**.  
  
### <a name="remarks"></a>Comentarios  
 Esta función miembro no distingue mayúsculas de minúsculas, por lo que las cadenas en el *lpszSection* y *lpszEntry* parámetros pueden diferir en mayúsculas.  
  
> [!IMPORTANT]
>  Los datos devueltos por esta función no están terminados en NULL necesariamente y el llamador debe realizar la validación. Para obtener más información, vea [Avoiding Buffer Overruns](http://msdn.microsoft.com/library/windows/desktop/ms717795)(Evitar saturaciones del búfer).  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#42](../../mfc/reference/codesnippet/cpp/cwinapp-class_8.cpp)]  
  
 Para obtener un ejemplo adicional, consulte [CWinApp:: Writeprofileint](#writeprofileint).  
  
##  <a name="getprofilestring"></a>  CWinApp::GetProfileString  
 Llame a esta función miembro para recuperar la cadena asociada a una entrada de la sección especificada en el registro de la aplicación o. Archivo INI.  
  
```  
CString GetProfileString(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    LPCTSTR lpszDefault = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszSection*  
 Apunta a una cadena terminada en NULL que especifica la sección que contiene la entrada.  
  
 *lpszEntry*  
 Apunta a una cadena terminada en null que contiene la entrada cuya cadena se van a recuperar. Este valor no debe ser NULL.  
  
 *lpszDefault*  
 Señala el valor de cadena predeterminado para la entrada dada, si no se encuentra la entrada en el archivo de inicialización.  
  
### <a name="return-value"></a>Valor devuelto  
 El valor devuelto es la cadena de la aplicación. El archivo INI o *lpszDefault* si no se encuentra la cadena. La longitud de cadena máxima admitida por el marco de trabajo es _MAX_PATH. Si *lpszDefault* es NULL, el valor devuelto es una cadena vacía.  
  
### <a name="remarks"></a>Comentarios  
  
> [!IMPORTANT]
>  Los datos devueltos por esta función no están terminados en NULL necesariamente y el llamador debe realizar la validación. Para obtener más información, vea [Avoiding Buffer Overruns](http://msdn.microsoft.com/library/windows/desktop/ms717795)(Evitar saturaciones del búfer).  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#43](../../mfc/reference/codesnippet/cpp/cwinapp-class_9.cpp)]  
  
 Para obtener otro ejemplo, vea el ejemplo de [CWinApp::GetProfileInt](#getprofileint).  
  
##  <a name="getsectionkey"></a>  CWinApp::GetSectionKey  
 Devuelve la clave de HKEY_CURRENT_USER\\\RegistryKey\AppName\lpszSection "Software".  
  
```  
HKEY GetSectionKey(
LPCTSTR lpszSection,  
CAtlTransactionManager* pTM = NULL);
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszSection*  
 El nombre de la clave que se va a obtener.  
  
 *pTM*  
 Puntero a un `CAtlTransactionManager` objeto.  
  
### <a name="return-value"></a>Valor devuelto  
 Clave de sección si la función se realiza correctamente; en caso contrario, es NULL.  
  
### <a name="remarks"></a>Comentarios  
  
##  <a name="hideapplication"></a>  CWinApp::HideApplication  
 Llame a esta función miembro para ocultar una aplicación antes de cerrar los documentos abiertos.  
  
```  
void HideApplication();
```  
  
##  <a name="htmlhelp"></a>  CWinApp::HtmlHelp  
 Llame a esta función miembro para invocar la aplicación HTMLHelp.  
  
```  
virtual void HtmlHelp(
    DWORD_PTR dwData,  
    UINT nCmd = 0x000F);
```  
  
### <a name="parameters"></a>Parámetros  
 *dwData*  
 Especifica datos adicionales. El valor utilizado depende del valor de la *nCmd* parámetro.  
  
 *nCmd*  
 Especifica el tipo de ayuda solicitado. Para obtener una lista de valores posibles y cómo afectan a la *dwData* parámetro, vea la *uCommand* parámetro que se describe en acerca de la API de función HTMLHelp en el SDK de Windows.  
  
### <a name="remarks"></a>Comentarios  
 El marco de trabajo también llama a esta función para invocar la aplicación HTMLHelp.  
  
 El marco de trabajo cerrará automáticamente la aplicación HTMLHelp cuando finaliza la aplicación.  
  
##  <a name="initinstance"></a>  CWinApp:: InitInstance  
 Windows permite varias copias del mismo programa para ejecutarse al mismo tiempo.  
  
```  
virtual BOOL InitInstance();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si la inicialización se realiza correctamente; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 Inicialización de la aplicación conceptualmente se divide en dos secciones: inicialización de la aplicación de un solo uso que se hace la primera vez el programa se ejecuta, y el tiempo de inicialización de la instancia que se ejecuta cada uno una copia de las ejecuciones de programa, incluida la primera vez. Implementación del marco de trabajo de `WinMain` llama a esta función.  
  
 Invalidar `InitInstance` para inicializar cada nueva instancia de la aplicación que se ejecuta en Windows. Por lo general, invalidar `InitInstance` para construir el objeto de la ventana principal y establecer el `CWinThread::m_pMainWnd` miembro de datos para que señale a esa ventana. Para obtener más información sobre cómo reemplazar esta función miembro, vea [CWinApp: la clase de aplicación](../../mfc/cwinapp-the-application-class.md).  
  
> [!NOTE]
>  Las aplicaciones MFC deben inicializarse como contenedor uniproceso (STA). Si se llama a [CoInitializeEx](http://msdn.microsoft.com/library/windows/desktop/ms695279) en su `InitInstance` invalidar, especifique COINIT_APARTMENTTHREADED (en lugar de COINIT_MULTITHREADED). Para obtener más información, vea PRB: aplicación MFC deja de responder cuando se inicializa la aplicación como un multiproceso apartamento (828643) en [ http://support.microsoft.com/default.aspxscid=kb; en-us; 828643](http://support.microsoft.com/default.aspxscid=kb;en-us;828643).  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCListView#9](../../atl/reference/codesnippet/cpp/cwinapp-class_10.cpp)]  
  
##  <a name="istaskbarinteractionenabled"></a>  CWinApp::IsTaskbarInteractionEnabled  
 Indica si está habilitada la interacción de la barra de tareas de Windows 7.  
  
```  
virtual BOOL IsTaskbarInteractionEnabled();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Devuelve TRUE si `EnableTaskbarInteraction` se ha llamado y el sistema operativo es Windows 7 o superior.  
  
### <a name="remarks"></a>Comentarios  
 Interacción de la barra de tareas significa que aplicación MDI muestra el contenido de elementos secundarios MDI en las miniaturas con pestañas independientes que aparecen cuando el puntero del mouse está sobre el botón de barra de tareas de la aplicación.  
  
##  <a name="loadcursor"></a>  CWinApp::LoadCursor  
 Carga el recurso del cursor con el nombre por *lpszResourceName* o especificado por *nIDResource* desde el archivo ejecutable actual.  
  
```  
HCURSOR LoadCursor(LPCTSTR lpszResourceName) const;  HCURSOR LoadCursor(UINT nIDResource) const;  
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszResourceName*  
 Apunta a una cadena terminada en null que contiene el nombre del recurso de cursor. Puede usar un `CString` para este argumento.  
  
 *nIDResource*  
 Identificador del recurso de cursor. Para obtener una lista de recursos, consulte [LoadCursor](http://msdn.microsoft.com/library/windows/desktop/ms648391) del SDK de Windows.  
  
### <a name="return-value"></a>Valor devuelto  
 Un identificador de un cursor si se realiza correctamente; en caso contrario, es NULL.  
  
### <a name="remarks"></a>Comentarios  
 `LoadCursor` carga el cursor en la memoria únicamente si aún no ha previamente cargado; en caso contrario, recupera un identificador de recurso existente.  
  
 Use la [LoadStandardCursor](#loadstandardcursor) o [LoadOEMCursor](#loadoemcursor) función miembro para tener acceso a los cursores predefinidos de Windows.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#44](../../mfc/reference/codesnippet/cpp/cwinapp-class_11.cpp)]  
  
##  <a name="loadicon"></a>  CWinApp::LoadIcon  
 Carga el recurso de icono llamado por *lpszResourceName* o especificado por *nIDResource* desde el archivo ejecutable.  
  
```  
HICON LoadIcon(LPCTSTR lpszResourceName) const;  HICON LoadIcon(UINT nIDResource) const;  
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszResourceName*  
 Apunta a una cadena terminada en null que contiene el nombre del recurso de icono. También puede utilizar un `CString` para este argumento.  
  
 *nIDResource*  
 Número de Id. de recurso de icono.  
  
### <a name="return-value"></a>Valor devuelto  
 Un identificador de un icono si se realiza correctamente; en caso contrario, es NULL.  
  
### <a name="remarks"></a>Comentarios  
 `LoadIcon` carga el icono solo si aún no ha previamente cargado; en caso contrario, recupera un identificador de recurso existente.  
  
 Puede usar el [LoadStandardIcon](#loadstandardicon) o [LoadOEMIcon](#loadoemicon) función miembro para tener acceso a los iconos de Windows predefinidos.  
  
> [!NOTE]
>  Esta función miembro llama a la función API de Win32 [LoadIcon](http://msdn.microsoft.com/library/windows/desktop/ms648072), que solo puede cargar un icono cuyo tamaño se ajusta a los valores de métrica de sistema SM_CXICON y SM_CYICON.  
  
##  <a name="loadoemcursor"></a>  CWinApp::LoadOEMCursor  
 Carga las ventanas predefinidos recursos de cursor especificado por *nIDCursor*.  
  
```  
HCURSOR LoadOEMCursor(UINT nIDCursor) const;  
```  
  
### <a name="parameters"></a>Parámetros  
 *nIDCursor*  
 Un **OCR_** identificador de constante que especifica un cursor de Windows predefinido de manifiesto. Debe tener `#define OEMRESOURCE` antes de `#include \<afxwin.h>` para obtener acceso a la **OCR_** constantes en WINDOWS. H.  
  
### <a name="return-value"></a>Valor devuelto  
 Un identificador de un cursor si se realiza correctamente; en caso contrario, es NULL.  
  
### <a name="remarks"></a>Comentarios  
 Use la `LoadOEMCursor` o [LoadStandardCursor](#loadstandardcursor) función miembro para tener acceso a los cursores predefinidos de Windows.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#45](../../mfc/reference/codesnippet/cpp/cwinapp-class_12.h)]  
  
 [!code-cpp[NVC_MFCWindowing#46](../../mfc/reference/codesnippet/cpp/cwinapp-class_13.cpp)]  
  
##  <a name="loadoemicon"></a>  CWinApp::LoadOEMIcon  
 Carga las ventanas predefinidos especificado por el recurso de icono *nIDIcon*.  
  
```  
HICON LoadOEMIcon(UINT nIDIcon) const;  
```  
  
### <a name="parameters"></a>Parámetros  
 *nIDIcon*  
 Un **OIC_** identificador de constante que especifica un icono de Windows predefinido de manifiesto. Debe tener `#define OEMRESOURCE` antes de `#include \<afxwin.h>` para tener acceso a la **OIC_** constantes en WINDOWS. H.  
  
### <a name="return-value"></a>Valor devuelto  
 Un identificador de un icono si se realiza correctamente; en caso contrario, es NULL.  
  
### <a name="remarks"></a>Comentarios  
 Use la `LoadOEMIcon` o [LoadStandardIcon](#loadstandardicon) función miembro para tener acceso a los iconos de Windows predefinidos.  
  
##  <a name="loadstandardcursor"></a>  CWinApp::LoadStandardCursor  
 Carga las ventanas predefinidos recursos de cursor que *lpszCursorName* especifica.  
  
```  
HCURSOR LoadStandardCursor(LPCTSTR lpszCursorName) const;  
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszCursorName*  
 Un **IDC_** identificador de constante que especifica un cursor de Windows predefinido de manifiesto. Estos identificadores se definen en WINDOWS. H. La lista siguiente muestra los posibles valores predefinidos y significados *lpszCursorName*:  
  
- Cursor de flecha IDC_ARROW estándar  
  
- Cursor de inserción de texto IDC_IBEAM estándar  
  
- Cursor de reloj de arena IDC_WAIT usado cuando Windows lleva a cabo una tarea que consumen muchos recursos  
  
- Cursor de cruz IDC_CROSS para la selección  
  
- IDC_UPARROW flecha que señala hacia arriba  
  
- IDC_SIZE obsoleta y no compatible; usar IDC_SIZEALL  
  
- IDC_SIZEALL A cuatro flechas. Cursor que se va a utilizar para cambiar el tamaño de una ventana.  
  
- IDC_ICON obsoleta y no compatible. Utilice IDC_ARROW.  
  
- Flecha de dos puntas IDC_SIZENWSE con extremos en el lado superior izquierdo e inferior derecho  
  
- Flecha de dos puntas IDC_SIZENESW con termina en la parte superior izquierda de derecho e inferior  
  
- Flecha con dos puntas IDC_SIZEWE Horizontal  
  
- Flecha con dos puntas IDC_SIZENS Vertical  
  
### <a name="return-value"></a>Valor devuelto  
 Un identificador de un cursor si se realiza correctamente; en caso contrario, es NULL.  
  
### <a name="remarks"></a>Comentarios  
 Use la `LoadStandardCursor` o [LoadOEMCursor](#loadoemcursor) función miembro para tener acceso a los cursores predefinidos de Windows.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#47](../../mfc/reference/codesnippet/cpp/cwinapp-class_14.cpp)]  
  
##  <a name="loadstandardicon"></a>  CWinApp::LoadStandardIcon  
 Carga las ventanas predefinidos recurso de icono que *lpszIconName* especifica.  
  
```  
HICON LoadStandardIcon(LPCTSTR lpszIconName) const;  
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszIconName*  
 Un identificador de constante manifiesto que especifica un icono de Windows predefinido. Estos identificadores se definen en WINDOWS. H. Para obtener una lista de los posibles valores predefinidos y sus descripciones, consulte el *lpIconName* parámetro en [LoadIcon](http://msdn.microsoft.com/library/windows/desktop/ms648072) del SDK de Windows.  
  
### <a name="return-value"></a>Valor devuelto  
 Un identificador de un icono si se realiza correctamente; en caso contrario, es NULL.  
  
### <a name="remarks"></a>Comentarios  
 Use la `LoadStandardIcon` o [LoadOEMIcon](#loadoemicon) función miembro para tener acceso a los iconos de Windows predefinidos.  
  
##  <a name="loadstdprofilesettings"></a>  CWinApp::LoadStdProfileSettings  
 Llame a esta función miembro desde el [InitInstance](#initinstance) función de miembro para habilitar y cargar la lista de los archivos usados más recientemente (MRU) y la última vista previa de estado.  
  
```  
void LoadStdProfileSettings(UINT nMaxMRU = _AFX_MRU_COUNT);
```  
  
### <a name="parameters"></a>Parámetros  
 *nMaxMRU*  
 El número de archivos usados recientemente para realizar el seguimiento.  
  
### <a name="remarks"></a>Comentarios  
 Si *nMaxMRU* es 0, no se mantendrá ninguna lista de elementos utilizados Recientemente.  
  
##  <a name="m_bhelpmode"></a>  CWinApp::m_bHelpMode  
 TRUE si la aplicación está en modo de contexto de ayuda (convencionalmente invocado con MAYÚS + F1); en caso contrario, FALSE.  
  
```  
BOOL m_bHelpMode;  
```  
  
### <a name="remarks"></a>Comentarios  
 En el modo de contexto de ayuda, el cursor se convierte en un signo de interrogación y el usuario puede mover acerca de la pantalla. Examine esta marca si desea implementar un tratamiento especial en el modo de ayuda. `m_bHelpMode` es una variable pública de tipo BOOL.  
  
##  <a name="m_dwrestartmanagersupportflags"></a>  CWinApp::m_dwRestartManagerSupportFlags  
 Indicadores que determinan cómo se comporta el Administrador de reinicio.  
  
```  
DWORD m_dwRestartManagerSupportFlags;  
```  
  
### <a name="remarks"></a>Comentarios  
 Para habilitar el Administrador de reinicio, establezca `m_dwRestartManagerSupportFlags` el comportamiento que desee. En la siguiente tabla muestra las marcas que están disponibles.  
  
|||  
|-|-|  
|Marcar|Descripción|  
|AFX_RESTART_MANAGER_SUPPORT_RESTART|La aplicación se registra mediante [CWinApp::RegisterWithRestartManager](#registerwithrestartmanager). El Administrador de reinicio es responsable de reiniciar la aplicación si cierra de manera inesperada.|  
|-AFX_RESTART_MANAGER_SUPPORT_RECOVERY|La aplicación se registra con el Administrador de reinicio y el Administrador de reinicio llama a la función de devolución de llamada de recuperación cuando se reinicia la aplicación. La función de devolución de llamada de recuperación predeterminado es [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).|  
|-AFX_RESTART_MANAGER_AUTOSAVE_AT_RESTART|Autoguardado esté habilitado y la guarda de administrador de reinicio cualquiera abrir documentos cuando se reinicia la aplicación.|  
|-AFX_RESTART_MANAGER_AUTOSAVE_AT_INTERVAL|Autoguardado esté habilitado y la guarda de administrador de reinicio cualquiera abrir documentos de manera periódica. El intervalo se define mediante [CWinApp::m_nAutosaveInterval](#m_nautosaveinterval).|  
|-AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES|El Administrador de reinicio abre documentos previamente abiertos después de reiniciar la aplicación de una salida inesperada. El [CDataRecoveryHandler clase](../../mfc/reference/cdatarecoveryhandler-class.md) controla almacenar la lista de documentos abiertos y restaurarlos.|  
|-AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES|El Administrador de reinicio pide al usuario para restaurar archivos de autoguardado después de reiniciar la aplicación. La `CDataRecoveryHandler` clase solicita al usuario.|  
|-AFX_RESTART_MANAGER_SUPPORT_NO_AUTOSAVE|La unión de AFX_RESTART_MANAGER_SUPPORT_RESTART, AFX_RESTART_MANAGER_SUPPORT_RECOVER y AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES.|  
|-AFX_RESTART_MANAGER_SUPPORT_ALL_ASPECTS|La unión de AFX_RESTART_MANAGER_SUPPORT_NO_AUTOSAVE, AFX_RESTART_MANAGER_AUTOSAVE_AT_RESTART, AFX_RESTART_MANAGER_AUTOSAVE_AT_INTERVAL y AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES.|  
|-AFX_RESTART_MANAGER_SUPPORT_RESTART_ASPECTS|La unión de AFX_RESTART_MANAGER_SUPPORT_RESTART, AFX_RESTART_MANAGER_AUTOSAVE_AT_RESTART, AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES y AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES.|  
|-AFX_RESTART_MANAGER_SUPPORT_RECOVERY_ASPECTS|La unión ofAFX_RESTART_MANAGER_SUPPORT_RECOVERY, AFX_RESTART_MANAGER_AUTOSAVE_AT_INTERVAL, AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES y AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES.|  
  
##  <a name="m_ehelptype"></a>  CWinApp::m_eHelpType  
 El tipo de este miembro de datos es el tipo enumerado AFX_HELP_TYPE, que se define dentro de la `CWinApp` clase.  
  
```  
AFX_HELP_TYPE m_eHelpType;  
```  
  
### <a name="remarks"></a>Comentarios  
 La enumeración AFX_HELP_TYPE se define como sigue:  
  
```  
enum AFX_HELP_TYPE {  
    afxWinHelp = 0,
    afxHTMLHelp = 1
    };  
```  
  
-   Para establecer la Ayuda de la aplicación a la Ayuda de HTML, llame a [SetHelpMode](#sethelpmode) y especifique `afxHTMLHelp`.  
  
-   Para establecer la Ayuda de la aplicación para WinHelp, llame a `SetHelpMode` y especifique `afxWinHelp`.  
  
##  <a name="m_hinstance"></a>  CWinApp::m_hInstance  
 Corresponde a la *hInstance* parámetro se pasa por Windows para `WinMain`.  
  
```  
HINSTANCE m_hInstance;  
```  
  
### <a name="remarks"></a>Comentarios  
 El `m_hInstance` miembro de datos es un identificador de la instancia actual de la aplicación se ejecuta en Windows. Esto es devuelto por la función global [AfxGetInstanceHandle](application-information-and-management.md#afxgetinstancehandle). `m_hInstance` es una variable pública de tipo HINSTANCE.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#55](../../mfc/reference/codesnippet/cpp/cwinapp-class_15.cpp)]  
  
##  <a name="m_lpcmdline"></a>  CWinApp:: M_lpcmdline  
 Corresponde a la *lpCmdLine* parámetro se pasa por Windows para `WinMain`.  
  
```  
LPTSTR m_lpCmdLine;  
```  
  
### <a name="remarks"></a>Comentarios  
 Apunta a una cadena terminada en null que especifica la línea de comandos para la aplicación. Use `m_lpCmdLine` para tener acceso a los argumentos de línea de comandos el usuario ha especificado cuando se inicia la aplicación. `m_lpCmdLine` es una variable pública de tipo LPTSTR.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#52](../../mfc/reference/codesnippet/cpp/cwinapp-class_16.cpp)]  
  
##  <a name="m_nautosaveinterval"></a>  CWinApp::m_nAutosaveInterval  
 El período de tiempo en milisegundos entre guarda.  
  
```  
int m_nAutosaveInterval;  
```  
  
### <a name="remarks"></a>Comentarios  
 Puede configurar el Administrador de reinicio para documentos abiertos Autoguardado a intervalos establecidos. Si la aplicación no autoguardado de archivos, este parámetro tiene ningún efecto.  
  
##  <a name="m_ncmdshow"></a>  CWinApp::m_nCmdShow  
 Corresponde a la *nCmdShow* parámetro se pasa por Windows para `WinMain`.  
  
```  
int m_nCmdShow;  
```  
  
### <a name="remarks"></a>Comentarios  
 Debería pasar `m_nCmdShow` como un argumento cuando se llama a [CWnd:: ShowWindow](../../mfc/reference/cwnd-class.md#showwindow) para la ventana principal de la aplicación. `m_nCmdShow` es una variable pública de tipo **int**.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#56](../../mfc/reference/codesnippet/cpp/cwinapp-class_17.cpp)]  
  
##  <a name="m_pactivewnd"></a>  CWinApp::m_pActiveWnd  
 Utilice a este miembro de datos para almacenar un puntero a la ventana principal de la aplicación de contenedor OLE que tiene su OLE servidor aplicación activa en el contexto.  
  
### <a name="remarks"></a>Comentarios  
 Si este miembro de datos es NULL, la aplicación no está activo en contexto.  
  
 El marco de trabajo establece esta variable miembro cuando la ventana de marco es activado por una aplicación de contenedor OLE en contexto.  
  
##  <a name="m_pdatarecoveryhandler"></a>  CWinApp::m_pDataRecoveryHandler  
 Puntero para el controlador de recuperación de datos para la aplicación.  
  
```  
CDataRecoveryHandler* m_pDataRecoveryHandler;  
```  
  
### <a name="remarks"></a>Comentarios  
 El controlador de recuperación de datos de una aplicación supervisa los documentos abiertos y guarda ellos. El marco de trabajo usa el controlador de recuperación de datos para restaurar archivos de autoguardado cuando una aplicación se reinicia después de que cierra de forma inesperada. Para obtener más información, consulte [CDataRecoveryHandler clase](../../mfc/reference/cdatarecoveryhandler-class.md).  
  
##  <a name="m_pszappname"></a>  CWinApp::m_pszAppName  
 Especifica el nombre de la aplicación.  
  
```  
LPCTSTR m_pszAppName;  
```  
  
### <a name="remarks"></a>Comentarios  
 El nombre de la aplicación puede proceder del parámetro pasado a la [CWinApp](#cwinapp) constructor, o bien, si no se especifica, en la cadena de recurso con el Id. de AFX_IDS_APP_TITLE. Si el nombre de la aplicación no se encuentra en el recurso, proceden del programa. Nombre de archivo EXE.  
  
 Devuelto por la función global [AfxGetAppName](application-information-and-management.md#afxgetappname). `m_pszAppName` es una variable pública de tipo **const char\***.  
  
> [!NOTE]
>  Si asigna un valor a `m_pszAppName`, deben asignarse dinámicamente en el montón. El `CWinApp` llamadas de destructor **libre**() con este puntero. Tal vez desee usar el `_tcsdup`función de biblioteca en tiempo de ejecución () para realizar la asignación. Además, libere la memoria asociada del puntero actual antes de asignarle un nuevo valor. Por ejemplo:  
  
 [!code-cpp[NVC_MFCWindowing#57](../../mfc/reference/codesnippet/cpp/cwinapp-class_18.cpp)]  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#65](../../mfc/reference/codesnippet/cpp/cwinapp-class_19.cpp)]  
  
##  <a name="m_pszexename"></a>  CWinApp::m_pszExeName  
 Contiene el nombre del archivo ejecutable de la aplicación sin extensión.  
  
```  
LPCTSTR m_pszExeName;  
```  
  
### <a name="remarks"></a>Comentarios  
 A diferencia de [m_pszAppName](#m_pszappname), este nombre no puede contener espacios en blanco. `m_pszExeName` es una variable pública de tipo **const char\***.  
  
> [!NOTE]
>  Si asigna un valor a `m_pszExeName`, deben asignarse dinámicamente en el montón. El `CWinApp` llamadas de destructor **libre**() con este puntero. Tal vez desee usar el `_tcsdup`función de biblioteca en tiempo de ejecución () para realizar la asignación. Además, libere la memoria asociada del puntero actual antes de asignarle un nuevo valor. Por ejemplo:  
  
 [!code-cpp[NVC_MFCWindowing#58](../../mfc/reference/codesnippet/cpp/cwinapp-class_20.cpp)]  
  
##  <a name="m_pszhelpfilepath"></a>  CWinApp::m_pszHelpFilePath  
 Contiene la ruta de acceso al archivo de Ayuda de la aplicación.  
  
```  
LPCTSTR m_pszHelpFilePath;  
```  
  
### <a name="remarks"></a>Comentarios  
 De forma predeterminada, el marco de trabajo inicializa `m_pszHelpFilePath` al nombre de la aplicación con ". HLP"anexado. Para cambiar el nombre del archivo de ayuda, establezca `m_pszHelpFilePath` para que apunte a una cadena que contiene el nombre completo del archivo de Ayuda deseado. Es un lugar cómodo para hacer esto en la aplicación [InitInstance](#initinstance) función. `m_pszHelpFilePath` es una variable pública de tipo **const char\***.  
  
> [!NOTE]
>  Si asigna un valor a `m_pszHelpFilePath`, deben asignarse dinámicamente en el montón. El `CWinApp` llamadas de destructor **libre**() con este puntero. Tal vez desee usar el `_tcsdup`función de biblioteca en tiempo de ejecución () para realizar la asignación. Además, libere la memoria asociada del puntero actual antes de asignarle un nuevo valor. Por ejemplo:  
  
 [!code-cpp[NVC_MFCWindowing#59](../../mfc/reference/codesnippet/cpp/cwinapp-class_21.cpp)]  
  
##  <a name="m_pszprofilename"></a>  CWinApp::m_pszProfileName  
 Contiene el nombre de la aplicación. Archivo INI.  
  
```  
LPCTSTR m_pszProfileName;  
```  
  
### <a name="remarks"></a>Comentarios  
 `m_pszProfileName` es una variable pública de tipo **const char\***.  
  
> [!NOTE]
>  Si asigna un valor a `m_pszProfileName`, deben asignarse dinámicamente en el montón. El `CWinApp` llamadas de destructor **libre**() con este puntero. Tal vez desee usar el `_tcsdup`función de biblioteca en tiempo de ejecución () para realizar la asignación. Además, libere la memoria asociada del puntero actual antes de asignarle un nuevo valor. Por ejemplo:  
  
 [!code-cpp[NVC_MFCWindowing#60](../../mfc/reference/codesnippet/cpp/cwinapp-class_22.cpp)]  
  
##  <a name="m_pszregistrykey"></a>  CWinApp::m_pszRegistryKey  
 Se usa para determinar, en el registro o el archivo INI, configuración de perfil de aplicación que se almacena.  
  
```  
LPCTSTR m_pszRegistryKey;  
```  
  
### <a name="remarks"></a>Comentarios  
 Normalmente, este miembro de datos se trata como de solo lectura.  
  
-   El valor se almacena en una clave del registro. El nombre de la configuración de perfil de aplicación se anexa a la siguiente clave del registro: HKEY_CURRENT_USER/Software/LocalAppWizard-generados /.  
  
 Si asigna un valor a `m_pszRegistryKey`, deben asignarse dinámicamente en el montón. El `CWinApp` llamadas de destructor **libre**() con este puntero. Tal vez desee usar el `_tcsdup`función de biblioteca en tiempo de ejecución () para realizar la asignación. Además, libere la memoria asociada del puntero actual antes de asignarle un nuevo valor. Por ejemplo:  
  
 [!code-cpp[NVC_MFCWindowing#61](../../mfc/reference/codesnippet/cpp/cwinapp-class_23.cpp)]  
  
##  <a name="m_pszappid"></a>  CWinApp::m_pszAppID  
 Identificador de modelo de usuario de aplicación.  
  
```  
LPCTSTR m_pszAppID;  
```  
  
### <a name="remarks"></a>Comentarios  
  
##  <a name="oncontexthelp"></a>  CWinApp::OnContextHelp  
 Controla la tecla MAYÚS + F1 Ayuda dentro de la aplicación.  
  
```  
afx_msg void OnContextHelp();
```  
  
### <a name="remarks"></a>Comentarios  
 Debe agregar una `ON_COMMAND( ID_CONTEXT_HELP, OnContextHelp )` instrucción para su `CWinApp` clase mapa de mensajes y agregar una entrada de la tabla de aceleradores, normalmente MAYÚS+F1, para habilitar esta función miembro.  
  
 `OnContextHelp` coloca la aplicación en modo de ayuda. El cursor cambia a una flecha y un signo de interrogación y el usuario, a continuación, puede mover el puntero del mouse y presione el botón primario del mouse para seleccionar un cuadro de diálogo, una ventana, un menú o un botón de comando. Esta función miembro recupera el contexto de Ayuda del objeto bajo el cursor y llama a la función de Windows WinHelp con ese contexto de ayuda.  
  
##  <a name="onddecommand"></a>  CWinApp::OnDDECommand  
 Lo llama el marco de trabajo cuando la ventana de marco principal recibe un DDE ejecutar mensaje.  
  
```  
virtual BOOL OnDDECommand(LPTSTR lpszCommand);
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszCommand*  
 Apunta a una cadena de comando DDE recibido por la aplicación.  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si se controló el comando; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 La implementación predeterminada comprueba si el comando es una solicitud para abrir un documento y, en caso afirmativo, abre el documento especificado. Normalmente, el Administrador de archivos de Windows envía esas cadenas de comando DDE cuando el usuario hace doble clic en un archivo de datos. Invalidación de esta función para controlar otro DDE ejecutar comandos, por ejemplo, el comando Imprimir.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#48](../../mfc/reference/codesnippet/cpp/cwinapp-class_24.cpp)]  
  
##  <a name="onfilenew"></a>  CWinApp::OnFileNew  
 Implementa ID_FILE_NEW (comando).  
  
```  
afx_msg void OnFileNew();
```  
  
### <a name="remarks"></a>Comentarios  
 Debe agregar una `ON_COMMAND( ID_FILE_NEW, OnFileNew )` instrucción para su `CWinApp` mapa de mensajes de la clase para habilitar esta función miembro. Si está habilitada, esta función controla la ejecución del comando archivo nuevo.  
  
 Vea [Nota técnica 22](../../mfc/tn022-standard-commands-implementation.md) para obtener información sobre el comportamiento predeterminado e instrucciones sobre cómo reemplazar esta función miembro.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#49](../../mfc/reference/codesnippet/cpp/cwinapp-class_25.cpp)]  
  
 [!code-cpp[NVC_MFCWindowing#50](../../mfc/reference/codesnippet/cpp/cwinapp-class_26.cpp)]  
  
##  <a name="onfileopen"></a>  CWinApp::OnFileOpen  
 Implementa el comando ID_FILE_OPEN.  
  
```  
afx_msg void OnFileOpen();
```  
  
### <a name="remarks"></a>Comentarios  
 Debe agregar una `ON_COMMAND( ID_FILE_OPEN, OnFileOpen )` instrucción para su `CWinApp` mapa de mensajes de la clase para habilitar esta función miembro. Si está habilitada, esta función controla la ejecución del comando Abrir archivo.  
  
 Para obtener información sobre el comportamiento predeterminado e instrucciones sobre cómo reemplazar esta función miembro, vea [Nota técnica 22](../../mfc/tn022-standard-commands-implementation.md).  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#49](../../mfc/reference/codesnippet/cpp/cwinapp-class_25.cpp)]  
  
 [!code-cpp[NVC_MFCWindowing#50](../../mfc/reference/codesnippet/cpp/cwinapp-class_26.cpp)]  
  
##  <a name="onfileprintsetup"></a>  CWinApp::OnFilePrintSetup  
 Implementa ID_FILE_PRINT_SETUP (comando).  
  
```  
afx_msg void OnFilePrintSetup();
```  
  
### <a name="remarks"></a>Comentarios  
 Debe agregar una `ON_COMMAND( ID_FILE_PRINT_SETUP, OnFilePrintSetup )` instrucción para su `CWinApp` mapa de mensajes de la clase para habilitar esta función miembro. Si está habilitada, esta función controla la ejecución del comando de impresión de archivos.  
  
 Para obtener información sobre el comportamiento predeterminado e instrucciones sobre cómo reemplazar esta función miembro, vea [Nota técnica 22](../../mfc/tn022-standard-commands-implementation.md).  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#49](../../mfc/reference/codesnippet/cpp/cwinapp-class_25.cpp)]  
  
 [!code-cpp[NVC_MFCWindowing#50](../../mfc/reference/codesnippet/cpp/cwinapp-class_26.cpp)]  
  
##  <a name="onhelp"></a>  CWinApp::OnHelp  
 Controla la Ayuda de F1 de la aplicación (usando el contexto actual).  
  
```  
afx_msg void OnHelp();
```  
  
### <a name="remarks"></a>Comentarios  
 Normalmente también agregará una entrada de la tecla de aceleración para la tecla F1. Habilitar la tecla F1 es sólo una convención, no es un requisito.  
  
 Debe agregar una `ON_COMMAND( ID_HELP, OnHelp )` instrucción para su `CWinApp` mapa de mensajes de la clase para habilitar esta función miembro. Si está habilitada, lo llama el marco de trabajo cuando el usuario presiona la tecla F1.  
  
 La implementación predeterminada de esta función de controlador de mensajes determina el contexto de ayuda que corresponde a la ventana actual, el cuadro de diálogo o el elemento de menú y, a continuación, llama a WINHELP. EXE. Si no hay ningún contexto disponible actualmente, la función utiliza el contexto predeterminado.  
  
 Reemplace esta función miembro para establecer el contexto de ayuda a algo distinto de la ventana, el cuadro de diálogo, el elemento de menú o el botón de barra de herramientas que tiene actualmente el foco. Llamar a `WinHelp` con lo que se desea ayudar a identificador de contexto.  
  
##  <a name="onhelpfinder"></a>  CWinApp::OnHelpFinder  
 Controla los comandos ID_HELP_FINDER y ID_DEFAULT_HELP.  
  
```  
afx_msg void OnHelpFinder();
```  
  
### <a name="remarks"></a>Comentarios  
 Debe agregar una `ON_COMMAND( ID_HELP_FINDER, OnHelpFinder )` instrucción para su `CWinApp` mapa de mensajes de la clase para habilitar esta función miembro. Si está habilitada, el marco de trabajo llama a esta función de controlador de mensajes cuando el usuario de la aplicación selecciona el comando Ayuda buscador para invocar `WinHelp` con el estándar **HELP_FINDER** tema.  
  
##  <a name="onhelpindex"></a>  CWinApp::OnHelpIndex  
 Controla el ID_HELP_INDEX (comando) y proporciona un tema de Ayuda predeterminado.  
  
```  
afx_msg void OnHelpIndex();
```  
  
### <a name="remarks"></a>Comentarios  
 Debe agregar una `ON_COMMAND( ID_HELP_INDEX, OnHelpIndex )` instrucción para su `CWinApp` mapa de mensajes de la clase para habilitar esta función miembro. Si está habilitada, el marco de trabajo llama a esta función de controlador de mensajes cuando el usuario de la aplicación selecciona el comando de índice de la ayuda para invocar `WinHelp` con el estándar **HELP_INDEX** tema.  
  
##  <a name="onhelpusing"></a>  CWinApp::OnHelpUsing  
 Controla el ID_HELP_USING (comando).  
  
```  
afx_msg void OnHelpUsing();
```  
  
### <a name="remarks"></a>Comentarios  
 Debe agregar una `ON_COMMAND( ID_HELP_USING, OnHelpUsing )` instrucción para su `CWinApp` mapa de mensajes de la clase para habilitar esta función miembro. El marco de trabajo llama a esta función de controlador de mensajes cuando el usuario de la aplicación selecciona el comando para invocar la Ayuda usando el `WinHelp` aplicación con el estándar **HELP_HELPONHELP** tema.  
  
##  <a name="onidle"></a>  CWinApp:: OnIdle  
 Reemplace esta función miembro para realizar el procesamiento de tiempo de inactividad.  
  
```  
virtual BOOL OnIdle(LONG lCount);
```  
  
### <a name="parameters"></a>Parámetros  
 *lCount*  
 Un contador incrementa cada vez que `OnIdle` se llama cuando la cola de mensajes de la aplicación está vacía. Este recuento se restablece a 0 cada vez que se procesa un mensaje nuevo. Puede usar el *lCount* parámetro para determinar la cantidad relativa de tiempo que ha estado inactiva la aplicación sin tener que procesar un mensaje.  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero para recibir más en tiempo de procesamiento de inactividad; 0 si no se necesita nada más tiempo de inactividad.  
  
### <a name="remarks"></a>Comentarios  
 `OnIdle` se llama en el bucle de mensajes de forma predeterminada cuando la cola de mensajes de la aplicación está vacía. Usar la invalidación para llamar a su propio fondo tareas de controlador de inactividad.  
  
 `OnIdle` debería devolver 0 para indicar que no es necesario ningún procesamiento de tiempo de inactividad. El *lCount* parámetro se incrementa cada vez que `OnIdle` se llama cuando la cola de mensajes está vacía y se restablece a 0 cada vez que se procesa un mensaje nuevo. Puede llamar a sus rutinas de inactividad diferentes en función de este número.  
  
 A continuación resume el procesamiento de bucles inactivos:  
  
1.  Si el bucle de mensajes en la biblioteca Microsoft Foundation Class comprueba la cola de mensajes y no busca mensajes pendientes, llama a `OnIdle` para el objeto de aplicación y proporciona 0 como el *lCount* argumento.  
  
2. `OnIdle` realiza algún procesamiento y devuelve un valor distinto de cero para indicar que se debería llamar de nuevo para realizar un procesamiento posterior.  
  
3.  El bucle de mensajes comprueba la cola de mensajes de nuevo. Si no hay mensajes pendientes, llama a `OnIdle` nuevo, incrementar el *lCount* argumento.  
  
4.  Finalmente, `OnIdle` termina de procesar todas sus tareas inactivas y devuelve 0. Esto indica que el bucle de mensajes para detener una llamada a `OnIdle` hasta que se reciba el siguiente mensaje de la cola de mensajes, momento en que el ciclo de inactividad se reinicia con el argumento establecido en 0.  
  
 No se realizan las tareas largas durante `OnIdle` porque la aplicación no puede procesar la entrada del usuario hasta que `OnIdle` devuelve.  
  
> [!NOTE]
>  La implementación predeterminada de `OnIdle` objetos de interfaz de usuario, como botones de barra de herramientas y elementos de menú de comandos de las actualizaciones y realiza la limpieza de la estructura de datos internos. Por lo tanto, si invalida `OnIdle`, debe llamar a `CWinApp::OnIdle` con la `lCount` con su versión invalidada. Llame primero a todas las clases de base procesamiento en inactividad (es decir, hasta que la clase base `OnIdle` devuelve 0). Si tiene que realizar el trabajo antes de que finalice el procesamiento de la clase base, revise la implementación de la clase base para seleccionar el propio *lCount* durante el que se va a realizar su trabajo.  
  
 Si no desea `OnIdle` para llamar cada vez que se recupera un mensaje desde la cola de mensajes, puede invalidar la [CWinThreadIsIdleMessage](../../mfc/reference/cwinthread-class.md#isidlemessage). Si una aplicación ha establecido un temporizador muy corto, o si el sistema está enviando el mensaje WM_SYSTIMER, a continuación, `OnIdle` llamará repetidamente y degradar el rendimiento.  
  
### <a name="example"></a>Ejemplo  
 Los dos ejemplos siguientes muestran cómo usar `OnIdle`. El primer ejemplo procesa dos tareas inactivas mediante el *lCount* argumento dar prioridad a las tareas. La primera tarea es de alta prioridad, y debe hacerlo siempre que sea posible. La segunda tarea es menos importante y debe realizarse solo cuando se produce una pausa larga en proporcionados por el usuario. Tenga en cuenta la llamada a la versión de la clase base de `OnIdle`. El segundo ejemplo administra un grupo de tareas inactivas con diferentes prioridades.  
  
 [!code-cpp[NVC_MFCWindowing#51](../../mfc/reference/codesnippet/cpp/cwinapp-class_27.cpp)]  
  
##  <a name="opendocumentfile"></a>  CWinApp:: OpenDocumentFile  
 El marco de trabajo llama a este método para abrir la instancia con nombre [CDocument](../../mfc/reference/cdocument-class.md) archivo para la aplicación.  
  
```  
virtual CDocument* OpenDocumentFile(
LPCTSTR lpszFileName  
BOOL bAddToMRU = TRUE);
```  
  
### <a name="parameters"></a>Parámetros  
 [in] *lpszFileName*  
 El nombre del archivo que se puede abrir.  
  
 [in] *bAddToMRU*  
 TRUE indica que el documento es uno de los archivos más recientes; FALSE indica que el documento no es uno de los archivos más recientes.  
  
### <a name="return-value"></a>Valor devuelto  
 Un puntero a un `CDocument` si es correcto; en caso contrario, NULL.  
  
### <a name="remarks"></a>Comentarios  
 Si un documento que tiene ese nombre ya está abierto, la primera ventana de marco que contiene ese documento obtendrá el foco. Si una aplicación admite varias plantillas de documento, el marco de trabajo usa la extensión de nombre de archivo para encontrar la plantilla de documento apropiado para intentar cargar el documento. Si se realiza correctamente, la plantilla de documento, a continuación, crea una ventana de marco y la vista del documento.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#52](../../mfc/reference/codesnippet/cpp/cwinapp-class_16.cpp)]  
  
##  <a name="parsecommandline"></a>  CWinApp::ParseCommandLine  
 Llame a esta función miembro para analizar la línea de comandos y enviar a los parámetros, de uno en uno, [CCommandLineInfo::ParseParam](../../mfc/reference/ccommandlineinfo-class.md#parseparam).  
  
```  
void ParseCommandLine(CCommandLineInfo& rCmdInfo);
```  
  
### <a name="parameters"></a>Parámetros  
 *rCmdInfo*  
 Una referencia a un [CCommandLineInfo](../../mfc/reference/ccommandlineinfo-class.md) objeto.  
  
### <a name="remarks"></a>Comentarios  
 Cuando se inicia un nuevo proyecto MFC mediante el Asistente para aplicaciones, el Asistente para aplicaciones creará una instancia local de `CCommandLineInfo`y, a continuación, llame a `ProcessShellCommand` y `ParseCommandLine` en el [InitInstance](#initinstance) función miembro. Una línea de comandos se sigue la ruta que se describe a continuación:  
  
1.  Después de que se creen en `InitInstance`, `CCommandLineInfo` objeto se pasa al `ParseCommandLine`.  
  
2. `ParseCommandLine` a continuación, llama `CCommandLineInfo::ParseParam` varias veces, una vez para cada parámetro.  
  
3. `ParseParam` rellena el `CCommandLineInfo` objeto, que, a continuación, se pasa a [ProcessShellCommand](#processshellcommand).  
  
4. `ProcessShellCommand` controla los argumentos de línea de comandos y los indicadores.  
  
 Tenga en cuenta que puede llamar a `ParseCommandLine` directamente según sea necesario.  
  
 Para obtener una descripción de los marcadores de línea de comandos, consulte [CCommandLineInfo::m_nShellCommand](../../mfc/reference/ccommandlineinfo-class.md#m_nshellcommand).  
  
##  <a name="pretranslatemessage"></a>  CWinApp:: PreTranslateMessage  
 Anular esta función para filtrar los mensajes de ventana antes de enviarlos a las funciones de Windows [TranslateMessage](http://msdn.microsoft.com/library/windows/desktop/ms644955) y [DispatchMessage](http://msdn.microsoft.com/library/windows/desktop/ms644934) la implementación predeterminada realiza la tecla de aceleración traducción, por lo que debe llamar a la `CWinApp::PreTranslateMessage` función de miembro con su versión invalidada.  
  
```  
virtual BOOL PreTranslateMessage(MSG* pMsg);
```  
  
### <a name="parameters"></a>Parámetros  
 *pMsg*  
 Un puntero a un [MSG](../../mfc/reference/msg-structure1.md) estructura que contiene el mensaje que se va a procesar.  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si el mensaje se ha procesado totalmente en `PreTranslateMessage` y no puede procesar aún más. Devuelve cero si se debe procesar el mensaje de la forma habitual.  
  
##  <a name="processmessagefilter"></a>  CWinApp::ProcessMessageFilter  
 La función de enlace del marco de trabajo llama a esta función miembro para filtrar y responder a determinados mensajes de Windows.  
  
```  
virtual BOOL ProcessMessageFilter(
    int code,  
    LPMSG lpMsg);
```  
  
### <a name="parameters"></a>Parámetros  
 *Código*  
 Especifica un código de enlace. Esta función miembro utiliza el código para determinar cómo procesar *lpMsg.*  
  
 *lpMsg*  
 Un puntero a una ventana de [MSG](../../mfc/reference/msg-structure1.md) estructura.  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si se procesa el mensaje; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 Una función de enlace procesa los eventos antes de enviarlos al mensaje normal de la aplicación de procesamiento.  
  
 Si invalida esta característica avanzada, asegúrese de llamar a la versión de la clase base para mantener el marco de trabajo de procesamiento de enlace.  
  
##  <a name="processshellcommand"></a>  CWinApp::ProcessShellCommand  
 Llama a esta función miembro [InitInstance](#initinstance) para aceptar los parámetros pasados desde el `CCommandLineInfo` objeto identificado por *rCmdInfo*y realizar la acción indicada.  
  
```  
BOOL ProcessShellCommand(CCommandLineInfo& rCmdInfo);
```  
  
### <a name="parameters"></a>Parámetros  
 *rCmdInfo*  
 Una referencia a un [CCommandLineInfo](../../mfc/reference/ccommandlineinfo-class.md) objeto.  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si el comando de shell se procesa correctamente. Si 0, devuelve FALSE desde [InitInstance](#initinstance).  
  
### <a name="remarks"></a>Comentarios  
 Cuando se inicia un nuevo proyecto MFC mediante el Asistente para aplicaciones, el Asistente para aplicaciones creará una instancia local de `CCommandLineInfo`y, a continuación, llame a `ProcessShellCommand` y [ParseCommandLine](#parsecommandline) en el `InitInstance` función miembro. Una línea de comandos se sigue la ruta que se describe a continuación:  
  
1.  Después de que se creen en `InitInstance`, `CCommandLineInfo` objeto se pasa al `ParseCommandLine`.  
  
2. `ParseCommandLine` a continuación, llama [CCommandLineInfo::ParseParam](../../mfc/reference/ccommandlineinfo-class.md#parseparam) varias veces, una vez para cada parámetro.  
  
3. `ParseParam` rellena el `CCommandLineInfo` objeto, que, a continuación, se pasa a `ProcessShellCommand`.  
  
4. `ProcessShellCommand` controla los argumentos de línea de comandos y los indicadores.  
  
 Los miembros de datos de la `CCommandLineInfo` objeto, identificado por [CCommandLineInfo::m_nShellCommand](../../mfc/reference/ccommandlineinfo-class.md#m_nshellcommand), son del tipo enumerado siguiente, que se define dentro de la `CCommandLineInfo` clase.  
  
```  
enum {
    FileNew,
    FileOpen,
    FilePrint,
    FilePrintTo,
    FileDDE
    };  
```
  
 Para obtener una descripción breve de cada uno de estos valores, consulte `CCommandLineInfo::m_nShellCommand`.  
  
##  <a name="processwndprocexception"></a>  CWinApp::ProcessWndProcException  
 El marco de trabajo llama a esta función miembro siempre que el controlador no detecta una excepción que se produce en uno de los mensajes de la aplicación o controladores de comandos.  
  
```  
virtual LRESULT ProcessWndProcException(
    CException* e,  
    const MSG* pMsg);
```  
  
### <a name="parameters"></a>Parámetros  
 *e*  
 Un puntero a una excepción no detectada.  
  
 *pMsg*  
 A [MSG](../../mfc/reference/msg-structure1.md) estructura que contiene información sobre el mensaje de windows que ha causado el marco de trabajo producir una excepción.  
  
### <a name="return-value"></a>Valor devuelto  
 El valor que se debe devolver a Windows. Normalmente, se trata 0L para los mensajes de windows, 1L (TRUE) para los mensajes de comando.  
  
### <a name="remarks"></a>Comentarios  
 No llame a esta función miembro directamente.  
  
 La implementación predeterminada de esta función miembro crea un cuadro de mensaje. Si la excepción no detectada que se origina con un menú, barra de herramientas o error del comando de acelerador, el cuadro de mensaje muestra un mensaje "Error del comando"; de lo contrario, aparecerá un mensaje "error interno de la aplicación".  
  
 Reemplace esta función miembro para proporcionar un control de excepciones global. Si desea que el cuadro de mensaje que se mostrará solo llame a la funcionalidad básica.  
  
##  <a name="register"></a>  CWinApp::Register  
 Realiza cualquier tarea de registro no controlada por `RegisterShellFileTypes`.  
  
```  
virtual BOOL Register();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Distinto de cero en caso de éxito; en caso contrario, es 0.  
  
### <a name="remarks"></a>Comentarios  
 La implementación predeterminada simplemente devuelve TRUE. Reemplace esta función para proporcionar los pasos de registro personalizado.  
  
##  <a name="registershellfiletypes"></a>  CWinApp:: RegisterShellFileTypes  
 Llame a esta función miembro para registrar todos los tipos de documento de la aplicación con el Administrador de archivos de Windows.  
  
```  
void RegisterShellFileTypes(BOOL bCompat = FALSE);
```  
  
### <a name="parameters"></a>Parámetros  
 [in] *bCompat*  
 TRUE agrega las entradas de registro para los comandos de shell de impresión y de impresión a, permiten al usuario imprimir archivos directamente desde el shell, o arrastrando el archivo a un objeto de impresora. También agrega una clave DefaultIcon. De forma predeterminada, este parámetro es FALSE por compatibilidad con versiones anteriores.  
  
### <a name="remarks"></a>Comentarios  
 Esto permite al usuario abrir un archivo de datos creado por la aplicación, haga doble clic en él desde dentro del Administrador de archivos. Llame a `RegisterShellFileTypes` después de llamar a [AddDocTemplate](#adddoctemplate) para cada una de las plantillas de documento en la aplicación. Llamar a la [EnableShellOpen](#enableshellopen) función de miembro cuando se llama a `RegisterShellFileTypes`.  
  
 `RegisterShellFileTypes` recorre en iteración la lista de [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) objetos que la aplicación mantiene y, por cada plantilla de documento, agrega las entradas a la base de datos de registro que mantiene Windows para las asociaciones de archivo. El Administrador de archivos utiliza estas entradas para abrir un archivo de datos cuando el usuario hace doble clic en él. Esto elimina la necesidad de enviar una. Archivo de registro con la aplicación.  
  
> [!NOTE]
> `RegisterShellFileTypes` sólo funciona si el usuario ejecuta el programa con derechos de administrador. Si el programa no tiene derechos de administrador, no puede modificar las claves del registro.  
  
 Si la base de datos de registro ya asocia una extensión de nombre de archivo especificado con otro tipo de archivo, no se crea ninguna nueva asociación. Consulte la `CDocTemplate` clase para el formato de cadenas es necesarias registrar esta información.  
  
##  <a name="registerwithrestartmanager"></a>  CWinApp::RegisterWithRestartManager  
 Registra la aplicación con el Administrador de reinicio.  
  
```  
virtual HRESULT RegisterWithRestartManager(
BOOL bRegisterRecoveryCallback,  
const CString& strRestartIdentifier);

 
virtual HRESULT RegisterWithRestartManager(
LPCWSTR pwzCommandLineArgs,  
DWORD dwRestartFlags,  
APPLICATION_RECOVERY_CALLBACK pRecoveryCallback,  
LPVOID lpvParam,  
DWORD dwPingInterval,  
DWORD dwCallbackFlags);
```  
  
### <a name="parameters"></a>Parámetros  
  
|||  
|-|-|  
|Parámetro|Descripción|  
|[in] *bRegisterRecoveryCallback*|TRUE indica que esta instancia de la aplicación usa una función de devolución de llamada de recuperación; FALSE indica que no es así. El marco de trabajo llama a la función de devolución de llamada de recuperación cuando la aplicación se cierra de forma inesperada. Para obtener más información, consulte [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).|  
|[in] *strRestartIdentifier*|Cadena única que identifica esta instancia del Administrador de reinicio. El identificador del Administrador de reinicio es único para cada instancia de una aplicación.|  
|[in] *pwzCommandLineArgs*|Una cadena que contiene los argumentos adicionales de la línea de comandos.|  
|[in] *dwRestartFlags*|Marcas opcionales para el Administrador de reinicio. Para obtener más información, vea la sección Comentarios.|  
|[in] *pRecoveryCallback*|La función de devolución de llamada de recuperación. Esta función debe tomar un parámetro LPVOID como entrada y devolver un valor DWORD. La función de devolución de llamada de recuperación predeterminado es `CWinApp::ApplicationRecoveryCallback`.|  
|[in] *lpvParam*|El parámetro de entrada para la función de devolución de llamada de recuperación. Para obtener más información, consulte [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).|  
|[in] *dwPingInterval*|El período de tiempo que espera a que el Administrador de reinicio para que la función de devolución de llamada de recuperación devolver. Este parámetro está en milisegundos.|  
|[in] *dwCallbackFlags*|Indicadores que se pasan a la función de devolución de llamada de recuperación. Reservado para un uso futuro.|  
  
### <a name="return-value"></a>Valor devuelto  
 S_OK si el método es correcto; en caso contrario, un código de error.  
  
### <a name="remarks"></a>Comentarios  
 Si la aplicación utiliza la implementación de MFC predeterminada para los archivos de autoguardado, debe usar la versión simple de `RegisterWithRestartManager`. Usar la versión compleja de `RegisterWithRestartManager` si desea personalizar el comportamiento de guardado automático de la aplicación.  
  
 Si se llama a este método con una cadena vacía para *strRestartIdentifier*, `RegisterWithRestartManager` crea una cadena de identificador único para esta instancia del reinicio de administrador.  
  
 Cuando una aplicación se cierra de forma inesperada, el Administrador de reinicio reinicia la aplicación desde la línea de comandos y proporciona que reinicia el único identificador como un argumento opcional. En este escenario, el marco llama a `RegisterWithRestartManager` dos veces. La primera llamada procede de [CWinApp:: InitInstance](#initinstance) con una cadena vacía para el identificador de cadena. A continuación, el método [CWinApp::ProcessShellCommand](#processshellcommand) llamadas `RegisterWithRestartManager` con el identificador único de reinicio.  
  
 Después de registrar una aplicación con el Administrador de reinicio, el Administrador de reinicio supervisa la aplicación. Si la aplicación se cierra inesperadamente, el Administrador de reinicio llama a la función de devolución de llamada de recuperación durante el proceso de apagado. Las esperas de administrador de reinicio el *dwPingInterval* una respuesta de la función de devolución de llamada de recuperación. Si la función de devolución de llamada de recuperación no responde dentro de este tiempo, la aplicación se cierra sin ejecutar la función de devolución de llamada de recuperación.  
  
 De forma predeterminada, la dwRestartFlags no son compatibles, pero se proporcionan para su uso futuro. Los valores posibles de *dwRestartFlags* son los siguientes:  
  
- RESTART_NO_CRASH  
  
- RESTART_NO_HANG  
  
- RESTART_NO_PATCH  
  
- RESTART_NO_REBOOT  
  
##  <a name="reopenpreviousfilesatrestart"></a>  CWinApp::ReopenPreviousFilesAtRestart  
 Determina si el Administrador de reinicio se vuelve a abrir los archivos que estaban abiertos cuando la aplicación terminó inesperadamente.  
  
```  
virtual BOOL ReopenPreviousFilesAtRestart() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 TRUE indica que el Administrador de reinicio se vuelve a abrir los archivos abiertos anteriormente; FALSE indica que el Administrador de reinicio no lo hace.  
  
##  <a name="restartinstance"></a>  CWinApp::RestartInstance  
 Controla el reinicio de una aplicación iniciado por el Administrador de reinicio.  
  
```  
virtual BOOL CWinApp::RestartInstance();
```  
  
### <a name="return-value"></a>Valor devuelto  
 TRUE si el controlador de recuperación de datos abre documentos abiertos anteriormente; FALSE si el controlador de recuperación de datos tiene un error o si no hay ningún documento abierto anteriormente.  
  
### <a name="remarks"></a>Comentarios  
 Cuando el Administrador de reinicio reinicia una aplicación, el marco de trabajo llama a este método. Este método recupera el controlador de recuperación de datos y restaura los archivos guardados automáticamente. Este método llama a [CDataRecoveryHandler::RestoreAutosavedDocuments](../../mfc/reference/cdatarecoveryhandler-class.md#restoreautosaveddocuments) para determinar si el usuario desea restaurar los archivos guardados automáticamente.  
  
 Este método devuelve FALSE si el [CDataRecoveryHandler](../../mfc/reference/cdatarecoveryhandler-class.md) determina que no había ningún documento abierto. Si no hubiera ningún documento abierto, la aplicación se inicia normalmente.  
  
##  <a name="restoreautosavedfilesatrestart"></a>  CWinApp::RestoreAutosavedFilesAtRestart  
 Determina si el Administrador de reinicio restaura los archivos guardados automáticamente cuando se reinicia la aplicación.  
  
```  
virtual BOOL RestoreAutosavedFilesAtRestart() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 TRUE indica que el Administrador de reinicio restaura archivos de autoguardado; FALSE indica que el Administrador de reinicio no lo hace.  
  
##  <a name="run"></a>  CWinApp:: Run  
 Proporciona un bucle de mensajes de forma predeterminada.  
  
```  
virtual int Run();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Un **int** valor devuelto por `WinMain`.  
  
### <a name="remarks"></a>Comentarios  
 `Run` adquiere y envía los mensajes de Windows hasta que la aplicación recibe un mensaje WM_QUIT. Si la cola de mensajes de la aplicación no contiene actualmente ningún mensaje, `Run` llamadas [OnIdle](#onidle) para realizar el procesamiento de tiempo de inactividad. Los mensajes entrantes hacia el [PreTranslateMessage](#pretranslatemessage) función de miembro para un procesamiento especial y, a continuación, la función de Windows `TranslateMessage` para la traducción de teclado estándar; por último, el `DispatchMessage` se llama a la función de Windows.  
  
 `Run` casi nunca se reemplaza, pero se puede invalidar para proporcionar un comportamiento especial.  
  
##  <a name="runautomated"></a>  CWinApp::RunAutomated  
 Llame a esta función para determinar si el " **/automatización**"o" **-automatización**" opción está presente, lo que indica si la aplicación de servidor se ha iniciado por una aplicación cliente.  
  
```  
BOOL RunAutomated();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si se encontró la opción; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 Si está presente, se quita la opción de la línea de comandos. Para obtener más información sobre la automatización OLE, vea el artículo [servidores de automatización](../../mfc/automation-servers.md).  
  
##  <a name="runembedded"></a>  CWinApp:: RunEmbedded  
 Llame a esta función para determinar si el " **/incrustación**"o" **-Embedding**" opción está presente, lo que indica si la aplicación de servidor se ha iniciado por una aplicación cliente.  
  
```  
BOOL RunEmbedded();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si se encontró la opción; en caso contrario es 0.  
  
### <a name="remarks"></a>Comentarios  
 Si está presente, se quita la opción de la línea de comandos. Para obtener más información sobre la incrustación, vea el artículo [servidores: implementar un servidor](../../mfc/servers-implementing-a-server.md).  
  
##  <a name="saveallmodified"></a>  CWinApp::SaveAllModified  
 Se llama el marco de trabajo para guardar todos los documentos cuando la ventana de marco principal de la aplicación consiste en Cerrar, o a través de un mensaje de mensaje WM_QUERYENDSESSION.  
  
```  
virtual BOOL SaveAllModified();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Es distinto de cero si es seguro terminar la aplicación; 0 si no es seguro terminar la aplicación.  
  
### <a name="remarks"></a>Comentarios  
 La implementación predeterminada de esta función miembro llama el [CDocument:: SaveModified](../../mfc/reference/cdocument-class.md#savemodified) función de miembro a su vez para todos los documentos modificados dentro de la aplicación.  
  
##  <a name="selectprinter"></a>  CWinApp::SelectPrinter  
 Llame a esta función miembro para seleccionar una impresora específica y la versión de la impresora que se ha seleccionado anteriormente en el cuadro de diálogo de impresión.  
  
```  
void SelectPrinter(
    HANDLE hDevNames,  
    HANDLE hDevMode,  
    BOOL bFreeOld = TRUE);
```  
  
### <a name="parameters"></a>Parámetros  
 *hDevNames*  
 Un identificador de un [DEVNAMES](../../mfc/reference/devnames-structure.md) estructura que identifica el controlador, el dispositivo y los nombres de puerto de salida de una impresora específica.  
  
 *hDevMode*  
 Un identificador de un [DEVMODE](http://msdn.microsoft.com/library/windows/desktop/dd183565) estructura que especifica información sobre la inicialización del dispositivo y el entorno de una impresora.  
  
 *bFreeOld*  
 Libera a la impresora seleccionada anteriormente.  
  
### <a name="remarks"></a>Comentarios  
 Si ambos *hDevMode* y *hDevNames* son NULL, `SelectPrinter` usa la impresora predeterminada actual.  
  
##  <a name="sethelpmode"></a>  CWinApp::SetHelpMode  
 Establece el tipo de Ayuda de la aplicación.  
  
```  
void SetHelpMode(AFX_HELP_TYPE eHelpType);
```  
  
### <a name="parameters"></a>Parámetros  
 *eHelpType*  
 Especifica el tipo de ayuda que se va a usar. Vea [CWinApp::m_eHelpType](#m_ehelptype) para obtener más información.  
  
### <a name="remarks"></a>Comentarios  
 Establece el tipo de Ayuda de la aplicación.  
  
 Para establecer el tipo de Ayuda de la aplicación en HTMLHelp, se puede llamar a [EnableHTMLHelp](#enablehtmlhelp). Una vez que se llama a `EnableHTMLHelp`, la aplicación debe utilizar HTMLHelp como su aplicación de ayuda. Si desea cambiar para que usen WinHelp, puede llamar a `SetHelpMode` y establecer *eHelpType* a `afxWinHelp`.  
  
##  <a name="setregistrykey"></a>  CWinApp::SetRegistryKey  
 Hace que la configuración de aplicación que se almacenará en el registro en lugar de archivos INI.  
  
```  
void SetRegistryKey(LPCTSTR lpszRegistryKey);  
void SetRegistryKey(UINT nIDRegistryKey);
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszRegistryKey*  
 Puntero a una cadena que contiene el nombre de la clave.  
  
 *nIDRegistryKey*  
 Identificador de un recurso de cadena que contiene el nombre de la clave del registro.  
  
### <a name="remarks"></a>Comentarios  
 Esta función establece *m_pszRegistryKey*, que, a continuación, se usa por la `GetProfileInt`, `GetProfileString`, `WriteProfileInt`, y `WriteProfileString` las funciones miembro de `CWinApp`. Si se ha llamado a esta función, la lista de usados más recientemente (MRU) archivos también se almacena en el registro. La clave del registro normalmente es el nombre de una compañía. Se almacena en una clave de la forma siguiente: HKEY_CURRENT_USER\Software\\< nombre de la compañía\>\\< nombre de la aplicación\>\\< nombre de sección\>\\< valor nombre\>.  
  
##  <a name="supportsapplicationrecovery"></a>  CWinApp::SupportsApplicationRecovery  
 Determina si el Administrador de reinicio recupera una aplicación que se cerraron de forma inesperada.  
  
```  
virtual BOOL SupportsApplicationRecovery() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 TRUE indica que el Administrador de reinicio recupera la aplicación; FALSE indica que el Administrador de reinicio no lo hace.  
  
##  <a name="supportsautosaveatinterval"></a>  CWinApp::SupportsAutosaveAtInterval  
 Determina si lo guarda el Administrador de reinicio abre documentos de manera periódica.  
  
```  
virtual BOOL SupportsAutosaveAtInterval() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 TRUE indica que el Administrador de reinicio guarde automáticamente documentos abiertos; FALSE indica que el Administrador de reinicio no lo hace.  
  
##  <a name="supportsautosaveatrestart"></a>  CWinApp::SupportsAutosaveAtRestart  
 Determina si el Administrador de reinicio guarde automáticamente cualquier abrir documentos cuando se reinicia la aplicación.  
  
```  
virtual BOOL SupportsAutosaveAtRestart() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 TRUE indica que el Administrador de reinicio guarde automáticamente abre documentos cuando se reinicia la aplicación; FALSE indica que el Administrador de reinicio no lo hace.  
  
##  <a name="supportsrestartmanager"></a>  CWinApp::SupportsRestartManager  
 Determina si la aplicación es compatible con el Administrador de reinicio.  
  
```  
virtual BOOL SupportsRestartManager() const;  
```  
  
### <a name="return-value"></a>Valor devuelto  
 TRUE indica que la aplicación es compatible con el Administrador de reinicio; FALSE indica que la aplicación no lo hace.  
  
##  <a name="unregister"></a>  CWinApp::Unregister  
 Anula el registro de todos los archivos registrados por el objeto application.  
  
```  
virtual BOOL Unregister();
```  
  
### <a name="return-value"></a>Valor devuelto  
 Distinto de cero en caso de éxito; en caso contrario, es 0.  
  
### <a name="remarks"></a>Comentarios  
 El `Unregister` función deshace la inscripción realizada por el objeto application y la [registrar](#register) función. Normalmente, las dos funciones se denominan implícitamente por MFC y, por tanto, no aparecerá en el código.  
  
 Reemplace esta función para llevar a cabo los pasos de la anulación del registro personalizado.  
  
##  <a name="unregistershellfiletypes"></a>  CWinApp::UnregisterShellFileTypes  
 Llame a esta función miembro para anular el registro de todos los tipos de documento de la aplicación con el Administrador de archivos de Windows.  
  
```  
void UnregisterShellFileTypes();
```  
  
##  <a name="winhelp"></a>  CWinApp:: WinHelp  
 Llame a esta función miembro para invocar la aplicación WinHelp.  
  
```  
virtual void WinHelp(
    DWORD_PTR dwData,  
    UINT nCmd = HELP_CONTEXT);
```  
  
### <a name="parameters"></a>Parámetros  
 *dwData*  
 Especifica datos adicionales. El valor utilizado depende del valor de la *nCmd* parámetro.  
  
 *nCmd*  
 Especifica el tipo de ayuda solicitado. Para obtener una lista de valores posibles y cómo afectan a la *dwData* parámetro, vea la [WinHelp](http://msdn.microsoft.com/library/windows/desktop/bb762267) la función de Windows.  
  
### <a name="remarks"></a>Comentarios  
 El marco de trabajo también llama a esta función para invocar la aplicación WinHelp.  
  
 El marco de trabajo cerrará automáticamente la aplicación WinHelp cuando finaliza la aplicación.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#53](../../mfc/reference/codesnippet/cpp/cwinapp-class_28.cpp)]  
  
##  <a name="writeprofilebinary"></a>  CWinApp::WriteProfileBinary  
 Llame a esta función miembro para escribir datos binarios en la sección especificada del registro de la aplicación o. Archivo INI.  
  
```  
BOOL WriteProfileBinary(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    LPBYTE pData,  
    UINT nBytes);
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszSection*  
 Apunta a una cadena terminada en NULL que especifica la sección que contiene la entrada. Si la sección no existe, se crea. El nombre de la sección es el caso independiente; la cadena puede ser cualquier combinación de letras mayúsculas y minúsculas.  
  
 *lpszEntry*  
 Apunta a una cadena terminada en null que contiene la entrada en la que el valor se escribirá. Si la entrada no existe en la sección especificada, se crea.  
  
 *pData*  
 Apunta a los datos que se va a escribir.  
  
 *nBytes*  
 Contiene el número de bytes que se escribirán.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="example"></a>Ejemplo  
 Este ejemplo se utiliza `CWinApp* pApp = AfxGetApp();` para llegar a la clase de CWinApp que ilustra una forma que `WriteProfileBinary` y `GetProfileBinary` se puedan usar desde cualquier función en una aplicación MFC.  
  
 [!code-cpp[NVC_MFCWindowing#54](../../mfc/reference/codesnippet/cpp/cwinapp-class_29.cpp)]  
  
 Para obtener otro ejemplo, vea el ejemplo de [CWinApp::GetProfileBinary](#getprofilebinary).  
  
##  <a name="writeprofileint"></a>  CWinApp:: Writeprofileint  
 Llame a esta función miembro para escribir el valor especificado en la sección especificada del registro de la aplicación o. Archivo INI.  
  
```  
BOOL WriteProfileInt(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    int nValue);
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszSection*  
 Apunta a una cadena terminada en NULL que especifica la sección que contiene la entrada. Si la sección no existe, se crea. El nombre de la sección es el caso independiente; la cadena puede ser cualquier combinación de letras mayúsculas y minúsculas.  
  
 *lpszEntry*  
 Apunta a una cadena terminada en null que contiene la entrada en la que el valor se escribirá. Si la entrada no existe en la sección especificada, se crea.  
  
 *nvalor*  
 Contiene el valor que se escribirá.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="example"></a>Ejemplo  
 Este ejemplo se utiliza `CWinApp* pApp = AfxGetApp();` para llegar a la clase de CWinApp que ilustra una forma que `WriteProfileString`, `WriteProfileInt`, `GetProfileString`, y `GetProfileInt` se puedan usar desde cualquier función en una aplicación MFC.  
  
 [!code-cpp[NVC_MFCWindowing#43](../../mfc/reference/codesnippet/cpp/cwinapp-class_9.cpp)]  
  
 Para obtener otro ejemplo, vea el ejemplo de [CWinApp::GetProfileInt](#getprofileint).  
  
##  <a name="writeprofilestring"></a>  CWinApp::WriteProfileString  
 Llame a esta función miembro para escribir la cadena especificada en la sección especificada del registro de la aplicación o. Archivo INI.  
  
```  
BOOL WriteProfileString(
    LPCTSTR lpszSection,  
    LPCTSTR lpszEntry,  
    LPCTSTR lpszValue);
```  
  
### <a name="parameters"></a>Parámetros  
 *lpszSection*  
 Apunta a una cadena terminada en NULL que especifica la sección que contiene la entrada. Si la sección no existe, se crea. El nombre de la sección es el caso independiente; la cadena puede ser cualquier combinación de letras mayúsculas y minúsculas.  
  
 *lpszEntry*  
 Apunta a una cadena terminada en null que contiene la entrada en la que el valor se escribirá. Si la entrada no existe en la sección especificada, se crea. Si este parámetro es NULL, la sección especificada por *lpszSection* se elimina.  
  
 *lpszValue*  
 Apunta a la cadena que se va a escribir. Si este parámetro es NULL, la entrada especificada por el *lpszEntry* parámetro se elimina.  
  
### <a name="return-value"></a>Valor devuelto  
 Si es correcta, su valor es distinto de cero. En caso contrario, es cero.  
  
### <a name="example"></a>Ejemplo  
 [!code-cpp[NVC_MFCWindowing#43](../../mfc/reference/codesnippet/cpp/cwinapp-class_9.cpp)]  
  
 Para obtener otro ejemplo, vea el ejemplo de [CWinApp::GetProfileInt](#getprofileint).  
  
##  <a name="setappid"></a>  CWinApp::SetAppID  
 Se establece explícitamente el identificador del modelo de aplicación de usuario para la aplicación. Este método debe llamarse antes de una interfaz de usuario se presenta al usuario (lo mejor es el constructor de la aplicación).  
  
```  
void SetAppID(LPCTSTR lpcszAppID);
```  
  
### <a name="parameters"></a>Parámetros  
 *lpcszAppID*  
 Especifica el identificador de modelo de usuario de aplicación.  
  
### <a name="remarks"></a>Comentarios  
  
## <a name="see-also"></a>Vea también  
 [CWinThread (clase)](../../mfc/reference/cwinthread-class.md)   
 [Gráfico de jerarquías](../../mfc/hierarchy-chart.md)   
 [Procedimiento para agregar compatibilidad con el Administrador de reinicio](../../mfc/how-to-add-restart-manager-support.md)



